<!DOCTYPE html>












  


<html class="theme-next mist use-motion" lang>
<head><meta name="generator" content="Hexo 3.8.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
























<link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2">

<link rel="stylesheet" href="/css/main.css?v=7.1.1">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=7.1.1">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=7.1.1">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=7.1.1">


  <link rel="mask-icon" href="/images/logo.svg?v=7.1.1" color="#222">







<script id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Mist',
    version: '7.1.1',
    sidebar: {"position":"left","display":"post","offset":12,"onmobile":false,"dimmer":false},
    back2top: true,
    back2top_sidebar: false,
    fancybox: false,
    fastclick: false,
    lazyload: false,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>


  




  <meta property="og:type" content="website">
<meta property="og:title" content="DummyHead">
<meta property="og:url" content="https://alphaalgorithms.github.io/index.html">
<meta property="og:site_name" content="DummyHead">
<meta property="og:locale" content="default">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="DummyHead">





  
  
  <link rel="canonical" href="https://alphaalgorithms.github.io/">



<script id="page.configurations">
  CONFIG.page = {
    sidebar: "",
  };
</script>

  <title>DummyHead</title>
  












  <noscript>
  <style>
  .use-motion .motion-element,
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-title { opacity: initial; }

  .use-motion .logo,
  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="default">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">DummyHead</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
    
    
  </div>

  <div class="site-nav-toggle">
    <button aria-label="Toggle navigation bar">
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>



<nav class="site-nav">
  
    <ul id="menu" class="menu">
      
        
        
        
          
          <li class="menu-item menu-item-home menu-item-active">

    
    
    
      
    

    
      
    

    <a href="/" rel="section"><i class="menu-item-icon fa fa-fw fa-home"></i> <br>Home</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-tags">

    
    
    
      
    

    
      
    

    <a href="/tags/" rel="section"><i class="menu-item-icon fa fa-fw fa-tags"></i> <br>Tags<span class="badge">29</span></a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-categories">

    
    
    
      
    

    
      
    

    <a href="/categories/" rel="section"><i class="menu-item-icon fa fa-fw fa-th"></i> <br>Categories<span class="badge">16</span></a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-archives">

    
    
    
      
    

    
      
    

    <a href="/archives/" rel="section"><i class="menu-item-icon fa fa-fw fa-archive"></i> <br>Archives<span class="badge">30</span></a>

  </li>

      
      
    </ul>
  

  
    

  

  
</nav>



  



</div>
    </header>

    


    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://alphaalgorithms.github.io/2019/06/13/work-with-source-code/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Gabriel">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="DummyHead">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                
                <a href="/2019/06/13/work-with-source-code/" class="post-title-link" itemprop="url">14 Working with Source Code</a>
              
            
          </h2>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2019-06-13 15:31:00 / Modified: 15:34:05" itemprop="dateCreated datePublished" datetime="2019-06-13T15:31:00+08:00">2019-06-13</time>
            

            
              

              
            
          </span>

          

          
            
            
              
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
            
                <span class="post-meta-item-text">Comments: </span>
                <a href="/2019/06/13/work-with-source-code/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2019/06/13/work-with-source-code/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>Source code here refers to any plain text collection of computer instructions, possibly with comments, written using a human-readable programming language. Org can manage source code in an Org document when the source code is identified with begin and end markers. Working with source code begins with identifying source code blocks. A source code block can be placed almost anywhere in an Org document; it is not restricted to the preamble or the end of the document. However, Org cannot manage a source code block if it is placed inside an Org comment or within a fixed width section.</p>
<p>Here is an example source code block in the Emacs Lisp language:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">#+BEGIN_SRC emacs-lisp</span><br><span class="line">  (defun org-xor (a b)</span><br><span class="line">     &quot;Exclusive or.&quot;</span><br><span class="line">     (if a (not b) b))</span><br><span class="line">#+END_SRC</span><br></pre></td></tr></table></figure>
<p>Org can manage the source code in the block delimited by ‘#+BEGIN_SRC’ … ‘#+END_SRC’ in several ways that can simplify housekeeping tasks essential to modern source code maintenance. Org can edit, format, extract, export, and publish source code blocks. Org can also compile and execute a source code block, then capture the results. The Org mode literature sometimes refers to source code blocks as <em>live code</em> blocks because they can alter the content of the Org document or the material that it exports. Users can control how live they want each source code block by tweaking the header arguments (see <a href="https://orgmode.org/org.html#Using-Header-Arguments" target="_blank" rel="noopener">Using Header Arguments</a>) for compiling, execution, extraction, and exporting.</p>
<p>Source code blocks are one of many Org block types, which also include “center”, “comment”, “dynamic”, “example”, “export”, “quote”, “special”, and “verse”. This section pertains to blocks between ‘#+BEGIN_SRC’ and ‘#+END_SRC’.</p>
<p>For editing and formatting a source code block, Org uses an appropriate Emacs major mode that includes features specifically designed for source code in that language.</p>
<p>Org can extract one or more source code blocks and write them to one or more source files—a process known as <em>tangling</em> in literate programming terminology.</p>
<p>For exporting and publishing, Org’s back-ends can format a source code block appropriately, often with native syntax highlighting.</p>
<p>For executing and compiling a source code block, the user can configure Org to select the appropriate compiler. Org provides facilities to collect the result of the execution or compiler output, insert it into the Org document, and/or export it. In addition to text results, Org can insert links to other data types, including audio, video, and graphics. Org can also link a compiler error message to the appropriate line in the source code block.</p>
<p>An important feature of Org’s management of source code blocks is the ability to pass variables, functions, and results to one another using a common syntax for source code blocks in any language. Although most literate programming facilities are restricted to one language or another, Org’s language-agnostic approach lets the literate programmer match each programming task with the appropriate computer language and to mix them all together in a single Org document. This interoperability among languages explains why Org’s source code management facility was named <em>Org Babel</em> by its originators, Eric Schulte and Dan Davison.</p>
<p>Org mode fulfills the promise of easy verification and maintenance of publishing reproducible research by keeping text, data, code, configuration settings of the execution environment, the results of the execution, and associated narratives, claims, references, and internal and external links in a single Org document.</p>
<p>Details of Org’s facilities for working with source code are described in the following sections.</p>
<table>
<thead>
<tr>
<th>• <a href="https://orgmode.org/org.html#Structure-of-Code-Blocks" target="_blank" rel="noopener">Structure of Code Blocks</a>:</th>
<th>Code block syntax described.</th>
</tr>
</thead>
<tbody>
<tr>
<td>• <a href="https://orgmode.org/org.html#Using-Header-Arguments" target="_blank" rel="noopener">Using Header Arguments</a>:</td>
<td>Different ways to set header arguments.</td>
</tr>
<tr>
<td>• <a href="https://orgmode.org/org.html#Environment-of-a-Code-Block" target="_blank" rel="noopener">Environment of a Code Block</a>:</td>
<td>Arguments, sessions, working directory…</td>
</tr>
<tr>
<td>• <a href="https://orgmode.org/org.html#Evaluating-Code-Blocks" target="_blank" rel="noopener">Evaluating Code Blocks</a>:</td>
<td>Place results of evaluation in the Org buffer.</td>
</tr>
<tr>
<td>• <a href="https://orgmode.org/org.html#Results-of-Evaluation" target="_blank" rel="noopener">Results of Evaluation</a>:</td>
<td>Choosing a results type, post-processing…</td>
</tr>
<tr>
<td>• <a href="https://orgmode.org/org.html#Exporting-Code-Blocks" target="_blank" rel="noopener">Exporting Code Blocks</a>:</td>
<td>Export contents and/or results.</td>
</tr>
<tr>
<td>• <a href="https://orgmode.org/org.html#Extracting-Source-Code" target="_blank" rel="noopener">Extracting Source Code</a>:</td>
<td>Create pure source code files.</td>
</tr>
<tr>
<td>• <a href="https://orgmode.org/org.html#Languages" target="_blank" rel="noopener">Languages</a>:</td>
<td>List of supported code block languages.</td>
</tr>
<tr>
<td>• <a href="https://orgmode.org/org.html#Editing-Source-Code" target="_blank" rel="noopener">Editing Source Code</a>:</td>
<td>Language major-mode editing.</td>
</tr>
<tr>
<td>• <a href="https://orgmode.org/org.html#Noweb-Reference-Syntax" target="_blank" rel="noopener">Noweb Reference Syntax</a>:</td>
<td>Literate programming in Org mode.</td>
</tr>
<tr>
<td>• <a href="https://orgmode.org/org.html#Library-of-Babel" target="_blank" rel="noopener">Library of Babel</a>:</td>
<td>Use and contribute to a library of useful code blocks.</td>
</tr>
<tr>
<td>• <a href="https://orgmode.org/org.html#Key-bindings-and-Useful-Functions" target="_blank" rel="noopener">Key bindings and Useful Functions</a>:</td>
<td>Work quickly with code blocks.</td>
</tr>
<tr>
<td>• <a href="https://orgmode.org/org.html#Batch-Execution" target="_blank" rel="noopener">Batch Execution</a>:</td>
<td>Call functions from the command line.</td>
</tr>
</tbody>
</table>
<hr>
<p>Next: <a href="https://orgmode.org/org.html#Using-Header-Arguments" target="_blank" rel="noopener">Using Header Arguments</a>, Up: <a href="https://orgmode.org/org.html#Working-with-Source-Code" target="_blank" rel="noopener">Working with Source Code</a>   [<a href="https://orgmode.org/org.html#SEC_Contents" target="_blank" rel="noopener">Contents</a>][<a href="https://orgmode.org/org.html#Main-Index" target="_blank" rel="noopener">Index</a>]</p>
<h3 id="14-1-Structure-of-Code-Blocks"><a href="#14-1-Structure-of-Code-Blocks" class="headerlink" title="14.1 Structure of Code Blocks"></a>14.1 Structure of Code Blocks</h3><p>Org offers two ways to structure source code in Org documents: in a source code block, and directly inline. Both specifications are shown below.</p>
<p>A source code block conforms to this structure:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">#+NAME: &lt;name&gt;</span><br><span class="line">#+BEGIN_SRC &lt;language&gt; &lt;switches&gt; &lt;header arguments&gt;</span><br><span class="line">  &lt;body&gt;</span><br><span class="line">#+END_SRC</span><br></pre></td></tr></table></figure>
<p>Do not be put-off by having to remember the source block syntax. Org mode offers a command for wrapping existing text in a block (see <a href="https://orgmode.org/org.html#Structure-Templates" target="_blank" rel="noopener">Structure Templates</a>). Org also works with other completion systems in Emacs, some of which predate Org and have custom domain-specific languages for defining templates. Regular use of templates reduces errors, increases accuracy, and maintains consistency.</p>
<p>An inline code block conforms to this structure:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">src_&lt;language&gt;&#123;&lt;body&gt;&#125;</span><br></pre></td></tr></table></figure>
<p>or</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">src_&lt;language&gt;[&lt;header arguments&gt;]&#123;&lt;body&gt;&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li><p>‘#+NAME: <name>’</name></p>
<p>Optional. Names the source block so it can be called, like a function, from other source blocks or inline code to evaluate or to capture the results. Code from other blocks, other files, and from table formulas (see <a href="https://orgmode.org/org.html#The-Spreadsheet" target="_blank" rel="noopener">The Spreadsheet</a>) can use the name to reference a source block. This naming serves the same purpose as naming Org tables. Org mode requires unique names. For duplicate names, Org mode’s behavior is undefined.</p>
</li>
<li><p>‘#+BEGIN_SRC’ … ‘#+END_SRC’</p>
<p>Mandatory. They mark the start and end of a block that Org requires. The ‘#+BEGIN_SRC’ line takes additional arguments, as described next.</p>
</li>
<li><p>‘<language>’</language></p>
<p>Mandatory. It is the identifier of the source code language in the block. See <a href="https://orgmode.org/org.html#Languages" target="_blank" rel="noopener">Languages</a>, for identifiers of supported languages.</p>
</li>
<li><p>‘<switches>’</switches></p>
<p>Optional. Switches provide finer control of the code execution, export, and format (see the discussion of switches in <a href="https://orgmode.org/org.html#Literal-Examples" target="_blank" rel="noopener">Literal Examples</a>).</p>
</li>
<li><p>‘<header arguments>’</header></p>
<p>Optional. Heading arguments control many aspects of evaluation, export and tangling of code blocks (see <a href="https://orgmode.org/org.html#Using-Header-Arguments" target="_blank" rel="noopener">Using Header Arguments</a>). Using Org’s properties feature, header arguments can be selectively applied to the entire buffer or specific sub-trees of the Org document.</p>
</li>
<li><p>‘<body>’</body></p>
<p>Source code in the dialect of the specified language identifier.</p>
</li>
</ul>
<hr>
<p>Next: <a href="https://orgmode.org/org.html#Environment-of-a-Code-Block" target="_blank" rel="noopener">Environment of a Code Block</a>, Previous: <a href="https://orgmode.org/org.html#Structure-of-Code-Blocks" target="_blank" rel="noopener">Structure of Code Blocks</a>, Up: <a href="https://orgmode.org/org.html#Working-with-Source-Code" target="_blank" rel="noopener">Working with Source Code</a>   [<a href="https://orgmode.org/org.html#SEC_Contents" target="_blank" rel="noopener">Contents</a>][<a href="https://orgmode.org/org.html#Main-Index" target="_blank" rel="noopener">Index</a>]</p>
<h3 id="14-2-Using-Header-Arguments"><a href="#14-2-Using-Header-Arguments" class="headerlink" title="14.2 Using Header Arguments"></a>14.2 Using Header Arguments</h3><p>Org comes with many header arguments common to all languages. New header arguments are added for specific languages as they become available for use in source code blocks. A header argument is specified with an initial colon followed by the argument’s name in lowercase.</p>
<p>Since header arguments can be set in several ways, Org prioritizes them in case of overlaps or conflicts by giving local settings a higher priority. Header values in function calls, for example, override header values from global defaults.</p>
<h4 id="System-wide-header-arguments"><a href="#System-wide-header-arguments" class="headerlink" title="System-wide header arguments"></a>System-wide header arguments</h4><p>System-wide values of header arguments can be specified by customizing the <code>org-babel-default-header-args</code> variable, which defaults to the following values:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">:session    =&gt; &quot;none&quot;</span><br><span class="line">:results    =&gt; &quot;replace&quot;</span><br><span class="line">:exports    =&gt; &quot;code&quot;</span><br><span class="line">:cache      =&gt; &quot;no&quot;</span><br><span class="line">:noweb      =&gt; &quot;no&quot;</span><br></pre></td></tr></table></figure>
<p>The example below sets ‘:noweb’ header arguments to ‘yes’, which makes Org expand ‘:noweb’ references by default.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">(setq org-babel-default-header-args</span><br><span class="line">      (cons &apos;(:noweb . &quot;yes&quot;)</span><br><span class="line">            (assq-delete-all :noweb org-babel-default-header-args)))</span><br></pre></td></tr></table></figure>
<p>Each language can have separate default header arguments by customizing the variable <code>org-babel-default-header-args:&lt;LANG&gt;</code>, where <lang> is the name of the language. For details, see the language-specific online documentation at <a href="https://orgmode.org/worg/org-contrib/babel/" target="_blank" rel="noopener">https://orgmode.org/worg/org-contrib/babel/</a>.</lang></p>
<h4 id="Header-arguments-in-Org-mode-properties"><a href="#Header-arguments-in-Org-mode-properties" class="headerlink" title="Header arguments in Org mode properties"></a>Header arguments in Org mode properties</h4><p>For header arguments applicable to the buffer, use ‘PROPERTY’ keyword anywhere in the Org file (see <a href="https://orgmode.org/org.html#Property-Syntax" target="_blank" rel="noopener">Property Syntax</a>).</p>
<p>The following example makes all the R code blocks execute in the same session. Setting ‘:results’ to ‘silent’ ignores the results of executions for all blocks, not just R code blocks; no results inserted for any block.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">#+PROPERTY: header-args:R  :session *R*</span><br><span class="line">#+PROPERTY: header-args    :results silent</span><br></pre></td></tr></table></figure>
<p>Header arguments set through Org’s property drawers (see <a href="https://orgmode.org/org.html#Property-Syntax" target="_blank" rel="noopener">Property Syntax</a>) apply at the sub-tree level on down. Since these property drawers can appear anywhere in the file hierarchy, Org uses outermost call or source block to resolve the values. Org ignores <code>org-use-property-inheritance</code> setting.</p>
<p>In this example, ‘:cache’ defaults to ‘yes’ for all code blocks in the sub-tree.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">* sample header</span><br><span class="line">  :PROPERTIES:</span><br><span class="line">  :header-args:    :cache yes</span><br><span class="line">  :END:</span><br></pre></td></tr></table></figure>
<p>Properties defined through <code>org-set-property</code> function, bound to C-c C-x p, apply to all active languages. They override properties set in <code>org-babel-default-header-args</code>.</p>
<p>Language-specific header arguments are also read from properties ‘header-args:<lang>’ where <lang> is the language identifier. For example,</lang></lang></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">* Heading</span><br><span class="line">  :PROPERTIES:</span><br><span class="line">  :header-args:clojure:    :session *clojure-1*</span><br><span class="line">  :header-args:R:          :session *R*</span><br><span class="line">  :END:</span><br><span class="line">** Subheading</span><br><span class="line">  :PROPERTIES:</span><br><span class="line">  :header-args:clojure:    :session *clojure-2*</span><br><span class="line">  :END:</span><br></pre></td></tr></table></figure>
<p>would force separate sessions for Clojure blocks in ‘Heading’ and ‘Subheading’, but use the same session for all R blocks. Blocks in ‘Subheading’ inherit settings from ‘Heading’.</p>
<h4 id="Code-block-specific-header-arguments"><a href="#Code-block-specific-header-arguments" class="headerlink" title="Code block specific header arguments"></a>Code block specific header arguments</h4><p>Header arguments are most commonly set at the source code block level, on the ‘#+BEGIN_SRC’ line. Arguments set at this level take precedence over those set in the <code>org-babel-default-header-args</code> variable, and also those set as header properties.</p>
<p>In the following example, setting ‘:results’ to ‘silent’ makes it ignore results of the code execution. Setting ‘:exports’ to ‘code’ exports only the body of the code block to HTML or LaTeX.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">#+NAME: factorial</span><br><span class="line">#+BEGIN_SRC haskell :results silent :exports code :var n=0</span><br><span class="line">  fac 0 = 1</span><br><span class="line">  fac n = n * fac (n-1)</span><br><span class="line">#+END_SRC</span><br></pre></td></tr></table></figure>
<p>The same header arguments in an inline code block:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">src_haskell[:exports both]&#123;fac 5&#125;</span><br></pre></td></tr></table></figure>
<p>Code block header arguments can span multiple lines using ‘#+HEADER:’ on each line. Note that Org currently accepts the plural spelling of ‘#+HEADER:’ only as a convenience for backward-compatibility. It may be removed at some point.</p>
<p>Multi-line header arguments on an unnamed code block:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">#+HEADER: :var data1=1</span><br><span class="line">#+BEGIN_SRC emacs-lisp :var data2=2</span><br><span class="line">   (message &quot;data1:%S, data2:%S&quot; data1 data2)</span><br><span class="line">#+END_SRC</span><br><span class="line"></span><br><span class="line">#+RESULTS:</span><br><span class="line">: data1:1, data2:2</span><br></pre></td></tr></table></figure>
<p>Multi-line header arguments on a named code block:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">#+NAME: named-block</span><br><span class="line">#+HEADER: :var data=2</span><br><span class="line">#+BEGIN_SRC emacs-lisp</span><br><span class="line">  (message &quot;data:%S&quot; data)</span><br><span class="line">#+END_SRC</span><br><span class="line"></span><br><span class="line">#+RESULTS: named-block</span><br><span class="line">  : data:2</span><br></pre></td></tr></table></figure>
<h4 id="Header-arguments-in-function-calls"><a href="#Header-arguments-in-function-calls" class="headerlink" title="Header arguments in function calls"></a>Header arguments in function calls</h4><p>Header arguments in function calls are the most specific and override all other settings in case of an overlap. They get the highest priority. Two ‘#+CALL:’ examples are shown below. For the complete syntax of ‘CALL’ keyword, see <a href="https://orgmode.org/org.html#Evaluating-Code-Blocks" target="_blank" rel="noopener">Evaluating Code Blocks</a>.</p>
<p>In this example, ‘:exports results’ header argument is applied to the evaluation of the ‘#+CALL:’ line.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">#+CALL: factorial(n=5) :exports results</span><br></pre></td></tr></table></figure>
<p>In this example, ‘:session special’ header argument is applied to the evaluation of ‘factorial’ code block.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">#+CALL: factorial[:session special](n=5)</span><br></pre></td></tr></table></figure>
<hr>
<p>Next: <a href="https://orgmode.org/org.html#Evaluating-Code-Blocks" target="_blank" rel="noopener">Evaluating Code Blocks</a>, Previous: <a href="https://orgmode.org/org.html#Using-Header-Arguments" target="_blank" rel="noopener">Using Header Arguments</a>, Up: <a href="https://orgmode.org/org.html#Working-with-Source-Code" target="_blank" rel="noopener">Working with Source Code</a>   [<a href="https://orgmode.org/org.html#SEC_Contents" target="_blank" rel="noopener">Contents</a>][<a href="https://orgmode.org/org.html#Main-Index" target="_blank" rel="noopener">Index</a>]</p>
<h3 id="14-3-Environment-of-a-Code-Block"><a href="#14-3-Environment-of-a-Code-Block" class="headerlink" title="14.3 Environment of a Code Block"></a>14.3 Environment of a Code Block</h3><h4 id="Passing-arguments"><a href="#Passing-arguments" class="headerlink" title="Passing arguments"></a>Passing arguments</h4><p>Use ‘var’ for passing arguments to source code blocks. The specifics of variables in code blocks vary by the source language and are covered in the language-specific documentation. The syntax for ‘var’, however, is the same for all languages. This includes declaring a variable, and assigning a default value.</p>
<p>The following syntax is used to pass arguments to code blocks using the ‘var’ header argument.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">:var NAME=ASSIGN</span><br></pre></td></tr></table></figure>
<p>NAME is the name of the variable bound in the code block body. ASSIGN is a literal value, such as a string, a number, a reference to a table, a list, a literal example, another code block—with or without arguments—or the results of evaluating a code block.</p>
<p>Here are examples of passing values by reference:</p>
<ul>
<li><p>table</p>
<p>A table named with a ‘NAME’ keyword.<code>#+NAME: example-table | 1 | | 2 | | 3 | | 4 |  #+NAME: table-length #+BEGIN_SRC emacs-lisp :var table=example-table   (length table) #+END_SRC  #+RESULTS: table-length : 4</code>When passing a table, you can treat specially the row, or the column, containing labels for the columns, or the rows, in the table.The ‘colnames’ header argument accepts ‘yes’, ‘no’, or ‘nil’ values. The default value is ‘nil’: if an input table has column names—because the second row is a horizontal rule—then Org removes the column names, processes the table, puts back the column names, and then writes the table to the results block. Using ‘yes’, Org does the same to the first row, even if the initial table does not contain any horizontal rule. When set to ‘no’, Org does not pre-process column names at all.<code>#+NAME: less-cols | a | |---| | b | | c |  #+BEGIN_SRC python :var tab=less-cols :colnames nil   return [[val + &#39;*&#39; for val in row] for row in tab] #+END_SRC  #+RESULTS: | a  | |----| | b* | | c* |</code>Similarly, the ‘rownames’ header argument can take two values: ‘yes’ or ‘no’. When set to ‘yes’, Org removes the first column, processes the table, puts back the first column, and then writes the table to the results block. The default is ‘no’, which means Org does not pre-process the first column. Note that Emacs Lisp code blocks ignore ‘rownames’ header argument because of the ease of table-handling in Emacs.<code>#+NAME: with-rownames | one | 1 | 2 | 3 | 4 |  5 | | two | 6 | 7 | 8 | 9 | 10 |  #+BEGIN_SRC python :var tab=with-rownames :rownames yes   return [[val + 10 for val in row] for row in tab] #+END_SRC  #+RESULTS: | one | 11 | 12 | 13 | 14 | 15 | | two | 16 | 17 | 18 | 19 | 20 |</code></p>
</li>
<li><p>list</p>
<p>A simple named list.<code>#+NAME: example-list - simple   - not   - nested - list  #+BEGIN_SRC emacs-lisp :var x=example-list   (print x) #+END_SRC  #+RESULTS: | simple | list |</code>Note that only the top level list items are passed along. Nested list items are ignored.</p>
</li>
<li><p>code block without arguments</p>
<p>A code block name, as assigned by ‘NAME’ keyword from the example above, optionally followed by parentheses.<code>#+BEGIN_SRC emacs-lisp :var length=table-length()   (* 2 length) #+END_SRC  #+RESULTS: : 8</code></p>
</li>
<li><p>code block with arguments</p>
<p>A code block name, as assigned by ‘NAME’ keyword, followed by parentheses and optional arguments passed within the parentheses.<code>#+NAME: double #+BEGIN_SRC emacs-lisp :var input=8   (* 2 input) #+END_SRC  #+RESULTS: double : 16  #+NAME: squared #+BEGIN_SRC emacs-lisp :var input=double(input=1)   (* input input) #+END_SRC  #+RESULTS: squared : 4</code></p>
</li>
<li><p>literal example</p>
<p>A literal example block named with a ‘NAME’ keyword.<code>#+NAME: literal-example #+BEGIN_EXAMPLE   A literal example   on two lines #+END_EXAMPLE  #+NAME: read-literal-example #+BEGIN_SRC emacs-lisp :var x=literal-example   (concatenate #&#39;string x &quot; for you.&quot;) #+END_SRC  #+RESULTS: read-literal-example : A literal example : on two lines for you.</code></p>
</li>
</ul>
<p>Indexing variable values enables referencing portions of a variable. Indexes are 0 based with negative values counting backwards from the end. If an index is separated by commas then each subsequent section indexes as the next dimension. Note that this indexing occurs <em>before</em> other table-related header arguments are applied, such as ‘hlines’, ‘colnames’ and ‘rownames’. The following example assigns the last cell of the first row the table ‘example-table’ to the variable ‘data’:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">#+NAME: example-table</span><br><span class="line">| 1 | a |</span><br><span class="line">| 2 | b |</span><br><span class="line">| 3 | c |</span><br><span class="line">| 4 | d |</span><br><span class="line"></span><br><span class="line">#+BEGIN_SRC emacs-lisp :var data=example-table[0,-1]</span><br><span class="line">  data</span><br><span class="line">#+END_SRC</span><br><span class="line"></span><br><span class="line">#+RESULTS:</span><br><span class="line">: a</span><br></pre></td></tr></table></figure>
<p>Two integers separated by a colon reference a range of variable values. In that case the entire inclusive range is referenced. For example the following assigns the middle three rows of ‘example-table’ to ‘data’.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">#+NAME: example-table</span><br><span class="line">| 1 | a |</span><br><span class="line">| 2 | b |</span><br><span class="line">| 3 | c |</span><br><span class="line">| 4 | d |</span><br><span class="line">| 5 | 3 |</span><br><span class="line"></span><br><span class="line">#+BEGIN_SRC emacs-lisp :var data=example-table[1:3]</span><br><span class="line">  data</span><br><span class="line">#+END_SRC</span><br><span class="line"></span><br><span class="line">#+RESULTS:</span><br><span class="line">| 2 | b |</span><br><span class="line">| 3 | c |</span><br><span class="line">| 4 | d |</span><br></pre></td></tr></table></figure>
<p>To pick the entire range, use an empty index, or the single character ‘*’. ‘0:-1’ does the same thing. Example below shows how to reference the first column only.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">#+NAME: example-table</span><br><span class="line">| 1 | a |</span><br><span class="line">| 2 | b |</span><br><span class="line">| 3 | c |</span><br><span class="line">| 4 | d |</span><br><span class="line"></span><br><span class="line">#+BEGIN_SRC emacs-lisp :var data=example-table[,0]</span><br><span class="line">  data</span><br><span class="line">#+END_SRC</span><br><span class="line"></span><br><span class="line">#+RESULTS:</span><br><span class="line">| 1 | 2 | 3 | 4 |</span><br></pre></td></tr></table></figure>
<p>Index referencing can be used for tables and code blocks. Index referencing can handle any number of dimensions. Commas delimit multiple dimensions, as shown below.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">#+NAME: 3D</span><br><span class="line">#+BEGIN_SRC emacs-lisp</span><br><span class="line">  &apos;(((1  2  3)  (4  5  6)  (7  8  9))</span><br><span class="line">    ((10 11 12) (13 14 15) (16 17 18))</span><br><span class="line">    ((19 20 21) (22 23 24) (25 26 27)))</span><br><span class="line">#+END_SRC</span><br><span class="line"></span><br><span class="line">#+BEGIN_SRC emacs-lisp :var data=3D[1,,1]</span><br><span class="line">  data</span><br><span class="line">#+END_SRC</span><br><span class="line"></span><br><span class="line">#+RESULTS:</span><br><span class="line">| 11 | 14 | 17 |</span><br></pre></td></tr></table></figure>
<p>Note that row names and column names are not removed prior to variable indexing. You need to take them into account, even when ‘colnames’ or ‘rownames’ header arguments remove them.</p>
<p>Emacs lisp code can also set the values for variables. To differentiate a value from Lisp code, Org interprets any value starting with ‘(’, ‘[’, ‘’’ or ‘`’ as Emacs Lisp code. The result of evaluating that code is then assigned to the value of that variable. The following example shows how to reliably query and pass the file name of the Org mode buffer to a code block using headers. We need reliability here because the file’s name could change once the code in the block starts executing.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">#+BEGIN_SRC sh :var filename=(buffer-file-name) :exports both</span><br><span class="line">  wc -w $filename</span><br><span class="line">#+END_SRC</span><br></pre></td></tr></table></figure>
<p>Note that values read from tables and lists are not mistakenly evaluated as Emacs Lisp code, as illustrated in the following example.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">#+NAME: table</span><br><span class="line">| (a b c) |</span><br><span class="line"></span><br><span class="line">#+HEADER: :var data=table[0,0]</span><br><span class="line">#+BEGIN_SRC perl</span><br><span class="line">  $data</span><br><span class="line">#+END_SRC</span><br><span class="line"></span><br><span class="line">#+RESULTS:</span><br><span class="line">: (a b c)</span><br></pre></td></tr></table></figure>
<h4 id="Using-sessions"><a href="#Using-sessions" class="headerlink" title="Using sessions"></a>Using sessions</h4><p>Two code blocks can share the same environment. The ‘session’ header argument is for running multiple source code blocks under one session. Org runs code blocks with the same session name in the same interpreter process.</p>
<ul>
<li><p>‘none’</p>
<p>Default. Each code block gets a new interpreter process to execute. The process terminates once the block is evaluated.</p>
</li>
<li><p>STRING</p>
<p>Any string besides ‘none’ turns that string into the name of that session. For example, ‘:session STRING’ names it ‘STRING’. If ‘session’ has no value, then the session name is derived from the source language identifier. Subsequent blocks with the same source code language use the same session. Depending on the language, state variables, code from other blocks, and the overall interpreted environment may be shared. Some interpreted languages support concurrent sessions when subsequent source code language blocks change session names.</p>
</li>
</ul>
<p>Only languages that provide interactive evaluation can have session support. Not all languages provide this support, such as C and ditaa. Even languages, such as Python and Haskell, that do support interactive evaluation impose limitations on allowable language constructs that can run interactively. Org inherits those limitations for those code blocks running in a session.</p>
<h4 id="Choosing-a-working-directory"><a href="#Choosing-a-working-directory" class="headerlink" title="Choosing a working directory"></a>Choosing a working directory</h4><p>The ‘dir’ header argument specifies the default directory during code block execution. If it is absent, then the directory associated with the current buffer is used. In other words, supplying ‘:dir PATH’ temporarily has the same effect as changing the current directory with M-x cd PATH, and then not setting ‘dir’. Under the surface, ‘dir’ simply sets the value of the Emacs variable <code>default-directory</code>.</p>
<p>For example, to save the plot file in the ‘Work/’ folder of the home directory—notice tilde is expanded:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">#+BEGIN_SRC R :file myplot.png :dir ~/Work</span><br><span class="line">  matplot(matrix(rnorm(100), 10), type=&quot;l&quot;)</span><br><span class="line">#+END_SRC</span><br></pre></td></tr></table></figure>
<p>To evaluate the code block on a remote machine, supply a remote directory name using Tramp syntax. For example:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">#+BEGIN_SRC R :file plot.png :dir /scp:dand@yakuba.princeton.edu:</span><br><span class="line">  plot(1:10, main=system(&quot;hostname&quot;, intern=TRUE))</span><br><span class="line">#+END_SRC</span><br></pre></td></tr></table></figure>
<p>Org first captures the text results as usual for insertion in the Org file. Then Org also inserts a link to the remote file, thanks to Emacs Tramp. Org constructs the remote path to the file name from ‘dir’ and <code>default-directory</code>, as illustrated here:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[[file:/scp:dand@yakuba.princeton.edu:/home/dand/plot.png][plot.png]]</span><br></pre></td></tr></table></figure>
<p>When ‘dir’ is used with ‘session’, Org sets the starting directory for a new session. But Org does not alter the directory of an already existing session.</p>
<p>Do not use ‘dir’ with ‘:exports results’ or with ‘:exports both’ to avoid Org inserting incorrect links to remote files. That is because Org does not expand <code>default directory</code> to avoid some underlying portability issues.</p>
<h4 id="Inserting-headers-and-footers"><a href="#Inserting-headers-and-footers" class="headerlink" title="Inserting headers and footers"></a>Inserting headers and footers</h4><p>The ‘prologue’ header argument is for appending to the top of the code block for execution, like a reset instruction. For example, you may use ‘:prologue “reset”’ in a Gnuplot code block or, for every such block:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">(add-to-list &apos;org-babel-default-header-args:gnuplot</span><br><span class="line">             &apos;((:prologue . &quot;reset&quot;)))</span><br></pre></td></tr></table></figure>
<p>Likewise, the value of the ‘epilogue’ header argument is for appending to the end of the code block for execution.</p>
<hr>
<p>Next: <a href="https://orgmode.org/org.html#Results-of-Evaluation" target="_blank" rel="noopener">Results of Evaluation</a>, Previous: <a href="https://orgmode.org/org.html#Environment-of-a-Code-Block" target="_blank" rel="noopener">Environment of a Code Block</a>, Up: <a href="https://orgmode.org/org.html#Working-with-Source-Code" target="_blank" rel="noopener">Working with Source Code</a>   [<a href="https://orgmode.org/org.html#SEC_Contents" target="_blank" rel="noopener">Contents</a>][<a href="https://orgmode.org/org.html#Main-Index" target="_blank" rel="noopener">Index</a>]</p>
<h3 id="14-4-Evaluating-Code-Blocks"><a href="#14-4-Evaluating-Code-Blocks" class="headerlink" title="14.4 Evaluating Code Blocks"></a>14.4 Evaluating Code Blocks</h3><p>A note about security: With code evaluation comes the risk of harm. Org safeguards by prompting for user’s permission before executing any code in the source block. To customize this safeguard, or disable it, see <a href="https://orgmode.org/org.html#Code-Evaluation-Security" target="_blank" rel="noopener">Code Evaluation Security</a>.</p>
<h4 id="How-to-evaluate-source-code"><a href="#How-to-evaluate-source-code" class="headerlink" title="How to evaluate source code"></a>How to evaluate source code</h4><p>Org captures the results of the code block evaluation and inserts them in the Org file, right after the code block. The insertion point is after a newline and the ‘RESULTS’ keyword. Org creates the ‘RESULTS’ keyword if one is not already there.</p>
<p>By default, Org enables only Emacs Lisp code blocks for execution. See <a href="https://orgmode.org/org.html#Languages" target="_blank" rel="noopener">Languages</a> to enable other languages.</p>
<p>Org provides many ways to execute code blocks. C-c C-c or C-c C-v e with the point on a code block<a href="https://orgmode.org/org.html#FOOT141" target="_blank" rel="noopener">141</a> calls the <code>org-babel-execute-src-block</code> function, which executes the code in the block, collects the results, and inserts them in the buffer.</p>
<p>By calling a named code block<a href="https://orgmode.org/org.html#FOOT142" target="_blank" rel="noopener">142</a> from an Org mode buffer or a table. Org can call the named code blocks from the current Org mode buffer or from the “Library of Babel” (see <a href="https://orgmode.org/org.html#Library-of-Babel" target="_blank" rel="noopener">Library of Babel</a>).</p>
<p>The syntax for ‘CALL’ keyword is:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">#+CALL: &lt;name&gt;(&lt;arguments&gt;)</span><br><span class="line">#+CALL: &lt;name&gt;[&lt;inside header arguments&gt;](&lt;arguments&gt;) &lt;end header arguments&gt;</span><br></pre></td></tr></table></figure>
<p>The syntax for inline named code blocks is:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">... call_&lt;name&gt;(&lt;arguments&gt;) ...</span><br><span class="line">... call_&lt;name&gt;[&lt;inside header arguments&gt;](&lt;arguments&gt;)[&lt;end header arguments&gt;] ...</span><br></pre></td></tr></table></figure>
<p>When inline syntax is used, the result is wrapped based on the variable <code>org-babel-inline-result-wrap</code>, which by default is set to <code>&quot;=%s=&quot;</code> to produce verbatim text suitable for markup.</p>
<ul>
<li><p>‘<name>’</name></p>
<p>This is the name of the code block (see <a href="https://orgmode.org/org.html#Structure-of-Code-Blocks" target="_blank" rel="noopener">Structure of Code Blocks</a>) to be evaluated in the current document. If the block is located in another file, start ‘<name>’ with the file name followed by a colon. For example, in order to execute a block named ‘clear-data’ in ‘file.org’, you can write the following:<code>#+CALL: file.org:clear-data()</code></name></p>
</li>
<li><p>‘<arguments>’</arguments></p>
<p>Org passes arguments to the code block using standard function call syntax. For example, a ‘#+CALL:’ line that passes ‘4’ to a code block named ‘double’, which declares the header argument ‘:var n=2’, would be written as:<code>#+CALL: double(n=4)</code>Note how this function call syntax is different from the header argument syntax.</p>
</li>
<li><p>‘<inside header arguments>’</inside></p>
<p>Org passes inside header arguments to the named code block using the header argument syntax. Inside header arguments apply to code block evaluation. For example, ‘[:results output]’ collects results printed to stdout during code execution of that block. Note how this header argument syntax is different from the function call syntax.</p>
</li>
<li><p>‘<end header arguments>’</end></p>
<p>End header arguments affect the results returned by the code block. For example, ‘:results html’ wraps the results in a ‘#+BEGIN_EXPORT html’ block before inserting the results in the Org buffer.</p>
</li>
</ul>
<h4 id="Limit-code-block-evaluation"><a href="#Limit-code-block-evaluation" class="headerlink" title="Limit code block evaluation"></a>Limit code block evaluation</h4><p>The ‘eval’ header argument can limit evaluation of specific code blocks and ‘CALL’ keyword. It is useful for protection against evaluating untrusted code blocks by prompting for a confirmation.</p>
<ul>
<li><p>‘never’ or ‘no’</p>
<p>Org never evaluates the source code.</p>
</li>
<li><p>‘query’</p>
<p>Org prompts the user for permission to evaluate the source code.</p>
</li>
<li><p>‘never-export’ or ‘no-export’</p>
<p>Org does not evaluate the source code when exporting, yet the user can evaluate it interactively.</p>
</li>
<li><p>‘query-export’</p>
<p>Org prompts the user for permission to evaluate the source code during export.</p>
</li>
</ul>
<p>If ‘eval’ header argument is not set, then Org determines whether to evaluate the source code from the <code>org-confirm-babel-evaluate</code> variable (see <a href="https://orgmode.org/org.html#Code-Evaluation-Security" target="_blank" rel="noopener">Code Evaluation Security</a>).</p>
<h4 id="Cache-results-of-evaluation"><a href="#Cache-results-of-evaluation" class="headerlink" title="Cache results of evaluation"></a>Cache results of evaluation</h4><p>The ‘cache’ header argument is for caching results of evaluating code blocks. Caching results can avoid re-evaluating a code block that have not changed since the previous run. To benefit from the cache and avoid redundant evaluations, the source block must have a result already present in the buffer, and neither the header arguments—including the value of ‘var’ references—nor the text of the block itself has changed since the result was last computed. This feature greatly helps avoid long-running calculations. For some edge cases, however, the cached results may not be reliable.</p>
<p>The caching feature is best for when code blocks are pure functions, that is functions that return the same value for the same input arguments (see <a href="https://orgmode.org/org.html#Environment-of-a-Code-Block" target="_blank" rel="noopener">Environment of a Code Block</a>), and that do not have side effects, and do not rely on external variables other than the input arguments. Functions that depend on a timer, file system objects, and random number generators are clearly unsuitable for caching.</p>
<p>A note of warning: when ‘cache’ is used in a session, caching may cause unexpected results.</p>
<p>When the caching mechanism tests for any source code changes, it does not expand Noweb style references (see <a href="https://orgmode.org/org.html#Noweb-Reference-Syntax" target="_blank" rel="noopener">Noweb Reference Syntax</a>). For reasons why, see <a href="http://thread.gmane.org/gmane.emacs.orgmode/79046" target="_blank" rel="noopener">http://thread.gmane.org/gmane.emacs.orgmode/79046</a>.</p>
<p>The ‘cache’ header argument can have one of two values: ‘yes’ or ‘no’.</p>
<ul>
<li><p>‘no’</p>
<p>Default. No caching of results; code block evaluated every time.</p>
</li>
<li><p>‘yes’</p>
<p>Whether to run the code or return the cached results is determined by comparing the SHA1 hash value of the combined code block and arguments passed to it. This hash value is packed on the ‘#+RESULTS:’ line from previous evaluation. When hash values match, Org does not evaluate the code block. When hash values mismatch, Org evaluates the code block, inserts the results, recalculates the hash value, and updates ‘#+RESULTS:’ line.</p>
</li>
</ul>
<p>In this example, both functions are cached. But ‘caller’ runs only if the result from ‘random’ has changed since the last run.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">#+NAME: random</span><br><span class="line">#+BEGIN_SRC R :cache yes</span><br><span class="line">  runif(1)</span><br><span class="line">#+END_SRC</span><br><span class="line"></span><br><span class="line">#+RESULTS[a2a72cd647ad44515fab62e144796432793d68e1]: random</span><br><span class="line">0.4659510825295</span><br><span class="line"></span><br><span class="line">#+NAME: caller</span><br><span class="line">#+BEGIN_SRC emacs-lisp :var x=random :cache yes</span><br><span class="line">  x</span><br><span class="line">#+END_SRC</span><br><span class="line"></span><br><span class="line">#+RESULTS[bec9c8724e397d5df3b696502df3ed7892fc4f5f]: caller</span><br><span class="line">0.254227238707244</span><br></pre></td></tr></table></figure>
<hr>
<p>Next: <a href="https://orgmode.org/org.html#Exporting-Code-Blocks" target="_blank" rel="noopener">Exporting Code Blocks</a>, Previous: <a href="https://orgmode.org/org.html#Evaluating-Code-Blocks" target="_blank" rel="noopener">Evaluating Code Blocks</a>, Up: <a href="https://orgmode.org/org.html#Working-with-Source-Code" target="_blank" rel="noopener">Working with Source Code</a>   [<a href="https://orgmode.org/org.html#SEC_Contents" target="_blank" rel="noopener">Contents</a>][<a href="https://orgmode.org/org.html#Main-Index" target="_blank" rel="noopener">Index</a>]</p>
<h3 id="14-5-Results-of-Evaluation"><a href="#14-5-Results-of-Evaluation" class="headerlink" title="14.5 Results of Evaluation"></a>14.5 Results of Evaluation</h3><p>How Org handles results of a code block execution depends on many header arguments working together. The primary determinant, however, is the ‘results’ header argument. It accepts four classes of options. Each code block can take only one option per class:</p>
<ul>
<li><p>collection</p>
<p>For how the results should be collected from the code block;</p>
</li>
<li><p>type</p>
<p>For which type of result the code block will return; affects how Org processes and inserts results in the Org buffer;</p>
</li>
<li><p>format</p>
<p>For the result; affects how Org processes and inserts results in the Org buffer;</p>
</li>
<li><p>handling</p>
<p>For processing results after evaluation of the code block;</p>
</li>
</ul>
<h4 id="Collection"><a href="#Collection" class="headerlink" title="Collection"></a>Collection</h4><p>Collection options specify the results. Choose one of the options; they are mutually exclusive.</p>
<ul>
<li><p>‘value’</p>
<p>Default. Functional mode. Org gets the value by wrapping the code in a function definition in the language of the source block. That is why when using ‘:results value’, code should execute like a function and return a value. For languages like Python, an explicit <code>return</code> statement is mandatory when using ‘:results value’. Result is the value returned by the last statement in the code block.When evaluating the code block in a session (see <a href="https://orgmode.org/org.html#Environment-of-a-Code-Block" target="_blank" rel="noopener">Environment of a Code Block</a>), Org passes the code to an interpreter running as an interactive Emacs inferior process. Org gets the value from the source code interpreter’s last statement output. Org has to use language-specific methods to obtain the value. For example, from the variable <code>_</code> in Python and Ruby, and the value of <code>.Last.value</code> in R.</p>
</li>
<li><p>‘output’</p>
<p>Scripting mode. Org passes the code to an external process running the interpreter. Org returns the contents of the standard output stream as text results.When using a session, Org passes the code to the interpreter running as an interactive Emacs inferior process. Org concatenates any text output from the interpreter and returns the collection as a result.Note that this collection is not the same as that would be collected from stdout of a non-interactive interpreter running as an external process. Compare for example these two blocks:<code>#+BEGIN_SRC python :results output   print &quot;hello&quot;   2   print &quot;bye&quot; #+END_SRC  #+RESULTS: : hello : bye</code>In the above non-session mode, the “2” is not printed; so it does not appear in results.<code>#+BEGIN_SRC python :results output :session   print &quot;hello&quot;   2   print &quot;bye&quot; #+END_SRC  #+RESULTS: : hello : 2 : bye</code>In the above session, the interactive interpreter receives and prints “2”. Results show that.</p>
</li>
</ul>
<h4 id="Type"><a href="#Type" class="headerlink" title="Type"></a>Type</h4><p>Type tells what result types to expect from the execution of the code block. Choose one of the options; they are mutually exclusive. The default behavior is to automatically determine the result type.</p>
<ul>
<li><p>‘table’</p>
</li>
<li><p>‘vector’</p>
<p>Interpret the results as an Org table. If the result is a single value, create a table with one row and one column. Usage example: ‘:results value table’.In-between each table row or below the table headings, sometimes results have horizontal lines, which are also known as “hlines”. The ‘hlines’ argument with the default ‘no’ value strips such lines from the input table. For most code, this is desirable, or else those ‘hline’ symbols raise unbound variable errors. A ‘yes’ accepts such lines, as demonstrated in the following example.<code>#+NAME: many-cols | a | b | c | |---+---+---| | d | e | f | |---+---+---| | g | h | i |  #+NAME: no-hline #+BEGIN_SRC python :var tab=many-cols :hlines no   return tab #+END_SRC  #+RESULTS: no-hline | a | b | c | | d | e | f | | g | h | i |  #+NAME: hlines #+BEGIN_SRC python :var tab=many-cols :hlines yes   return tab #+END_SRC  #+RESULTS: hlines | a | b | c | |---+---+---| | d | e | f | |---+---+---| | g | h | i |</code></p>
</li>
<li><p>‘list’</p>
<p>Interpret the results as an Org list. If the result is a single value, create a list of one element.</p>
</li>
<li><p>‘scalar’</p>
</li>
<li><p>‘verbatim’</p>
<p>Interpret literally and insert as quoted text. Do not create a table. Usage example: ‘:results value verbatim’.</p>
</li>
<li><p>‘file’</p>
<p>Interpret as a filename. Save the results of execution of the code block to that file, then insert a link to it. You can control both the filename and the description associated to the link.Org first tries to generate the filename from the value of the ‘file’ header argument and the directory specified using the ‘output-dir’ header arguments. If ‘output-dir’ is not specified, Org assumes it is the current directory.<code>#+BEGIN_SRC asymptote :results value file :file circle.pdf :output-dir img/   size(2cm);   draw(unitcircle); #+END_SRC</code>If ‘file’ is missing, Org generates the base name of the output file from the name of the code block, and its extension from the ‘file-ext’ header argument. In that case, both the name and the extension are mandatory<a href="https://orgmode.org/org.html#FOOT143" target="_blank" rel="noopener">143</a>.<code>#+name: circle #+BEGIN_SRC asymptote :results value file :file-ext pdf   size(2cm);   draw(unitcircle); #+END_SRC</code>The ‘file-desc’ header argument defines the description (see <a href="https://orgmode.org/org.html#Link-Format" target="_blank" rel="noopener">Link Format</a>) for the link. If ‘file-desc’ has no value, Org uses the generated file name for both the “link” and “description” parts of the link.By default, Org assumes that a table written to a file has TAB-delimited output. You can choose a different separator with the ‘sep’ header argument.</p>
</li>
</ul>
<h4 id="Format"><a href="#Format" class="headerlink" title="Format"></a>Format</h4><p>Format pertains to the type of the result returned by the code block. Choose one of the options; they are mutually exclusive. The default follows from the type specified above.</p>
<ul>
<li><p>‘code’</p>
<p>Result enclosed in a code block. Useful for parsing. Usage example: ‘:results value code’.</p>
</li>
<li><p>‘drawer’</p>
<p>Result wrapped in a ‘RESULTS’ drawer. Useful for containing ‘raw’ or ‘org’ results for later scripting and automated processing. Usage example: ‘:results value drawer’.</p>
</li>
<li><p>‘html’</p>
<p>Results enclosed in a ‘BEGIN_EXPORT html’ block. Usage example: ‘:results value html’.</p>
</li>
<li><p>‘latex’</p>
<p>Results enclosed in a ‘BEGIN_EXPORT latex’ block. Usage example: ‘:results value latex’.</p>
</li>
<li><p>‘link’</p>
</li>
<li><p>‘graphics’</p>
<p>Result is a link to the file specified in ‘:file’ header argument. However, unlike plain ‘:file’, nothing is written to the disk. The block is used for its side-effects only, as in the following example:<code>#+begin_src shell :results link :file &quot;download.tar.gz&quot; wget -c &quot;http://example.com/download.tar.gz&quot; #+end_src</code></p>
</li>
<li><p>‘org’</p>
<p>Results enclosed in a ‘BEGIN_SRC org’ block. For comma-escape, either TAB in the block, or export the file. Usage example: ‘:results value org’.</p>
</li>
<li><p>‘pp’</p>
<p>Result converted to pretty-print source code. Enclosed in a code block. Languages supported: Emacs Lisp, Python, and Ruby. Usage example: ‘:results value pp’.</p>
</li>
<li><p>‘raw’</p>
<p>Interpreted as raw Org mode. Inserted directly into the buffer. Aligned if it is a table. Usage example: ‘:results value raw’.</p>
</li>
</ul>
<p>The ‘wrap’ header argument unconditionnally marks the results block by appending strings to ‘#+BEGIN_’ and ‘#+END_’. If no string is specified, Org wraps the results in a ‘#+BEGIN_results’ … ‘#+END_results’ block. It takes precedent over the ‘results’ value listed above. E.g.,</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">#+BEGIN_SRC emacs-lisp :results html :wrap EXPORT markdown</span><br><span class="line">&quot;&lt;blink&gt;Welcome back to the 90&apos;s&lt;/blink&gt;&quot;</span><br><span class="line">#+END_SRC</span><br><span class="line"></span><br><span class="line">#+RESULTS:</span><br><span class="line">#+BEGIN_EXPORT markdown</span><br><span class="line">&lt;blink&gt;Welcome back to the 90&apos;s&lt;/blink&gt;</span><br><span class="line">#+END_EXPORT</span><br></pre></td></tr></table></figure>
<h4 id="Handling"><a href="#Handling" class="headerlink" title="Handling"></a>Handling</h4><p>Handling options after collecting the results.</p>
<ul>
<li><p>‘silent’</p>
<p>Do not insert results in the Org mode buffer, but echo them in the minibuffer. Usage example: ‘:results output silent’.</p>
</li>
<li><p>‘replace’</p>
<p>Default. Insert results in the Org buffer. Remove previous results. Usage example: ‘:results output replace’.</p>
</li>
<li><p>‘append’</p>
<p>Append results to the Org buffer. Latest results are at the bottom. Does not remove previous results. Usage example: ‘:results output append’.</p>
</li>
<li><p>‘prepend’</p>
<p>Prepend results to the Org buffer. Latest results are at the top. Does not remove previous results. Usage example: ‘:results output prepend’.</p>
</li>
</ul>
<h4 id="Post-processing"><a href="#Post-processing" class="headerlink" title="Post-processing"></a>Post-processing</h4><p>The ‘post’ header argument is for post-processing results from block evaluation. When ‘post’ has any value, Org binds the results to <code>*this*</code> variable for easy passing to ‘var’ header argument specifications (see <a href="https://orgmode.org/org.html#Environment-of-a-Code-Block" target="_blank" rel="noopener">Environment of a Code Block</a>). That makes results available to other code blocks, or even for direct Emacs Lisp code execution.</p>
<p>The following two examples illustrate ‘post’ header argument in action. The first one shows how to attach an ‘ATTR_LATEX’ keyword using ‘post’.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">#+NAME: attr_wrap</span><br><span class="line">#+BEGIN_SRC sh :var data=&quot;&quot; :var width=&quot;\\textwidth&quot; :results output</span><br><span class="line">  echo &quot;#+ATTR_LATEX: :width $width&quot;</span><br><span class="line">  echo &quot;$data&quot;</span><br><span class="line">#+END_SRC</span><br><span class="line"></span><br><span class="line">#+HEADER: :file /tmp/it.png</span><br><span class="line">#+BEGIN_SRC dot :post attr_wrap(width=&quot;5cm&quot;, data=*this*) :results drawer</span><br><span class="line">  digraph&#123;</span><br><span class="line">          a -&gt; b;</span><br><span class="line">          b -&gt; c;</span><br><span class="line">          c -&gt; a;</span><br><span class="line">  &#125;</span><br><span class="line">#+end_src</span><br><span class="line"></span><br><span class="line">#+RESULTS:</span><br><span class="line">:RESULTS:</span><br><span class="line">#+ATTR_LATEX :width 5cm</span><br><span class="line">[[file:/tmp/it.png]]</span><br><span class="line">:END:</span><br></pre></td></tr></table></figure>
<p>The second example shows use of ‘colnames’ header argument in ‘post’ to pass data between code blocks.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">#+NAME: round-tbl</span><br><span class="line">#+BEGIN_SRC emacs-lisp :var tbl=&quot;&quot; fmt=&quot;%.3f&quot;</span><br><span class="line">  (mapcar (lambda (row)</span><br><span class="line">            (mapcar (lambda (cell)</span><br><span class="line">                      (if (numberp cell)</span><br><span class="line">                          (format fmt cell)</span><br><span class="line">                        cell))</span><br><span class="line">                    row))</span><br><span class="line">          tbl)</span><br><span class="line">#+end_src</span><br><span class="line"></span><br><span class="line">#+BEGIN_SRC R :colnames yes :post round-tbl[:colnames yes](*this*)</span><br><span class="line">  set.seed(42)</span><br><span class="line">  data.frame(foo=rnorm(1))</span><br><span class="line">#+END_SRC</span><br><span class="line"></span><br><span class="line">#+RESULTS:</span><br><span class="line">|   foo |</span><br><span class="line">|-------|</span><br><span class="line">| 1.371 |</span><br></pre></td></tr></table></figure>
<hr>
<p>Next: <a href="https://orgmode.org/org.html#Extracting-Source-Code" target="_blank" rel="noopener">Extracting Source Code</a>, Previous: <a href="https://orgmode.org/org.html#Results-of-Evaluation" target="_blank" rel="noopener">Results of Evaluation</a>, Up: <a href="https://orgmode.org/org.html#Working-with-Source-Code" target="_blank" rel="noopener">Working with Source Code</a>   [<a href="https://orgmode.org/org.html#SEC_Contents" target="_blank" rel="noopener">Contents</a>][<a href="https://orgmode.org/org.html#Main-Index" target="_blank" rel="noopener">Index</a>]</p>
<h3 id="14-6-Exporting-Code-Blocks"><a href="#14-6-Exporting-Code-Blocks" class="headerlink" title="14.6 Exporting Code Blocks"></a>14.6 Exporting Code Blocks</h3><p>It is possible to export the <em>code</em> of code blocks, the <em>results</em> of code block evaluation, <em>both</em> the code and the results of code block evaluation, or <em>none</em>. Org defaults to exporting <em>code</em> for most languages. For some languages, such as ditaa, Org defaults to <em>results</em>. To export just the body of code blocks, see <a href="https://orgmode.org/org.html#Literal-Examples" target="_blank" rel="noopener">Literal Examples</a>. To selectively export sub-trees of an Org document, see <a href="https://orgmode.org/org.html#Exporting" target="_blank" rel="noopener">Exporting</a>.</p>
<p>The ‘exports’ header argument is to specify if that part of the Org file is exported to, say, HTML or LaTeX formats.</p>
<ul>
<li><p>‘code’</p>
<p>The default. The body of code is included into the exported file. Example: ‘:exports code’.</p>
</li>
<li><p>‘results’</p>
<p>The results of evaluation of the code is included in the exported file. Example: ‘:exports results’.</p>
</li>
<li><p>‘both’</p>
<p>Both the code and results of evaluation are included in the exported file. Example: ‘:exports both’.</p>
</li>
<li><p>‘none’</p>
<p>Neither the code nor the results of evaluation is included in the exported file. Whether the code is evaluated at all depends on other options. Example: ‘:exports none’.</p>
</li>
</ul>
<p>To stop Org from evaluating code blocks to speed exports, use the header argument ‘:eval never-export’ (see <a href="https://orgmode.org/org.html#Evaluating-Code-Blocks" target="_blank" rel="noopener">Evaluating Code Blocks</a>). To stop Org from evaluating code blocks for greater security, set the <code>org-export-use-babel</code> variable to <code>nil</code>, but understand that header arguments will have no effect.</p>
<p>Turning off evaluation comes in handy when batch processing. For example, markup languages for wikis, which have a high risk of untrusted code. Stopping code block evaluation also stops evaluation of all header arguments of the code block. This may not be desirable in some circumstances. So during export, to allow evaluation of just the header arguments but not any code evaluation in the source block, set ‘:eval never-export’ (see <a href="https://orgmode.org/org.html#Evaluating-Code-Blocks" target="_blank" rel="noopener">Evaluating Code Blocks</a>).</p>
<p>Org never evaluates code blocks in commented sub-trees when exporting (see <a href="https://orgmode.org/org.html#Comment-Lines" target="_blank" rel="noopener">Comment Lines</a>). On the other hand, Org does evaluate code blocks in sub-trees excluded from export (see <a href="https://orgmode.org/org.html#Export-Settings" target="_blank" rel="noopener">Export Settings</a>).</p>
<hr>
<p>Next: <a href="https://orgmode.org/org.html#Languages" target="_blank" rel="noopener">Languages</a>, Previous: <a href="https://orgmode.org/org.html#Exporting-Code-Blocks" target="_blank" rel="noopener">Exporting Code Blocks</a>, Up: <a href="https://orgmode.org/org.html#Working-with-Source-Code" target="_blank" rel="noopener">Working with Source Code</a>   [<a href="https://orgmode.org/org.html#SEC_Contents" target="_blank" rel="noopener">Contents</a>][<a href="https://orgmode.org/org.html#Main-Index" target="_blank" rel="noopener">Index</a>]</p>
<h3 id="14-7-Extracting-Source-Code"><a href="#14-7-Extracting-Source-Code" class="headerlink" title="14.7 Extracting Source Code"></a>14.7 Extracting Source Code</h3><p>Extracting source code from code blocks is a basic task in literate programming. Org has features to make this easy. In literate programming parlance, documents on creation are <em>woven</em> with code and documentation, and on export, the code is tangled for execution by a computer. Org facilitates weaving and tangling for producing, maintaining, sharing, and exporting literate programming documents. Org provides extensive customization options for extracting source code.</p>
<p>When Org tangles code blocks, it expands, merges, and transforms them. Then Org recomposes them into one or more separate files, as configured through the options. During this tangling process, Org expands variables in the source code, and resolves any Noweb style references (see <a href="https://orgmode.org/org.html#Noweb-Reference-Syntax" target="_blank" rel="noopener">Noweb Reference Syntax</a>).</p>
<h4 id="Header-arguments"><a href="#Header-arguments" class="headerlink" title="Header arguments"></a>Header arguments</h4><p>The ‘tangle’ header argument specifies if the code block is exported to source file(s).</p>
<ul>
<li><p>‘yes’</p>
<p>Export the code block to source file. The file name for the source file is derived from the name of the Org file, and the file extension is derived from the source code language identifier. Example: ‘:tangle yes’.</p>
</li>
<li><p>‘no’</p>
<p>The default. Do not extract the code in a source code file. Example: ‘:tangle no’.</p>
</li>
<li><p>FILENAME</p>
<p>Export the code block to source file whose file name is derived from any string passed to the ‘tangle’ header argument. Org derives the file name as being relative to the directory of the Org file’s location. Example: ‘:tangle FILENAME’.</p>
</li>
</ul>
<p>The ‘mkdirp’ header argument creates parent directories for tangled files if the directory does not exist. ‘yes’ enables directory creation and ‘no’ inhibits directory creation.</p>
<p>The ‘comments’ header argument controls inserting comments into tangled files. These are above and beyond whatever comments may already exist in the code block.</p>
<ul>
<li><p>‘no’</p>
<p>The default. Do not insert any extra comments during tangling.</p>
</li>
<li><p>‘link’</p>
<p>Wrap the code block in comments. Include links pointing back to the place in the Org file from where the code was tangled.</p>
</li>
<li><p>‘yes’</p>
<p>Kept for backward compatibility; same as ‘link’.</p>
</li>
<li><p>‘org’</p>
<p>Nearest headline text from Org file is inserted as comment. The exact text that is inserted is picked from the leading context of the source block.</p>
</li>
<li><p>‘both’</p>
<p>Includes both ‘link’ and ‘org’ options.</p>
</li>
<li><p>‘noweb’</p>
<p>Includes ‘link’ option, expands Noweb references (see <a href="https://orgmode.org/org.html#Noweb-Reference-Syntax" target="_blank" rel="noopener">Noweb Reference Syntax</a>), and wraps them in link comments inside the body of the code block.</p>
</li>
</ul>
<p>The ‘padline’ header argument controls insertion of newlines to pad source code in the tangled file.</p>
<ul>
<li><p>‘yes’</p>
<p>Default. Insert a newline before and after each code block in the tangled file.</p>
</li>
<li><p>‘no’</p>
<p>Do not insert newlines to pad the tangled code blocks.</p>
</li>
</ul>
<p>The ‘shebang’ header argument can turn results into executable script files. By setting it to a string value—for example, ‘:shebang “#!/bin/bash”’—Org inserts that string as the first line of the tangled file that the code block is extracted to. Org then turns on the tangled file’s executable permission.</p>
<p>The ‘tangle-mode’ header argument specifies what permissions to set for tangled files by <code>set-file-modes</code>. For example, to make a read-only tangled file, use ‘:tangle-mode (identity #o444)’. To make it executable, use ‘:tangle-mode (identity #o755)’. It also overrides executable permission granted by ‘shebang’. When multiple source code blocks tangle to a single file with different and conflicting ‘tangle-mode’ header arguments, Org’s behavior is undefined.</p>
<p>By default Org expands code blocks during tangling. The ‘no-expand’ header argument turns off such expansions. Note that one side-effect of expansion by <code>org-babel-expand-src-block</code> also assigns values (see <a href="https://orgmode.org/org.html#Environment-of-a-Code-Block" target="_blank" rel="noopener">Environment of a Code Block</a>) to variables. Expansions also replace Noweb references with their targets (see <a href="https://orgmode.org/org.html#Noweb-Reference-Syntax" target="_blank" rel="noopener">Noweb Reference Syntax</a>). Some of these expansions may cause premature assignment, hence this option. This option makes a difference only for tangling. It has no effect when exporting since code blocks for execution have to be expanded anyway.</p>
<h4 id="Functions"><a href="#Functions" class="headerlink" title="Functions"></a>Functions</h4><ul>
<li><p><code>org-babel-tangle</code></p>
<p>Tangle the current file. Bound to C-c C-v t.With prefix argument only tangle the current code block.</p>
</li>
<li><p><code>org-babel-tangle-file</code></p>
<p>Choose a file to tangle. Bound to C-c C-v f.</p>
</li>
</ul>
<h4 id="Hooks"><a href="#Hooks" class="headerlink" title="Hooks"></a>Hooks</h4><ul>
<li><p><code>org-babel-post-tangle-hook</code></p>
<p>This hook is run from within code files tangled by <code>org-babel-tangle</code>, making it suitable for post-processing, compilation, and evaluation of code in the tangled files.</p>
</li>
</ul>
<h4 id="Jumping-between-code-and-Org"><a href="#Jumping-between-code-and-Org" class="headerlink" title="Jumping between code and Org"></a>Jumping between code and Org</h4><p>Debuggers normally link errors and messages back to the source code. But for tangled files, we want to link back to the Org file, not to the tangled source file. To make this extra jump, Org uses <code>org-babel-tangle-jump-to-org</code> function with two additional source code block header arguments:</p>
<ol>
<li>Set ‘padline’ to true—this is the default setting.</li>
<li>Set ‘comments’ to ‘link’, which makes Org insert links to the Org file.</li>
</ol>
<hr>
<p>Next: <a href="https://orgmode.org/org.html#Editing-Source-Code" target="_blank" rel="noopener">Editing Source Code</a>, Previous: <a href="https://orgmode.org/org.html#Extracting-Source-Code" target="_blank" rel="noopener">Extracting Source Code</a>, Up: <a href="https://orgmode.org/org.html#Working-with-Source-Code" target="_blank" rel="noopener">Working with Source Code</a>   [<a href="https://orgmode.org/org.html#SEC_Contents" target="_blank" rel="noopener">Contents</a>][<a href="https://orgmode.org/org.html#Main-Index" target="_blank" rel="noopener">Index</a>]</p>
<h3 id="14-8-Languages"><a href="#14-8-Languages" class="headerlink" title="14.8 Languages"></a>14.8 Languages</h3><p>Code blocks in the following languages are supported.</p>
<table>
<thead>
<tr>
<th>Language</th>
<th>Identifier</th>
<th>Language</th>
<th>Identifier</th>
</tr>
</thead>
<tbody>
<tr>
<td>Asymptote</td>
<td>‘asymptote’</td>
<td>Lua</td>
<td>‘lua’</td>
</tr>
<tr>
<td>Awk</td>
<td>‘awk’</td>
<td>MATLAB</td>
<td>‘matlab’</td>
</tr>
<tr>
<td>C</td>
<td>‘C’</td>
<td>Mscgen</td>
<td>‘mscgen’</td>
</tr>
<tr>
<td>C++</td>
<td>‘C++’<a href="https://orgmode.org/org.html#FOOT144" target="_blank" rel="noopener">144</a></td>
<td>OCaml</td>
<td>‘ocaml’</td>
</tr>
<tr>
<td>Clojure</td>
<td>‘clojure’</td>
<td>Octave</td>
<td>‘octave’</td>
</tr>
<tr>
<td>CSS</td>
<td>‘css’</td>
<td>Org mode</td>
<td>‘org’</td>
</tr>
<tr>
<td>D</td>
<td>‘D’<a href="https://orgmode.org/org.html#FOOT145" target="_blank" rel="noopener">145</a></td>
<td>Oz</td>
<td>‘oz’</td>
</tr>
<tr>
<td>ditaa</td>
<td>‘ditaa’</td>
<td>Perl</td>
<td>‘perl’</td>
</tr>
<tr>
<td>Emacs Calc</td>
<td>‘calc’</td>
<td>Plantuml</td>
<td>‘plantuml’</td>
</tr>
<tr>
<td>Emacs Lisp</td>
<td>‘emacs-lisp’</td>
<td>Processing.js</td>
<td>‘processing’</td>
</tr>
<tr>
<td>Fortran</td>
<td>‘fortran’</td>
<td>Python</td>
<td>‘python’</td>
</tr>
<tr>
<td>Gnuplot</td>
<td>‘gnuplot’</td>
<td>R</td>
<td>‘R’</td>
</tr>
<tr>
<td>GNU Screen</td>
<td>‘screen’</td>
<td>Ruby</td>
<td>‘ruby’</td>
</tr>
<tr>
<td>Graphviz</td>
<td>‘dot’</td>
<td>Sass</td>
<td>‘sass’</td>
</tr>
<tr>
<td>Haskell</td>
<td>‘haskell’</td>
<td>Scheme</td>
<td>‘scheme’</td>
</tr>
<tr>
<td>Java</td>
<td>‘java’</td>
<td>Sed</td>
<td>‘sed’</td>
</tr>
<tr>
<td>Javascript</td>
<td>‘js’</td>
<td>shell</td>
<td>‘sh’</td>
</tr>
<tr>
<td>LaTeX</td>
<td>‘latex’</td>
<td>SQL</td>
<td>‘sql’</td>
</tr>
<tr>
<td>Ledger</td>
<td>‘ledger’</td>
<td>SQLite</td>
<td>‘sqlite’</td>
</tr>
<tr>
<td>Lilypond</td>
<td>‘lilypond’</td>
<td>Vala</td>
<td>‘vala’</td>
</tr>
<tr>
<td>Lisp</td>
<td>‘lisp’</td>
<td></td>
</tr>
</tbody>
</table>
<p>Additional documentation for some languages is at <a href="https://orgmode.org/worg/org-contrib/babel/languages.html" target="_blank" rel="noopener">https://orgmode.org/worg/org-contrib/babel/languages.html</a>.</p>
<p>By default, only Emacs Lisp is enabled for evaluation. To enable or disable other languages, customize the <code>org-babel-load-languages</code> variable either through the Emacs customization interface, or by adding code to the init file as shown next.</p>
<p>In this example, evaluation is disabled for Emacs Lisp, and enabled for R.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">(org-babel-do-load-languages</span><br><span class="line"> &apos;org-babel-load-languages</span><br><span class="line"> &apos;((emacs-lisp . nil)</span><br><span class="line">   (R . t)))</span><br></pre></td></tr></table></figure>
<p>Note that this is not the only way to enable a language. Org also enables languages when loaded with <code>require</code> statement. For example, the following enables execution of Clojure code blocks:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(require &apos;ob-clojure)</span><br></pre></td></tr></table></figure>
<hr>
<p>Next: <a href="https://orgmode.org/org.html#Noweb-Reference-Syntax" target="_blank" rel="noopener">Noweb Reference Syntax</a>, Previous: <a href="https://orgmode.org/org.html#Languages" target="_blank" rel="noopener">Languages</a>, Up: <a href="https://orgmode.org/org.html#Working-with-Source-Code" target="_blank" rel="noopener">Working with Source Code</a>   [<a href="https://orgmode.org/org.html#SEC_Contents" target="_blank" rel="noopener">Contents</a>][<a href="https://orgmode.org/org.html#Main-Index" target="_blank" rel="noopener">Index</a>]</p>
<h3 id="14-9-Editing-Source-Code"><a href="#14-9-Editing-Source-Code" class="headerlink" title="14.9 Editing Source Code"></a>14.9 Editing Source Code</h3><p>Use C-c ‘ to edit the current code block. It opens a new major-mode edit buffer containing the body of the source code block, ready for any edits. Use C-c ‘ again to close the buffer and return to the Org buffer.</p>
<p>C-x C-s saves the buffer and updates the contents of the Org buffer. Set <code>org-edit-src-auto-save-idle-delay</code> to save the base buffer after a certain idle delay time. Set <code>org-edit-src-turn-on-auto-save</code> to auto-save this buffer into a separate file using Auto-save mode.</p>
<p>While editing the source code in the major mode, the Org Src minor mode remains active. It provides these customization variables as described below. For even more variables, look in the customization group <code>org-edit-structure</code>.</p>
<ul>
<li><p><code>org-src-lang-modes</code></p>
<p>If an Emacs major-mode named <code>&lt;LANG&gt;-mode</code> exists, where <lang> is the language identifier from code block’s header line, then the edit buffer uses that major mode. Use this variable to arbitrarily map language identifiers to major modes.</lang></p>
</li>
<li><p><code>org-src-window-setup</code></p>
<p>For specifying Emacs window arrangement when the new edit buffer is created.</p>
</li>
<li><p><code>org-src-preserve-indentation</code></p>
<p>Default is <code>nil</code>. Source code is indented. This indentation applies during export or tangling, and depending on the context, may alter leading spaces and tabs. When non-<code>nil</code>, source code is aligned with the leftmost column. No lines are modified during export or tangling, which is very useful for white-space sensitive languages, such as Python.</p>
</li>
<li><p><code>org-src-ask-before-returning-to-edit-buffer</code></p>
<p>When <code>nil</code>, Org returns to the edit buffer without further prompts. The default prompts for a confirmation.</p>
</li>
</ul>
<p>Set <code>org-src-fontify-natively</code> to non-<code>nil</code> to turn on native code fontification in the <em>Org</em> buffer. Fontification of code blocks can give visual separation of text and code on the display page. To further customize the appearance of <code>org-block</code> for specific languages, customize <code>org-src-block-faces</code>. The following example shades the background of regular blocks, and colors source blocks only for Python and Emacs Lisp languages.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">(require &apos;color)</span><br><span class="line">(set-face-attribute &apos;org-block nil :background</span><br><span class="line">                    (color-darken-name</span><br><span class="line">                     (face-attribute &apos;default :background) 3))</span><br><span class="line"></span><br><span class="line">(setq org-src-block-faces &apos;((&quot;emacs-lisp&quot; (:background &quot;#EEE2FF&quot;))</span><br><span class="line">                            (&quot;python&quot; (:background &quot;#E5FFB8&quot;))))</span><br></pre></td></tr></table></figure>
<hr>
<p>Next: <a href="https://orgmode.org/org.html#Library-of-Babel" target="_blank" rel="noopener">Library of Babel</a>, Previous: <a href="https://orgmode.org/org.html#Editing-Source-Code" target="_blank" rel="noopener">Editing Source Code</a>, Up: <a href="https://orgmode.org/org.html#Working-with-Source-Code" target="_blank" rel="noopener">Working with Source Code</a>   [<a href="https://orgmode.org/org.html#SEC_Contents" target="_blank" rel="noopener">Contents</a>][<a href="https://orgmode.org/org.html#Main-Index" target="_blank" rel="noopener">Index</a>]</p>
<h3 id="14-10-Noweb-Reference-Syntax"><a href="#14-10-Noweb-Reference-Syntax" class="headerlink" title="14.10 Noweb Reference Syntax"></a>14.10 Noweb Reference Syntax</h3><p>Org supports named blocks in Noweb<a href="https://orgmode.org/org.html#FOOT146" target="_blank" rel="noopener">146</a> style syntax:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;&lt;CODE-BLOCK-ID&gt;&gt;</span><br></pre></td></tr></table></figure>
<p>Org can replace the construct with the source code, or the results of evaluation, of the code block identified as CODE-BLOCK-ID.</p>
<p>The ‘noweb’ header argument controls expansion of Noweb syntax references. Expansions occur when source code blocks are evaluated, tangled, or exported.</p>
<ul>
<li><p>‘no’</p>
<p>Default. No expansion of Noweb syntax references in the body of the code when evaluating, tangling, or exporting.</p>
</li>
<li><p>‘yes’</p>
<p>Expansion of Noweb syntax references in the body of the code block when evaluating, tangling, or exporting.</p>
</li>
<li><p>‘tangle’</p>
<p>Expansion of Noweb syntax references in the body of the code block when tangling. No expansion when evaluating or exporting.</p>
</li>
<li><p>‘no-export’</p>
<p>Expansion of Noweb syntax references in the body of the code block when evaluating or tangling. No expansion when exporting.</p>
</li>
<li><p>‘strip-export’</p>
<p>Expansion of Noweb syntax references in the body of the code block when expanding prior to evaluating or tangling. Removes Noweb syntax references when exporting.</p>
</li>
<li><p>‘eval’</p>
<p>Expansion of Noweb syntax references in the body of the code block only before evaluating.</p>
</li>
</ul>
<p>In the following example,</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">#+NAME: initialization</span><br><span class="line">#+BEGIN_SRC emacs-lisp</span><br><span class="line">  (setq sentence &quot;Never a foot too far, even.&quot;)</span><br><span class="line">#+END_SRC</span><br><span class="line"></span><br><span class="line">#+BEGIN_SRC emacs-lisp :noweb yes</span><br><span class="line">  &lt;&lt;initialization&gt;&gt;</span><br><span class="line">  (reverse sentence)</span><br><span class="line">#+END_SRC</span><br></pre></td></tr></table></figure>
<p>the second code block is expanded as</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">#+BEGIN_SRC emacs-lisp :noweb yes</span><br><span class="line">  (setq sentence &quot;Never a foot too far, even.&quot;)</span><br><span class="line">  (reverse sentence)</span><br><span class="line">#+END_SRC</span><br></pre></td></tr></table></figure>
<p>Noweb insertions honor prefix characters that appear before the Noweb syntax reference. This behavior is illustrated in the following example. Because the ‘&lt;<example>&gt;’ Noweb reference appears behind the SQL comment syntax, each line of the expanded Noweb reference is commented. With:</example></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">#+NAME: example</span><br><span class="line">#+BEGIN_SRC text</span><br><span class="line">  this is the</span><br><span class="line">  multi-line body of example</span><br><span class="line">#+END_SRC</span><br></pre></td></tr></table></figure>
<p>this code block:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">#+BEGIN_SRC sql :noweb yes</span><br><span class="line"> ---&lt;&lt;example&gt;&gt;</span><br><span class="line">#+END_SRC</span><br></pre></td></tr></table></figure>
<p>expands to:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">#+BEGIN_SRC sql :noweb yes</span><br><span class="line"> ---this is the</span><br><span class="line"> ---multi-line body of example</span><br><span class="line">#+END_SRC</span><br></pre></td></tr></table></figure>
<p>Since this change does not affect Noweb replacement text without newlines in them, inline Noweb references are acceptable.</p>
<p>This feature can also be used for management of indentation in exported code snippets. With:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">#+NAME: if-true</span><br><span class="line">#+BEGIN_SRC python :exports none</span><br><span class="line">  print(&apos;do things when true&apos;)</span><br><span class="line">#+end_src</span><br><span class="line"></span><br><span class="line">#+name: if-false</span><br><span class="line">#+begin_src python :exports none</span><br><span class="line">  print(&apos;do things when false&apos;)</span><br><span class="line">#+end_src</span><br></pre></td></tr></table></figure>
<p>this code block:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">#+begin_src python :noweb yes :results output</span><br><span class="line">  if true:</span><br><span class="line">      &lt;&lt;if-true&gt;&gt;</span><br><span class="line">  else:</span><br><span class="line">      &lt;&lt;if-false&gt;&gt;</span><br><span class="line">#+end_src</span><br></pre></td></tr></table></figure>
<p>expands to:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">if true:</span><br><span class="line">    print(&apos;do things when true&apos;)</span><br><span class="line">else:</span><br><span class="line">    print(&apos;do things when false&apos;)</span><br></pre></td></tr></table></figure>
<p>When expanding Noweb style references, Org concatenates code blocks by matching the reference name to either the code block name or, if none is found, to the ‘noweb-ref’ header argument.</p>
<p>For simple concatenation, set this ‘noweb-ref’ header argument at the sub-tree or file level. In the example Org file shown next, the body of the source code in each block is extracted for concatenation to a pure code file when tangled.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">#+BEGIN_SRC sh :tangle yes :noweb yes :shebang #!/bin/sh</span><br><span class="line">  &lt;&lt;fullest-disk&gt;&gt;</span><br><span class="line">#+END_SRC</span><br><span class="line">* the mount point of the fullest disk</span><br><span class="line">  :PROPERTIES:</span><br><span class="line">  :header-args: :noweb-ref fullest-disk</span><br><span class="line">  :END:</span><br><span class="line"></span><br><span class="line">** query all mounted disks</span><br><span class="line">#+BEGIN_SRC sh</span><br><span class="line">  df \</span><br><span class="line">#+END_SRC</span><br><span class="line"></span><br><span class="line">** strip the header row</span><br><span class="line">#+BEGIN_SRC sh</span><br><span class="line">  |sed &apos;1d&apos; \</span><br><span class="line">#+END_SRC</span><br><span class="line"></span><br><span class="line">** output mount point of fullest disk</span><br><span class="line">#+BEGIN_SRC sh</span><br><span class="line">  |awk &apos;&#123;if (u &lt; +$5) &#123;u = +$5; m = $6&#125;&#125; END &#123;print m&#125;&apos;</span><br><span class="line">#+END_SRC</span><br></pre></td></tr></table></figure>
<p>By default a newline separates each noweb reference concatenation. To change this newline separator, edit the ‘noweb-sep’ header argument.</p>
<p>Eventually, Org can include the results of a code block rather than its body. To that effect, append parentheses, possibly including arguments, to the code block name, as shown below.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;&lt;code-block-name(optional arguments)&gt;&gt;</span><br></pre></td></tr></table></figure>
<p>Note that when using the above approach to a code block’s results, the code block name set by ‘NAME’ keyword is required; the reference set by ‘noweb-ref’ does not work in that case.</p>
<p>Here is an example that demonstrates how the exported content changes when Noweb style references are used with parentheses versus without. With:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">#+NAME: some-code</span><br><span class="line">#+BEGIN_SRC python :var num=0 :results output :exports none</span><br><span class="line">  print(num*10)</span><br><span class="line">#+END_SRC</span><br></pre></td></tr></table></figure>
<p>this code block:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">#+BEGIN_SRC text :noweb yes</span><br><span class="line">  &lt;&lt;some-code&gt;&gt;</span><br><span class="line">#+END_SRC</span><br></pre></td></tr></table></figure>
<p>expands to:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">print(num*10)</span><br></pre></td></tr></table></figure>
<p>Below, a similar Noweb style reference is used, but with parentheses, while setting a variable ‘num’ to 10:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">#+BEGIN_SRC text :noweb yes</span><br><span class="line">  &lt;&lt;some-code(num=10)&gt;&gt;</span><br><span class="line">#+END_SRC</span><br></pre></td></tr></table></figure>
<p>Note that now the expansion contains the results of the code block ‘some-code’, not the code block itself:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">100</span><br></pre></td></tr></table></figure>
<hr>
<p>Next: <a href="https://orgmode.org/org.html#Key-bindings-and-Useful-Functions" target="_blank" rel="noopener">Key bindings and Useful Functions</a>, Previous: <a href="https://orgmode.org/org.html#Noweb-Reference-Syntax" target="_blank" rel="noopener">Noweb Reference Syntax</a>, Up: <a href="https://orgmode.org/org.html#Working-with-Source-Code" target="_blank" rel="noopener">Working with Source Code</a>   [<a href="https://orgmode.org/org.html#SEC_Contents" target="_blank" rel="noopener">Contents</a>][<a href="https://orgmode.org/org.html#Main-Index" target="_blank" rel="noopener">Index</a>]</p>
<h3 id="14-11-Library-of-Babel"><a href="#14-11-Library-of-Babel" class="headerlink" title="14.11 Library of Babel"></a>14.11 Library of Babel</h3><p>The “Library of Babel” is a collection of code blocks. Like a function library, these code blocks can be called from other Org files. A collection of useful code blocks is available on <a href="https://orgmode.org/worg/library-of-babel.html" target="_blank" rel="noopener">Worg</a>. For remote code block evaluation syntax, see <a href="https://orgmode.org/org.html#Evaluating-Code-Blocks" target="_blank" rel="noopener">Evaluating Code Blocks</a>.</p>
<p>For any user to add code to the library, first save the code in regular code blocks of an Org file, and then load the Org file with <code>org-babel-lob-ingest</code>, which is bound to C-c C-v i.</p>
<hr>
<p>Next: <a href="https://orgmode.org/org.html#Batch-Execution" target="_blank" rel="noopener">Batch Execution</a>, Previous: <a href="https://orgmode.org/org.html#Library-of-Babel" target="_blank" rel="noopener">Library of Babel</a>, Up: <a href="https://orgmode.org/org.html#Working-with-Source-Code" target="_blank" rel="noopener">Working with Source Code</a>   [<a href="https://orgmode.org/org.html#SEC_Contents" target="_blank" rel="noopener">Contents</a>][<a href="https://orgmode.org/org.html#Main-Index" target="_blank" rel="noopener">Index</a>]</p>
<h3 id="14-12-Key-bindings-and-Useful-Functions"><a href="#14-12-Key-bindings-and-Useful-Functions" class="headerlink" title="14.12 Key bindings and Useful Functions"></a>14.12 Key bindings and Useful Functions</h3><p>Many common Org mode key sequences are re-bound depending on the context.</p>
<p>Active key bindings in code blocks:</p>
<table>
<thead>
<tr>
<th>Key binding</th>
<th>Function</th>
</tr>
</thead>
<tbody>
<tr>
<td>C-c C-c</td>
<td><code>org-babel-execute-src-block</code></td>
</tr>
<tr>
<td>C-c C-o</td>
<td><code>org-babel-open-src-block-result</code></td>
</tr>
<tr>
<td>M-UP</td>
<td><code>org-babel-load-in-session</code></td>
</tr>
<tr>
<td>M-DOWN</td>
<td><code>org-babel-pop-to-session</code></td>
</tr>
</tbody>
</table>
<p>Active key bindings in Org mode buffer:</p>
<table>
<thead>
<tr>
<th>Key binding</th>
<th>Function</th>
</tr>
</thead>
<tbody>
<tr>
<td>C-c C-v p or C-c C-v C-p</td>
<td><code>org-babel-previous-src-block</code></td>
</tr>
<tr>
<td>C-c C-v n or C-c C-v C-n</td>
<td><code>org-babel-next-src-block</code></td>
</tr>
<tr>
<td>C-c C-v e or C-c C-v C-e</td>
<td><code>org-babel-execute-maybe</code></td>
</tr>
<tr>
<td>C-c C-v o or C-c C-v C-o</td>
<td><code>org-babel-open-src-block-result</code></td>
</tr>
<tr>
<td>C-c C-v v or C-c C-v C-v</td>
<td><code>org-babel-expand-src-block</code></td>
</tr>
<tr>
<td>C-c C-v u or C-c C-v C-u</td>
<td><code>org-babel-goto-src-block-head</code></td>
</tr>
<tr>
<td>C-c C-v g or C-c C-v C-g</td>
<td><code>org-babel-goto-named-src-block</code></td>
</tr>
<tr>
<td>C-c C-v r or C-c C-v C-r</td>
<td><code>org-babel-goto-named-result</code></td>
</tr>
<tr>
<td>C-c C-v b or C-c C-v C-b</td>
<td><code>org-babel-execute-buffer</code></td>
</tr>
<tr>
<td>C-c C-v s or C-c C-v C-s</td>
<td><code>org-babel-execute-subtree</code></td>
</tr>
<tr>
<td>C-c C-v d or C-c C-v C-d</td>
<td><code>org-babel-demarcate-block</code></td>
</tr>
<tr>
<td>C-c C-v t or C-c C-v C-t</td>
<td><code>org-babel-tangle</code></td>
</tr>
<tr>
<td>C-c C-v f or C-c C-v C-f</td>
<td><code>org-babel-tangle-file</code></td>
</tr>
<tr>
<td>C-c C-v c or C-c C-v C-c</td>
<td><code>org-babel-check-src-block</code></td>
</tr>
<tr>
<td>C-c C-v j or C-c C-v C-j</td>
<td><code>org-babel-insert-header-arg</code></td>
</tr>
<tr>
<td>C-c C-v l or C-c C-v C-l</td>
<td><code>org-babel-load-in-session</code></td>
</tr>
<tr>
<td>C-c C-v i or C-c C-v C-i</td>
<td><code>org-babel-lob-ingest</code></td>
</tr>
<tr>
<td>C-c C-v I or C-c C-v C-I</td>
<td><code>org-babel-view-src-block-info</code></td>
</tr>
<tr>
<td>C-c C-v z or C-c C-v C-z</td>
<td><code>org-babel-switch-to-session-with-code</code></td>
</tr>
<tr>
<td>C-c C-v a or C-c C-v C-a</td>
<td><code>org-babel-sha1-hash</code></td>
</tr>
<tr>
<td>C-c C-v h or C-c C-v C-h</td>
<td><code>org-babel-describe-bindings</code></td>
</tr>
<tr>
<td>C-c C-v x or C-c C-v C-x</td>
<td><code>org-babel-do-key-sequence-in-edit-buffer</code></td>
</tr>
</tbody>
</table>
<hr>
<p>Previous: <a href="https://orgmode.org/org.html#Key-bindings-and-Useful-Functions" target="_blank" rel="noopener">Key bindings and Useful Functions</a>, Up: <a href="https://orgmode.org/org.html#Working-with-Source-Code" target="_blank" rel="noopener">Working with Source Code</a>   [<a href="https://orgmode.org/org.html#SEC_Contents" target="_blank" rel="noopener">Contents</a>][<a href="https://orgmode.org/org.html#Main-Index" target="_blank" rel="noopener">Index</a>]</p>
<h3 id="14-13-Batch-Execution"><a href="#14-13-Batch-Execution" class="headerlink" title="14.13 Batch Execution"></a>14.13 Batch Execution</h3><p>Org mode features, including working with source code facilities can be invoked from the command line. This enables building shell scripts for batch processing, running automated system tasks, and expanding Org mode’s usefulness.</p>
<p>The sample script shows batch processing of multiple files using <code>org-babel-tangle</code>.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">#!/bin/sh</span><br><span class="line"># Tangle files with Org mode</span><br><span class="line">#</span><br><span class="line">emacs -Q --batch --eval &quot;</span><br><span class="line">    (progn</span><br><span class="line">      (require &apos;ob-tangle)</span><br><span class="line">      (dolist (file command-line-args-left)</span><br><span class="line">        (with-current-buffer (find-file-noselect file)</span><br><span class="line">          (org-babel-tangle))))</span><br><span class="line">  &quot; &quot;$@&quot;</span><br></pre></td></tr></table></figure>
<hr>
<p>Next: <a href="https://orgmode.org/org.html#Hacking" target="_blank" rel="noopener">Hacking</a>, Previous: <a href="https://orgmode.org/org.html#Working-with-Source-Code" target="_blank" rel="noopener">Working with Source Code</a>, Up: <a href="https://orgmode.org/org.html#Top" target="_blank" rel="noopener">Top</a>   [<a href="https://orgmode.org/org.html#SEC_Contents" target="_blank" rel="noopener">Contents</a>][<a href="https://orgmode.org/org.html#Main-Index" target="_blank" rel="noopener">Index</a>]</p>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://alphaalgorithms.github.io/2019/06/13/emacs-ipython-notebook/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Gabriel">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="DummyHead">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                
                <a href="/2019/06/13/emacs-ipython-notebook/" class="post-title-link" itemprop="url">Emacs Ipython Notebook</a>
              
            
          </h2>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2019-06-13 08:43:39 / Modified: 08:45:24" itemprop="dateCreated datePublished" datetime="2019-06-13T08:43:39+08:00">2019-06-13</time>
            

            
              

              
            
          </span>

          

          
            
            
              
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
            
                <span class="post-meta-item-text">Comments: </span>
                <a href="/2019/06/13/emacs-ipython-notebook/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2019/06/13/emacs-ipython-notebook/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>The <a href="https://github.com/millejoh/emacs-ipython-notebook" target="_blank" rel="noopener">Emacs IPython Notebook (EIN)</a> package provides a <a href="https://jupyter-notebook.readthedocs.io/en/stable/" target="_blank" rel="noopener">Jupyter Notebook</a> client and integrated REPL (like <a href="http://common-lisp.net/project/slime/" target="_blank" rel="noopener">SLIME</a>) in Emacs. EIN improves notebook editing by allowing you to use Emacs. It also expose IPython features such as code evaluation, object inspection and code completion. These features can be accessed anywhere in Emacs and improve Python code editing and reading in general in Emacs.</p>
<p>Highlighted features:</p>
<ul>
<li>Copy/paste cells in and between notebooks.</li>
<li>Console integration: You can easily connect to a kernel via a console application. This enables you to start debugging in the same kernel. It is even possible to connect a console over ssh <a href="https://millejoh.github.io/emacs-ipython-notebook/#id3" target="_blank" rel="noopener">1</a>.</li>
<li>An IPython kernel can be “connected” to a buffer. This enables you to evaluate buffer/region using same kernel as notebook. Notebook goodies such as tooltip help, help browser and code completion are available in these buffers. <a href="https://millejoh.github.io/emacs-ipython-notebook/#id4" target="_blank" rel="noopener">2</a></li>
<li>Jump to definition (go to the definition by executing <code>M-.</code> over an object).</li>
<li>Execute code from an org-mode source block in a running kernel.</li>
</ul>
<p>Other notebook features:</p>
<ul>
<li>Inline images</li>
<li>Auto/manual-completion </li>
<li>Popup (tooltip) help</li>
<li>Syntax highlighting in each cell type (Python/Markdown/ReST/HTML)</li>
<li>Help browser (opens when executing <code>function?</code>)</li>
<li>Traceback viewer</li>
<li>Integration with the emacs debugger</li>
</ul>
<p>Links:</p>
<ul>
<li><a href="http://millejoh.github.io/emacs-ipython-notebook/" target="_blank" rel="noopener">Online Documentation</a></li>
<li><a href="https://github.com/millejoh/emacs-ipython-notebook/wiki" target="_blank" rel="noopener">Wiki</a></li>
<li><a href="https://github.com/millejoh/emacs-ipython-notebook/wiki/Screenshots" target="_blank" rel="noopener">Screenshots</a></li>
<li><a href="https://github.com/millejoh/emacs-ipython-notebook/wiki/Tips" target="_blank" rel="noopener">Tips</a></li>
<li><a href="https://github.com/millejoh/emacs-ipython-notebook/tags" target="_blank" rel="noopener">Downloads</a></li>
<li><a href="https://github.com/millejoh/emacs-ipython-notebook" target="_blank" rel="noopener">Repository at GitHub</a></li>
<li><p><a href="https://github.com/millejoh/emacs-ipython-notebook/issues" target="_blank" rel="noopener">Issue Tracker at GitHub</a></p>
</li>
<li><p><a href="https://millejoh.github.io/emacs-ipython-notebook/#id1" target="_blank" rel="noopener">1</a> You need to setup <a href="https://millejoh.github.io/emacs-ipython-notebook/#ein:console-args" target="_blank" rel="noopener"><code>ein:console-args</code></a> properly</p>
</li>
<li><a href="https://millejoh.github.io/emacs-ipython-notebook/#id2" target="_blank" rel="noopener">2</a> Use the command <a href="https://millejoh.github.io/emacs-ipython-notebook/#ein:connect-to-notebook-command" target="_blank" rel="noopener"><code>ein:connect-to-notebook-command</code></a>.</li>
</ul>
<h2 id="Quick-try"><a href="#Quick-try" class="headerlink" title="Quick try"></a>Quick try</h2><p>The fastest way to get EIN running in this modern age is to download from <a href="https://github.com/milkypostman/melpa" target="_blank" rel="noopener">MELPA</a> or, if you are a <a href="http://spacemacs.org/" target="_blank" rel="noopener">spacemacs</a> user, through installing the <a href="http://spacemacs.org/layers/+lang/ipython-notebook/README.html" target="_blank" rel="noopener">ipython-notebook</a> layer. Using <a href="http://tkf.github.io/emacs-ipython-notebook/#quick-try" target="_blank" rel="noopener">zeroein</a> is no longer supported, though in theory it should still work.</p>
<p>If you are installing from <a href="https://github.com/milkypostman/melpa" target="_blank" rel="noopener">MELPA</a> and have issues with some functions not being available after emacs starts, try adding the following to your emacs init file:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">(package-initialize)</span><br><span class="line">(require &apos;ein)</span><br><span class="line">(require &apos;ein-notebook)</span><br><span class="line">(require &apos;ein-subpackages)</span><br></pre></td></tr></table></figure>
<h2 id="Requirements"><a href="#Requirements" class="headerlink" title="Requirements"></a>Requirements</h2><ul>
<li><p>EMACS 25.3, 26.x, or 27</p>
</li>
<li><p><a href="https://jupyter-notebook.readthedocs.io/en/stable/" target="_blank" rel="noopener">Jupyter Notebook</a> 4.x or higher</p>
</li>
<li><p><a href="http://ipython.readthedocs.io/en/stable/" target="_blank" rel="noopener">IPython</a> 5.8 or higher.</p>
</li>
<li><p><a href="http://www.tornadoweb.org/en/stable/" target="_blank" rel="noopener">Tornado</a> 4.0.2 or higher.</p>
</li>
<li><p><a href="https://github.com/ahyatt/emacs-websocket" target="_blank" rel="noopener">websocket.el</a> &gt;= 1.7</p>
</li>
<li><p><a href="https://github.com/tkf/emacs-request" target="_blank" rel="noopener">request.el</a> &gt;= 0.3</p>
</li>
<li><p><a href="https://github.com/tkf/emacs-request/blob/master/request-deferred.el" target="_blank" rel="noopener">request-deferred.el</a> &gt;= 0.2</p>
</li>
<li><p><a href="https://github.com/magnars/dash.el" target="_blank" rel="noopener">dash</a> &gt;= 2.13</p>
</li>
<li><p><a href="https://github.com/magnars/s.el" target="_blank" rel="noopener">s</a> &gt;= 1.11</p>
</li>
<li><p><a href="http://cx4a.org/software/auto-complete/" target="_blank" rel="noopener">auto-complete.el</a> &gt;= 1.4: You need to configure subpackage <code>ein-ac</code> to enable this feature.</p>
</li>
<li><p><a href="https://github.com/skeeto/skewer-mode" target="_blank" rel="noopener">skewer-mode</a> &gt;= 1.6.2: Skewer mode gives EIN the ability to execute dynamic javascript in the note book.</p>
</li>
<li><p>(optional) <a href="https://millejoh.github.io/emacs-ipython-notebook/#id28" target="_blank" rel="noopener">Jupyterhub_</a> 0.8 or higher: EIN supports logging in to Jupyterhub servers using PAM authentication, though this only works with v0.8, which currently is the development version of Jupyterhub.</p>
</li>
<li><p>(optional) markdown-mode</p>
</li>
<li><p>(optional) python-mode: It should work with either python.el or python-mode.el. <a href="https://github.com/fgallina/python.el" target="_blank" rel="noopener">python.el</a> is required to use the <code>ein:console-open</code> command.</p>
</li>
<li><p>(optional) <a href="https://github.com/myuhe/smartrep.el" target="_blank" rel="noopener">smartrep.el</a>: This package enables you to omit typing prefix keys (e.g., <code>C-c C-n C-n C-n ...</code> instead of <code>C-cC-n C-c C-n C-c C-n ...</code>). You need to configure subpackage <code>ein-smartrep</code> to enable this feature.</p>
</li>
<li><p>(optional) <a href="https://github.com/tkf/emacs-jedi" target="_blank" rel="noopener">jedi.el</a>: Python auto-completion for emacs using <a href="https://github.com/davidhalter/jedi" target="_blank" rel="noopener">jedi</a>. In your emacs initialization file add</p>
<p><code>(setq ein:completion-backend &#39;ein:use-ac-jedi-backend)</code></p>
</li>
</ul>
<p>Also, EIN heavily relies on standard Emacs libraries including EWOC, EIEIO and json.el.</p>
<ul>
<li><p><a href="https://millejoh.github.io/emacs-ipython-notebook/#id6" target="_blank" rel="noopener">3</a></p>
<p>See <a href="https://millejoh.github.io/emacs-ipython-notebook/#gotchas-python-mode-el" target="_blank" rel="noopener">Gotchas and caveats &gt; python-mode.el</a>.</p>
</li>
</ul>
<h2 id="Install"><a href="#Install" class="headerlink" title="Install"></a>Install</h2><p>Warning</p>
<p>As EIN relies on many packages and it will not work properly with outdated versions, installing it using el-get or MELPA is highly recommended.</p>
<h3 id="Using-el-get"><a href="#Using-el-get" class="headerlink" title="Using el-get"></a>Using el-get</h3><p>If you use developmental version of <a href="https://github.com/dimitri/el-get" target="_blank" rel="noopener">el-get</a> installation is simple. Emacs IPython Notebook is registered as package <code>ein</code>. See the <a href="https://github.com/dimitri/el-get" target="_blank" rel="noopener">el-get</a> website for more information.</p>
<p>Note</p>
<p>If you get error “Cannot open load file: request” that means you have an older version of el-get. You can fix this problem by either (1) installing request.el manually, (2) using the latest recipe, or (3) updating el-get to its master.</p>
<p>You can get the latest recipe here:</p>
<ul>
<li><a href="https://github.com/dimitri/el-get/blob/master/recipes/ein.rcp" target="_blank" rel="noopener">https://github.com/dimitri/el-get/blob/master/recipes/ein.rcp</a></li>
<li><a href="https://github.com/dimitri/el-get/blob/master/recipes/request.rcp" target="_blank" rel="noopener">https://github.com/dimitri/el-get/blob/master/recipes/request.rcp</a></li>
</ul>
<p>See <a href="https://github.com/tkf/emacs-ipython-notebook/issues/98" target="_blank" rel="noopener">issue 98</a> for more information.</p>
<h3 id="Using-package-el-MELPA"><a href="#Using-package-el-MELPA" class="headerlink" title="Using package.el (MELPA)"></a>Using package.el (MELPA)</h3><p>You can install EIN using <a href="http://emacswiki.org/emacs/ELPA" target="_blank" rel="noopener">package.el</a> when the <a href="https://github.com/milkypostman/melpa" target="_blank" rel="noopener">MELPA</a> package repository is added to its setting. See <a href="https://github.com/milkypostman/melpa" target="_blank" rel="noopener">MELPA</a> website for more information.</p>
<h3 id="Manual-install"><a href="#Manual-install" class="headerlink" title="Manual install"></a>Manual install</h3><p>Put Emacs lisp <code>ein*.el</code> files and the Python file <code>ein_remote_safe.py</code> in a directory defined in your <code>load-path</code>.</p>
<p>You should byte compile EIN, especially when using MuMaMo, otherwise editing large notebook will be very slow. You can use the following command to compile EIN. If you don’t specify all the optional packages, there will be compiler warning but that is OK as long as you don’t use that optional package.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">emacs -Q -batch -L .          \  # don&apos;t forget the dot!</span><br><span class="line">    -L PATH/TO/websocket/     \</span><br><span class="line">    -L PATH/TO/requests/      \</span><br><span class="line">    -L PATH/TO/nxhtml/util/   \  # optional (for MuMaMo)</span><br><span class="line">    -L PATH/TO/auto-complete/ \  # optional</span><br><span class="line">    -L PATH/TO/popup/         \  # optional (for auto-complete)</span><br><span class="line">    -L PATH/TO/fuzzy/         \  # optional (for auto-complete)</span><br><span class="line">    -L PATH/TO/smartrep/      \  # optional</span><br><span class="line">    -L PATH/TO/rst-mode/      \  # optional</span><br><span class="line">    -f batch-byte-compile *.el</span><br></pre></td></tr></table></figure>
<h3 id="Setup"><a href="#Setup" class="headerlink" title="Setup"></a>Setup</h3><p>Here is the minimal configuration. See <a href="https://millejoh.github.io/emacs-ipython-notebook/#id30" target="_blank" rel="noopener">customization_</a> for more details.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">(require &apos;ein)</span><br><span class="line">(require &apos;ein-notebook)</span><br><span class="line">(require &apos;ein-subpackages)</span><br></pre></td></tr></table></figure>
<h2 id="Usage"><a href="#Usage" class="headerlink" title="Usage"></a>Usage</h2><ol>
<li>Start the <a href="https://jupyter.readthedocs.io/en/latest/running.html" target="_blank" rel="noopener">Jupyter notebook server</a> from the terminal or call <code>M-x ein:run</code> or <code>M-x ein:jupyter-server-start</code> from emacs. Note starting the notebook server from emacs will automatically call <code>ein:jupyter-server-login-and-open</code>, making steps 2 and 3 below unnecessary!</li>
<li>If you have token or password authentication enabled then you will need to call <code>M-x ein:login</code> and enter the appropriate password. Assuming authentication works the <a href="https://millejoh.github.io/emacs-ipython-notebook/#notebook-list-commands" target="_blank" rel="noopener">notebooklist</a> buffer will automatically open.</li>
<li>In the notebook list buffer, you can open notebooks by selecting the <code>[Open]</code> buttons. See the <a href="https://millejoh.github.io/emacs-ipython-notebook/#notebook-commands" target="_blank" rel="noopener">notebook</a> section for operations and commands available in the notebook buffer.</li>
</ol>
<h2 id="Commands-Keybinds"><a href="#Commands-Keybinds" class="headerlink" title="Commands/Keybinds"></a>Commands/Keybinds</h2><h3 id="Running-a-Jupyter-Notebook-Server-from-Emacs"><a href="#Running-a-Jupyter-Notebook-Server-from-Emacs" class="headerlink" title="Running a Jupyter Notebook Server from Emacs"></a>Running a Jupyter Notebook Server from Emacs</h3><p>Using the commands below you start a jupyter notebook session from within emacs (i.e. no need to drop to the terminal shell and call <code>jupyter notebook</code>). EIN will also try to determine the access url and token authentication for the running server and automatically log you in.</p>
<p>Note that the below work best with current (&gt; v4.3.1) versions of jupyter.</p>
<ul>
<li><p><em>function</em> (<code>ein:jupyter-server-start</code><em>server-cmd-path</em> <em>notebook-directory</em> <em>&amp;optional</em> <em>no-login-p</em> <em>login-callback**port</em>)</p>
<p>Start SERVER-CMD_PATH with ‘–notebook-dir’ NOTEBOOK-DIRECTORY. Login after connection established unless NO-LOGIN-P is set. LOGIN-CALLBACK takes two arguments, the buffer created by ein:notebooklist-open–finish, and the url-or-port argument of ein:notebooklist-open<em>.This command opens an asynchronous process running the jupyter notebook server and then tries to detect the url and password to generate automatic calls to ‘ein:notebooklist-login’ and ‘ein:notebooklist-open’.With C-u prefix arg, it will prompt the user for the path to the jupyter executable first. Else, it will try to use the value of ‘</em>ein:last-jupyter-command*’ or the value of the customizable variable ‘ein:jupyter-default-server-command’.Then it prompts the user for the path of the root directory containing the notebooks the user wants to access.The buffer named by ‘ein:jupyter-server-buffer-name’ will contain the log of the running jupyter server.</p>
</li>
<li><p><em>function</em> (<code>ein:run</code><em>server-cmd-path</em> <em>notebook-directory</em> <em>&amp;optional</em> <em>no-login-p</em> <em>login-callback</em> <em>port</em>)</p>
<p>Start SERVER-CMD_PATH with ‘–notebook-dir’ NOTEBOOK-DIRECTORY. Login after connection established unless NO-LOGIN-P is set. LOGIN-CALLBACK takes two arguments, the buffer created by ein:notebooklist-open–finish, and the url-or-port argument of ein:notebooklist-open<em>.This command opens an asynchronous process running the jupyter notebook server and then tries to detect the url and password to generate automatic calls to ‘ein:notebooklist-login’ and ‘ein:notebooklist-open’.With C-u prefix arg, it will prompt the user for the path to the jupyter executable first. Else, it will try to use the value of ‘</em>ein:last-jupyter-command*’ or the value of the customizable variable ‘ein:jupyter-default-server-command’.Then it prompts the user for the path of the root directory containing the notebooks the user wants to access.The buffer named by ‘ein:jupyter-server-buffer-name’ will contain the log of the running jupyter server.</p>
</li>
<li><p><em>function</em> (<code>ein:jupyter-server-stop</code><em>&amp;optional</em> <em>force</em> <em>log</em>)</p>
</li>
</ul>
<ul>
<li><p><em>function</em> (<code>ein:jupyter-server-login-and-open</code><em>&amp;optional</em> <em>callback</em>)</p>
<p>Log in and open a notebooklist buffer for a running jupyter notebook server.Determine if there is a running jupyter server (started via a call to ‘ein:jupyter-server-start’) and then try to guess if token authentication is enabled. If a token is found use it to generate a call to ‘ein:notebooklist-login’ and once authenticated open the notebooklist buffer via a call to ‘ein:notebooklist-open’.</p>
</li>
<li><p><em>variable</em> <code>ein:jupyter-default-server-command</code></p>
<p>The default command to start a jupyter notebook server.Changing this to <code>jupyter-notebook</code> requires customizing <a href="https://millejoh.github.io/emacs-ipython-notebook/#ein:jupyter-server-use-subcommand" target="_blank" rel="noopener"><code>ein:jupyter-server-use-subcommand</code></a> to nil.</p>
</li>
<li><p><em>variable</em> <code>ein:jupyter-server-use-subcommand</code></p>
<p>Users of “jupyter-notebook” (as opposed to “jupyter notebook”) need to <code>Omit</code>.</p>
</li>
<li><p><em>variable</em> <code>ein:jupyter-default-notebook-directory</code></p>
<p>If you are tired of always being queried for the location of the notebook directory, you can set it here for future calls to<a href="https://millejoh.github.io/emacs-ipython-notebook/#ein:jupyter-server-start" target="_blank" rel="noopener"><code>ein:jupyter-server-start</code></a></p>
</li>
<li><p><em>variable</em> <code>ein:jupyter-server-args</code></p>
<p>Add any additional command line options you wish to include with the call to the jupyter notebook.</p>
</li>
<li><p><em>variable</em> <code>ein:jupyter-server-buffer-name</code></p>
<p>The name of the buffer for the jupyter notebook server session.</p>
</li>
</ul>
<h3 id="Notebook-list"><a href="#Notebook-list" class="headerlink" title="Notebook list"></a>Notebook list</h3><p>You can start notebook by <code>M-x ein:notebooklist-open</code> and enter the port or URL of the IPython notebook server.</p>
<ul>
<li><p><em>function</em> (<code>ein:notebooklist-open</code><em>url-or-port</em> <em>callback</em>)</p>
<p>This is now an alias for ein:notebooklist-login</p>
</li>
<li><p><em>function</em> (<code>ein:notebooklist-new-notebook</code><em>url-or-port</em> <em>kernelspec</em> <em>&amp;optional</em> <em>callback</em> <em>no-pop</em> <em>retry</em>)</p>
</li>
</ul>
<ul>
<li><em>function</em> <code>ein:notebooklist-open-notebook-global</code></li>
</ul>
<ul>
<li><p><em>function</em> (<code>ein:notebooklist-login</code><em>url-or-port</em> <em>callback</em> <em>&amp;optional</em> <em>cookie-plist</em>)</p>
<p>Deal with security before main entry of ein:notebooklist-open<em>.CALLBACK takes two arguments, the buffer created by ein:notebooklist-open–success and the url-or-port argument of ein:notebooklist-open</em>.</p>
</li>
<li><p><em>function</em> <code>ein:junk-new</code></p>
</li>
</ul>
<ul>
<li><p><em>function</em> (<code>ein:notebooklist-enable-keepalive</code><em>&amp;optional</em> <em>url-or-port</em>)</p>
<p>Enable periodic calls to the notebook server to keep long running sessions from expiring. By long running we mean sessions to last days, or weeks. The frequency of the refresh (which is very similar to a call to ‘ein:notebooklist-open‘) is controlled by ‘ein:notebooklist-keepalive-refresh-time‘, and is measured in terms of hours. If ‘ein:enable-keepalive’ is non-nil this will automatically be called during calls to ‘ein:notebooklist-open‘.</p>
</li>
<li><p><em>function</em> <code>ein:notebooklist-disable-keepalive</code></p>
<p>Disable the notebooklist keepalive calls to the jupyter notebook server.</p>
</li>
</ul>
<p>Keymap for ein:notebooklist-mode.</p>
<ul>
<li><p><code>&lt;remap&gt; &lt;self-insert-command&gt;`</code> undefined`</p>
</li>
<li><p><code>-`</code> negative-argument`</p>
</li>
<li><p><code>0`</code> digit-argument`</p>
</li>
<li><p><code>1`</code> digit-argument`</p>
</li>
<li><p><code>2`</code> digit-argument`</p>
</li>
<li><p><code>3`</code> digit-argument`</p>
</li>
<li><p><code>4`</code> digit-argument`</p>
</li>
<li><p><code>5`</code> digit-argument`</p>
</li>
<li><p><code>6`</code> digit-argument`</p>
</li>
<li><p><code>7`</code> digit-argument`</p>
</li>
<li><p><code>8`</code> digit-argument`</p>
</li>
<li><p><code>9`</code> digit-argument`</p>
</li>
<li><p><code>q`</code> quit-window`</p>
</li>
<li><p><code>SPC`</code> scroll-up-command`</p>
</li>
<li><p><code>S-SPC`</code> scroll-down-command`</p>
</li>
<li><p><code>DEL`</code> scroll-down-command`</p>
</li>
<li><p><code>?`</code> describe-mode`</p>
</li>
<li><p><code>h`</code> describe-mode`</p>
</li>
<li><p><code>&gt;`</code> end-of-buffer`</p>
</li>
<li><p><code>&lt;`</code> beginning-of-buffer`</p>
</li>
<li><p><code>g`</code> revert-buffer`</p>
</li>
<li><p><code>TAB`</code> widget-forward`</p>
</li>
<li><p><code>C-M-i`</code> widget-backward`</p>
</li>
<li><p><code>&lt;S-tab&gt;`</code> widget-backward`</p>
</li>
<li><p><code>&lt;backtab&gt;`</code> widget-backward`</p>
</li>
<li><p><code>C-c C-r`</code> ein:notebooklist-reload`</p>
</li>
</ul>
<p>  Reload current Notebook list.</p>
<ul>
<li><p><code>C-c C-f`</code> ein:file-open`</p>
</li>
<li><p><code>C-c C-o`</code> ein:notebook-open`</p>
</li>
<li><p><code>p`</code> ein:notebooklist-prev-item`</p>
</li>
<li><p><code>n`</code> ein:notebooklist-next-item`</p>
</li>
</ul>
<h3 id="Notebook"><a href="#Notebook" class="headerlink" title="Notebook"></a>Notebook</h3><p>The following keybindings are available in notebook buffers. Modified notebooks are saved automatically with a frequency dependenant on the setting of ein:notebook-autosave-frequency. If ein:notebook-create-checkpoint-on-save is True than a checkpoint will also be generated in the Jupyter server every time the notebook is saved. A notebook can be returned to a previous checkpoint via ein:notebook-restore-to-checkpoint. Checkpoints can also be manually created via ein:notebook-create-checkpoint.</p>
<ul>
<li><p><code>C-c i`</code> ein:inspect-object`</p>
</li>
<li><p><code>C-c &#39;`</code> ein:edit-cell-contents`</p>
</li>
<li><p><code>C-c C-c`</code> ein:worksheet-execute-cell`</p>
</li>
<li><p><code>C-c C-&#39;`</code> ein:worksheet-turn-on-autoexec`</p>
</li>
<li><p><code>C-c C-e`</code> ein:worksheet-toggle-output`</p>
</li>
<li><p><code>C-c C-v`</code> ein:worksheet-set-output-visibility-all`</p>
</li>
<li><p><code>C-c C-l`</code> ein:worksheet-clear-output`</p>
</li>
<li><p><code>C-c C-S-l`</code> ein:worksheet-clear-all-output`</p>
</li>
<li><p><code>C-c C-;`</code> ein:shared-output-show-code-cell-at-point`</p>
</li>
<li><p><code>C-c C-k`</code> ein:worksheet-kill-cell`</p>
</li>
<li><p><code>C-c M-w`</code> ein:worksheet-copy-cell`</p>
</li>
<li><p><code>C-c M-{`</code> ein:notebook-worksheet-move-prev`</p>
</li>
<li><p><code>C-c M-}`</code> ein:notebook-worksheet-move-next`</p>
</li>
<li><p><code>C-c M-+`</code> ein:notebook-worksheet-insert-prev`</p>
</li>
<li><p><code>C-c C-w`</code> ein:worksheet-copy-cell`</p>
</li>
<li><p><code>C-c C-y`</code> ein:worksheet-yank-cell`</p>
</li>
<li><p><code>C-c C-a`</code> ein:worksheet-insert-cell-above`</p>
<ul>
<li><code>C-c C-b`</code> ein:worksheet-insert-cell-below`</li>
</ul>
</li>
<li><p><code>C-c C-t`</code> ein:worksheet-toggle-cell-type`</p>
</li>
<li><p><code>C-c S`</code> ein:worksheet-toggle-slide-type`</p>
</li>
<li><p><code>C-c C-u`</code> ein:worksheet-change-cell-type`</p>
</li>
<li><p><code>C-c C-s`</code> ein:worksheet-split-cell-at-point`</p>
</li>
<li><p><code>C-c C-m`</code> ein:worksheet-merge-cell`</p>
</li>
<li><p><code>C-c C-n`</code> ein:worksheet-goto-next-input`</p>
</li>
<li><p><code>C-c C-p`</code> ein:worksheet-goto-prev-input`</p>
</li>
<li><p><code>C-c &lt;up&gt;`</code> ein:worksheet-move-cell-up`</p>
</li>
<li><p><code>C-c &lt;down&gt;`</code> ein:worksheet-move-cell-down`</p>
</li>
<li><p><code>C-c C-h`</code> ein:pytools-request-tooltip-or-help`</p>
</li>
<li><p><code>C-c C-i`</code> ein:completer-complete`</p>
</li>
<li><p><code>C-c C-$`</code> ein:tb-show`</p>
</li>
<li><p><code>C-c C-x C-l`</code> ein:notebook-toggle-latex-fragment`</p>
</li>
<li><p><code>C-c C-x C-r`</code> ein:notebook-restart-session-command`</p>
</li>
<li><p><code>C-c C-r`</code> ein:notebook-reconnect-session-command`</p>
</li>
<li><p><code>C-c C-z`</code> ein:notebook-kernel-interrupt-command`</p>
</li>
<li><p><code>C-c C-q`</code> ein:notebook-kill-kernel-then-close-command`</p>
</li>
<li><p><code>C-c C-#`</code> ein:notebook-close`</p>
</li>
<li><p><code>C-c C-f`</code> ein:file-open`</p>
</li>
<li><p><code>C-c C-o`</code> ein:notebook-open`</p>
</li>
<li><p><code>C-c C-.`</code> ein:pytools-jump-to-source-command`</p>
</li>
</ul>
<p>  Jump to the source code of the object at point. When the prefix argument ‘‘C-u‘‘ is given, open the source code in the other window. You can explicitly specify the object by selecting it.</p>
<ul>
<li><code>C-c C-,`</code> ein:pytools-jump-back-command`</li>
</ul>
<p>  Go back to the point where ‘ein:pytools-jump-to-source-command’ is executed last time. When the prefix argument ‘‘C-u‘‘ is given, open the last point in the other window.</p>
<ul>
<li><p><code>C-c C-/`</code> ein:notebook-scratchsheet-open`</p>
</li>
<li><p><code>C-c !`</code> ein:worksheet-rename-sheet`</p>
</li>
<li><p><code>C-c {`</code> ein:notebook-worksheet-open-prev-or-last`</p>
</li>
<li><p><code>C-c }`</code> ein:notebook-worksheet-open-next-or-first`</p>
</li>
<li><p><code>C-c +`</code> ein:notebook-worksheet-insert-next`</p>
</li>
<li><p><code>C-c -`</code> ein:notebook-worksheet-delete`</p>
</li>
<li><p><code>C-c 1`</code> ein:notebook-worksheet-open-1th`</p>
</li>
<li><p><code>C-c 2`</code> ein:notebook-worksheet-open-2th`</p>
</li>
<li><p><code>C-c 3`</code> ein:notebook-worksheet-open-3th`</p>
</li>
<li><p><code>C-c 4`</code> ein:notebook-worksheet-open-4th`</p>
</li>
<li><p><code>C-c 5`</code> ein:notebook-worksheet-open-5th`</p>
</li>
<li><p><code>C-c 6`</code> ein:notebook-worksheet-open-6th`</p>
</li>
<li><p><code>C-c 7`</code> ein:notebook-worksheet-open-7th`</p>
</li>
<li><p><code>C-c 8`</code> ein:notebook-worksheet-open-8th`</p>
</li>
<li><p><code>C-c 9`</code> ein:notebook-worksheet-open-last`</p>
</li>
<li><p><code>M-RET`</code> ein:worksheet-execute-cell-and-goto-next`</p>
</li>
<li><p><code>M-.`</code> ein:pytools-jump-to-source-command`</p>
</li>
</ul>
<p>  Jump to the source code of the object at point. When the prefix argument ‘‘C-u‘‘ is given, open the source code in the other window. You can explicitly specify the object by selecting it.</p>
<ul>
<li><code>M-,`</code> ein:pytools-jump-back-command`</li>
</ul>
<p>  Go back to the point where ‘ein:pytools-jump-to-source-command’ is executed last time. When the prefix argument ‘‘C-u‘‘ is given, open the last point in the other window.</p>
<ul>
<li><p><code>M-p`</code> ein:worksheet-previous-input-history`</p>
</li>
<li><p><code>M-n`</code> ein:worksheet-next-input-history`</p>
</li>
<li><p><code>&lt;M-S-return&gt;`</code> ein:worksheet-execute-cell-and-insert-below`</p>
</li>
<li><p><code>&lt;C-up&gt;`</code> ein:worksheet-goto-prev-input`</p>
</li>
<li><p><code>&lt;C-down&gt;`</code> ein:worksheet-goto-next-input`</p>
</li>
<li><p><code>&lt;M-up&gt;`</code> ein:worksheet-move-cell-up`</p>
</li>
<li><p><code>&lt;M-down&gt;`</code> ein:worksheet-move-cell-down`</p>
</li>
<li><p><code>C-:`</code> ein:shared-output-eval-string`</p>
</li>
<li><p><code>C-x C-s`</code> ein:notebook-save-notebook-command`</p>
</li>
<li><p><code>C-x C-w`</code> ein:notebook-rename-command`</p>
</li>
<li><p><em>function</em> (<code>ein:worksheet-execute-all-cell</code><em>ws</em>)</p>
<p>Execute all cells in the current worksheet buffer.</p>
</li>
<li><p><em>function</em> (<code>ein:worksheet-delete-cell</code><em>ws</em> <em>cell</em> <em>&amp;optional</em> <em>focus</em>)</p>
<p>Delete a cell. (WARNING: no undo!) This command has no key binding because there is no way to undo deletion. Use kill to play on the safe side.If you really want use this command, you can do something like this (but be careful when using it!):<code>(define-key ein:notebook-mode-map &quot;\C-c\C-d&quot;             ’ein:worksheet-delete-cell)</code></p>
</li>
<li><p><em>function</em> <code>ein:junk-rename</code></p>
</li>
</ul>
<ul>
<li><p><em>function</em> (<code>ein:iexec-mode</code><em>&amp;optional</em> <em>arg</em>)</p>
<p>Instant cell execution minor mode. Code cell at point will be automatically executed after any change in its input area.</p>
</li>
<li><p><em>function</em> (<code>ein:notebook-create-checkpoint</code><em>notebook</em>)</p>
<p>Create checkpoint for current notebook based on most recent save.</p>
</li>
<li><p><em>function</em> (<code>ein:notebook-restore-to-checkpoint</code><em>notebook</em> <em>checkpoint</em>)</p>
<p>Restore notebook to previous checkpoint saved on the Jupyter server. Note that if there are multiple checkpoints the user will be prompted on which one to use.</p>
</li>
<li><p><em>function</em> (<code>ein:notebook-enable-autosaves</code><em>notebook</em>)</p>
<p>Enable automatic, periodic saving for notebook.</p>
</li>
<li><p><em>function</em> (<code>ein:notebook-disable-autosaves</code><em>notebook</em>)</p>
<p>Disable automatic, periodic saving for current notebook.</p>
</li>
</ul>
<h3 id="Polymode-in-the-Notebook"><a href="#Polymode-in-the-Notebook" class="headerlink" title="Polymode in the Notebook"></a>Polymode in the Notebook</h3><p>EIN now provides proper multi-major mode support in notebook buffers using <a href="https://millejoh.github.io/emacs-ipython-notebook/#id32" target="_blank" rel="noopener">polymode_</a>. To use simply set <a href="https://millejoh.github.io/emacs-ipython-notebook/#ein:polymode" target="_blank" rel="noopener"><code>ein:polymode</code></a>to <code>t</code> and restart emacs.</p>
<ul>
<li><p><em>variable</em> <code>ein:polymode</code></p>
<p>When enabled ein will use polymode to provide multi-major mode support in a notebook buffer, otherwise ein’s custom and outdated multi-major mode support will be used. Emacs must be restarted after changing this setting!</p>
</li>
</ul>
<h3 id="Advanced-Editing"><a href="#Advanced-Editing" class="headerlink" title="Advanced Editing"></a>Advanced Editing</h3><p>Worksheet cells can be edited in a manner similar to <a href="http://orgmode.org/manual/Editing-source-code.html#Editing-source-code" target="_blank" rel="noopener">source blocks</a> in Org buffers. Use <code>C-c &#39;</code> to edit the contents of the current cell. You can execute the contents of the buffer and the results will be sent to the output of the cell being edited.</p>
<ul>
<li><code>C-c &#39;`</code> ein:edit-cell-exit`</li>
</ul>
<p>  Close the EIN source edit buffer, saving contents back to the original notebook cell, unless being called via ‘ein:edit-cell-abort’.</p>
<ul>
<li><code>C-c C-k`</code> ein:edit-cell-abort`</li>
</ul>
<p>  Abort editing the current cell, contents will revert to previous value.</p>
<ul>
<li><code>C-c C-c`</code> ein:edit-cell-save-and-execute`</li>
</ul>
<p>  Save, then execute the countents of the EIN source edit buffer and place results (if any) in output of original notebook cell.</p>
<ul>
<li><code>C-c C-x`</code> ein:edit-cell-view-traceback`</li>
</ul>
<p>  Jump to traceback, if there is one, for current edit.</p>
<ul>
<li><code>C-x C-s`</code> ein:edit-cell-save`</li>
</ul>
<p>  Save contents of EIN source edit buffer back to original notebook cell.</p>
<ul>
<li><em>function</em> <code>ein:edit-cell-contents</code></li>
</ul>
<ul>
<li><p><em>function</em> <code>ein:edit-cell-exit</code></p>
<p>Close the EIN source edit buffer, saving contents back to the original notebook cell, unless being called via ‘ein:edit-cell-abort’.</p>
</li>
<li><p><em>function</em> <code>ein:edit-cell-abort</code></p>
<p>Abort editing the current cell, contents will revert to previous value.</p>
</li>
<li><p><em>function</em> <code>ein:edit-cell-save</code></p>
<p>Save contents of EIN source edit buffer back to original notebook cell.</p>
</li>
<li><p><em>function</em> <code>ein:edit-cell-save-and-execute</code></p>
<p>Save, then execute the countents of the EIN source edit buffer and place results (if any) in output of original notebook cell.</p>
</li>
</ul>
<h3 id="Connected-buffer"><a href="#Connected-buffer" class="headerlink" title="Connected buffer"></a>Connected buffer</h3><p>You can connect any buffer (though typically a buffer that contains a Python file) to an opened notebook and use the kernel of that notebook to execute code, inspect objects, auto-complete code, jump to the other source, etc. Once the buffer is connected to the notebook, minor mode <code>ein:connect-mode</code> is enabled and the following keybinds are available.</p>
<ul>
<li><code>C-c C-c`</code> ein:connect-run-or-eval-buffer`</li>
</ul>
<p>  Run buffer using the ‘‘%run‘‘ magic command or eval whole buffer if the prefix ‘‘C-u‘‘ is given. Variable ‘ein:connect-run-command’ sets the command to run. You can change the command and/or set the options. See also: ‘ein:connect-run-buffer’, ‘ein:connect-eval-buffer’.</p>
<ul>
<li><code>C-c C-l`</code> ein:connect-reload-buffer`</li>
</ul>
<p>  Reload buffer using the command set by ‘ein:connect-reload-command’.</p>
<ul>
<li><p><code>C-c C-r`</code> ein:connect-eval-region`</p>
</li>
<li><p><code>C-c C-h`</code> ein:pytools-request-tooltip-or-help`</p>
</li>
<li><p><code>C-c C-i`</code> ein:completer-complete`</p>
</li>
<li><p><code>C-c C-z`</code> ein:connect-pop-to-notebook`</p>
</li>
<li><p><code>C-c C-a`</code> ein:connect-toggle-autoexec`</p>
</li>
</ul>
<p>  Toggle auto-execution mode of the current connected buffer.When auto-execution mode is on, cells in connected notebook will be automatically executed whenever run, eval or reload command <a href="https://millejoh.github.io/emacs-ipython-notebook/#id5" target="_blank" rel="noopener">3</a> is called in this buffer.4Namely, one of‘ein:connect-run-buffer’‘ein:connect-eval-buffer’‘ein:connect-run-or-eval-buffer’‘ein:connect-reload-buffer’Note that you need to set cells to run in the connecting buffer or no cell will be executed. Use the ‘ein:worksheet-turn-on-autoexec’ command in notebook to change the cells to run.</p>
<ul>
<li><code>C-c C-o`</code> ein:console-open`</li>
</ul>
<p>  Open IPython console. To use this function, ‘ein:console-security-dir’ and ‘ein:console-args’ must be set properly. This function works best with the new <a href="https://github.com/fgallina/python.el" target="_blank" rel="noopener">python.el</a> which is shipped with Emacs 24.2 or later. If you don’t have it, this function opens a “plain” command line interpreter (comint) buffer where you cannot use fancy stuff such as TAB completion. It should be possible to support python-mode.el. Patches are welcome!</p>
<ul>
<li><p><code>C-c C-x`</code> ein:tb-show`</p>
</li>
<li><p><code>C-c C-.`</code> ein:pytools-jump-to-source-command`</p>
</li>
</ul>
<p>  Jump to the source code of the object at point. When the prefix argument ‘‘C-u‘‘ is given, open the source code in the other window. You can explicitly specify the object by selecting it.</p>
<ul>
<li><code>C-c C-,`</code> ein:pytools-jump-back-command`</li>
</ul>
<p>  Go back to the point where ‘ein:pytools-jump-to-source-command’ is executed last time. When the prefix argument ‘‘C-u‘‘ is given, open the last point in the other window.</p>
<ul>
<li><p><code>C-c C-/`</code> ein:notebook-scratchsheet-open`</p>
</li>
<li><p><code>C-:`</code> ein:shared-output-eval-string`</p>
</li>
<li><p><code>M-.`</code> ein:pytools-jump-to-source-command`</p>
</li>
</ul>
<p>  Jump to the source code of the object at point. When the prefix argument ‘‘C-u‘‘ is given, open the source code in the other window. You can explicitly specify the object by selecting it.</p>
<ul>
<li><code>M-,`</code> ein:pytools-jump-back-command`</li>
</ul>
<p>  Go back to the point where ‘ein:pytools-jump-to-source-command’ is executed last time. When the prefix argument ‘‘C-u‘‘ is given, open the last point in the other window.</p>
<p>Other useful commands:</p>
<ul>
<li><p><em>function</em> (<code>ein:connect-to-notebook-command</code><em>&amp;optional</em> <em>not-yet-opened</em>)</p>
<p>Connect to notebook. When the prefix argument is given, you can choose any notebook on your server including the ones not yet opened. Otherwise, already chose from already opened notebooks.</p>
</li>
<li><p><em>function</em> <code>ein:connect-eval-buffer</code></p>
<p>Evaluate the whole buffer. Note that this will run the code inside the ‘‘if <strong>name</strong> == “<strong>main</strong>”:‘‘ block.</p>
</li>
<li><p><em>function</em> (<code>ein:connect-run-buffer</code><em>&amp;optional</em> <em>ask-command</em>)</p>
<p>Run buffer using ‘‘%run‘‘. Ask for command if the prefix ‘‘C-u‘‘ is given. Variable ‘ein:connect-run-command’ sets the default command.</p>
</li>
</ul>
<h3 id="Shared-output-buffer"><a href="#Shared-output-buffer" class="headerlink" title="Shared output buffer"></a>Shared output buffer</h3><ul>
<li><p><em>function</em> <code>ein:shared-output-pop-to-buffer</code></p>
<p>Open shared output buffer.</p>
</li>
</ul>
<p>The map for ein:shared-output-mode-map.</p>
<ul>
<li><p><code>C-c C-x`</code> ein:tb-show`</p>
</li>
<li><p><code>C-c C-.`</code> ein:pytools-jump-to-source-command`</p>
</li>
</ul>
<p>  Jump to the source code of the object at point. When the prefix argument ‘‘C-u‘‘ is given, open the source code in the other window. You can explicitly specify the object by selecting it.</p>
<ul>
<li><code>M-.`</code> ein:pytools-jump-to-source-command`</li>
</ul>
<p>  Jump to the source code of the object at point. When the prefix argument ‘‘C-u‘‘ is given, open the source code in the other window. You can explicitly specify the object by selecting it.</p>
<h3 id="Traceback-viewer"><a href="#Traceback-viewer" class="headerlink" title="Traceback viewer"></a>Traceback viewer</h3><p>Tracebacks from the notebook buffer can be difficult to understand. You can open a Traceback viewer by calling <code>ein:notebook-view-traceback</code>.</p>
<p>In the Traceback viewer, following keybinds are available.</p>
<p>Keymap for ein:traceback-mode.</p>
<ul>
<li><p><code>RET`</code> ein:tb-jump-to-source-at-point-command`</p>
</li>
<li><p><code>p`</code> ein:tb-prev-item`</p>
</li>
<li><p><code>n`</code> ein:tb-next-item`</p>
</li>
</ul>
<h3 id="PyTools"><a href="#PyTools" class="headerlink" title="PyTools"></a>PyTools</h3><p>These commands can be used in the notebook buffer and the connected buffer.</p>
<ul>
<li><p><em>function</em> <code>ein:pytools-doctest</code></p>
<p>Do the doctest of the object at point.</p>
</li>
<li><p><em>function</em> <code>ein:pytools-whos</code></p>
<p>Execute ‘‘%whos‘‘ magic command and popup the result.</p>
</li>
<li><p><em>function</em> (<code>ein:pytools-hierarchy</code><em>&amp;optional</em> <em>ask</em>)</p>
<p>Draw inheritance graph of the class at point. <a href="https://github.com/tkf/ipython-hierarchymagic" target="_blank" rel="noopener">hierarchymagic</a> extension is needed to be installed. You can explicitly specify the object by selecting it.</p>
</li>
<li><p><em>function</em> (<code>ein:pytools-pandas-to-ses</code><em>dataframe</em>)</p>
<p>View <a href="http://pandas.pydata.org/" target="_blank" rel="noopener">pandas</a> DataFrame in <a href="http://www.gnu.org/software/emacs/manual/html_node/ses/index.html" target="_blank" rel="noopener">SES</a> (Simple Emacs Spreadsheet). Open a ‘ses-mode’ buffer and import DataFrame object into it.<a href="http://www.gnu.org/software/emacs/manual/html_node/ses/index.html" target="_blank" rel="noopener">SES</a> is distributed with Emacs since Emacs 22, so you don’t need to install it if you are using newer Emacs.</p>
</li>
<li><p><em>function</em> (<code>ein:pytools-export-buffer</code><em>buffer</em> <em>format</em>)</p>
<p>Export contents of notebook using <a href="http://ipython.org/ipython-doc/stable/notebook/nbconvert.html" target="_blank" rel="noopener">nbconvert</a> to user-specified format (options will depend on the version of nbconvert available) to a new buffer.Currently EIN/IPython supports exporting to the following formats:HTMLJSON (this is basically the same as opening the ipynb file in a buffer).LatexMarkdownPythonRSTSlides</p>
</li>
</ul>
<h3 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h3><ul>
<li><p><em>function</em> <code>helm-ein-kernel-history</code></p>
<p>Search kernel execution history then insert the selected one.</p>
</li>
<li><p><em>function</em> <code>helm-ein-notebook-buffers</code></p>
<p>Choose opened notebook using helm interface.</p>
</li>
<li><p><em>function</em> <code>anything-ein-kernel-history</code></p>
<p>Search kernel execution history then insert the selected one.</p>
</li>
<li><p><em>function</em> <code>anything-ein-notebook-buffers</code></p>
<p>Choose opened notebook using anything.el interface.</p>
</li>
</ul>
<h2 id="Org-mode-Integration-ob-ein"><a href="#Org-mode-Integration-ob-ein" class="headerlink" title="Org-mode Integration (ob-ein)"></a>Org-mode Integration (ob-ein)</h2><p>Configuration:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">M-x customize-group RET org-babel</span><br><span class="line">Org Babel Load Languages:</span><br><span class="line">  Insert (ein . t)</span><br><span class="line">  For example, &apos;((emacs-lisp . t) (ein . t))</span><br></pre></td></tr></table></figure>
<p>Snippet:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">#BEGIN_SRC *language* :session localhost :results raw drawer</span><br><span class="line">  import numpy, math, matplotlib.pyplot as plt</span><br><span class="line">  %matplotlib inline</span><br><span class="line">  x = numpy.linspace(0, 2*math.pi)</span><br><span class="line">  plt.plot(x, numpy.sin(x))</span><br><span class="line">#+END_SRC</span><br></pre></td></tr></table></figure>
<ul>
<li><p><em>Language</em> can be <code>ein-python</code>, <code>ein-r</code>, or <code>ein-julia</code>. <strong>The relevant</strong> <a href="https://github.com/jupyter/jupyter/wiki/Jupyter-kernels" target="_blank" rel="noopener">jupyter kernel</a> <strong>must be installed before use</strong>. Additional languages can be</p>
<p>configured via:<code>M-x customize-group RET ein Ob Ein Languages</code></p>
</li>
</ul>
<p>The format for the :session header argument is {url-or-port}/{path-to-notebook}. Just specifying {url-or-port}executes your source block in a single anonymous notebook (this effects an ipython repl in org). You should also specify :results raw drawer for proper rendering inside the org buffer. For example:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">#+BEGIN_SRC ein-python :session localhost :results raw drawer</span><br><span class="line">  import sys</span><br><span class="line"></span><br><span class="line">  a = 14500</span><br><span class="line">  b = a+1000</span><br><span class="line">  sys.version</span><br><span class="line">#+END_SRC</span><br></pre></td></tr></table></figure>
<p>If your code block generates an image, like from an matplotlib plot, ein will automatically save to a file in the directory specified by <a href="https://millejoh.github.io/emacs-ipython-notebook/#ein:org-inline-image-directory" target="_blank" rel="noopener"><code>ein:org-inline-image-directory</code></a> and generate an appropriate inline link. You can also specify the file to save the image to using by the :image argument as in the example below:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">#BEGIN_SRC ein :session localhost :results raw drawer :image output.png</span><br><span class="line">  import matplotlib.pyplot as plt</span><br><span class="line">  import numpy as np</span><br><span class="line"></span><br><span class="line">  %matplotlib inline</span><br><span class="line">  x = np.linspace(0, 1, 100)</span><br><span class="line">  y = np.random.rand(100,1)</span><br><span class="line">  plt.plot(x,y)</span><br><span class="line">#+END_SRC</span><br></pre></td></tr></table></figure>
<p>To get proper syntax highlighting for non-Python kernels, use the function <a href="https://millejoh.github.io/emacs-ipython-notebook/#ein:org-register-lang-mode" target="_blank" rel="noopener"><code>ein:org-register-lang-mode</code></a> to define a new ein-based org source language. For example, to get proper syntax highlighting for an R kernel, first call</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(ein:org-register-lang-mode &quot;ein-R&quot; &apos;R)</span><br></pre></td></tr></table></figure>
<p>Then org SRC blocks with language “ein-R” will use R syntax highlighting:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">#BEGIN_SRC ein-R :session localhost :results raw drawer :image output.png</span><br><span class="line">  plot(1:10, 1:10)</span><br><span class="line">#+END_SRC</span><br></pre></td></tr></table></figure>
<p>You can also link to an IPython notebook from <a href="http://orgmode.org/" target="_blank" rel="noopener">org-mode</a> files.</p>
<ol>
<li>Call org-mode function <code>org-store-link</code> <a href="https://millejoh.github.io/emacs-ipython-notebook/#org-store-link" target="_blank" rel="noopener">5</a> in notebook buffer. You can select a region to specify a position in the notebook.</li>
<li>Go to org-mode file and type <code>C-c C-l</code> (<code>org-insert-link</code>). This will insert a link to the notebook.</li>
<li>Type <code>C-c C-o</code> (<code>org-open-at-point</code>) to open the link at the point of cursor.</li>
</ol>
<ul>
<li><p><a href="https://millejoh.github.io/emacs-ipython-notebook/#id9" target="_blank" rel="noopener">5</a></p>
<p>See <a href="http://orgmode.org/manual/Activation.html" target="_blank" rel="noopener">1.3 Activation</a> in org-mode manual.</p>
</li>
</ul>
<h3 id="Customization"><a href="#Customization" class="headerlink" title="Customization"></a>Customization</h3><ul>
<li><em>variable</em> <code>ein:org-async-p</code></li>
</ul>
<ul>
<li><em>variable</em> <code>ein:org-inline-image-directory</code></li>
</ul>
<ul>
<li><em>function</em> <code>ein:org-register-lang-mode</code></li>
</ul>
<h2 id="Support-for-The-Hy-Language-EXPERIMENTAL"><a href="#Support-for-The-Hy-Language-EXPERIMENTAL" class="headerlink" title="Support for The Hy Language (EXPERIMENTAL)"></a>Support for The Hy Language (EXPERIMENTAL)</h2><p>New in v0.14, ein has limited support for executing <a href="http://docs.hylang.org/en/stable/" target="_blank" rel="noopener">hy</a> code in a notebook running an ipython kernel. Before trying this feature you will need to install hy per the <a href="http://docs.hylang.org/en/stable/quickstart.html" target="_blank" rel="noopener">quickstart</a> instructions.</p>
<p>Once you have set up <a href="http://docs.hylang.org/en/stable/" target="_blank" rel="noopener">hy</a> in your ipython kernel, open or create a notebook running this kernel and create or go to an empty cell. You will need to change the cell type to hy using <code>ein:worksheet-change-cell-type</code>. Once that is done you can enter hy expressions and they will be correctly evaluated by the kernel!</p>
<p>If you are running a <a href="https://github.com/Calysto/calysto_hy" target="_blank" rel="noopener">hy kernel</a> you can, of course, write hy expressions in code cells and have the expected results.</p>
<h2 id="Customization-1"><a href="#Customization-1" class="headerlink" title="Customization"></a>Customization</h2><p>You can customize EIN by typing <code>M-x customize-group RET ein RET</code>. All the configurable variables are listed below.</p>
<h3 id="Subpackages"><a href="#Subpackages" class="headerlink" title="Subpackages"></a>Subpackages</h3><ul>
<li><p><em>variable</em> <code>ein:completion-backend</code></p>
<p>EIN defaults to your individual company-mode or auto-complete-mode configuration. Change this setting to gather completions from the jupyter server:<code>* ein:use-none-backend: local completions only (configured outside EIN) * ein:use-company-backend: company-style remote completions (elpy takes precedence) * ein:use-ac-backend: deprecated auto-complete remote completions</code></p>
</li>
<li><p><em>variable</em> <code>ein:use-smartrep</code></p>
<p>Set to <code>t</code> to use preset smartrep configuration.WarningWhen used with MuMaMo (see <a href="https://millejoh.github.io/emacs-ipython-notebook/#ein:notebook-modes" target="_blank" rel="noopener"><code>ein:notebook-modes</code></a>), keyboard macro which manipulates cell (add, remove, move, etc.) may start infinite loop (you need to stop it with <code>C-g</code>). Please be careful using this option if you are a heavy keyboard macro user. Using keyboard macro for other commands is fine.</p>
</li>
<li><p><em>variable</em> <code>ein:load-dev</code></p>
</li>
</ul>
<h3 id="Notebook-list-1"><a href="#Notebook-list-1" class="headerlink" title="Notebook list"></a>Notebook list</h3><ul>
<li><p><em>variable</em> <code>ein:url-or-port</code></p>
<p>List of default url-or-port values. This will be used for completion. So put your IPython servers. You can connect to servers not in this list (but you will need to type every time).</p>
</li>
<li><p><em>variable</em> <code>ein:default-url-or-port</code></p>
<p>Default URL or port. This should be your main IPython Notebook server.</p>
</li>
<li><p><em>function</em> (<code>ein:notebooklist-load</code><em>&amp;optional</em> <em>url-or-port</em>)</p>
<p>Load notebook list but do not pop-up the notebook list buffer.For example, if you want to load notebook list when Emacs starts, add this in the Emacs initialization file:<code>(add-to-hook ’after-init-hook ’ein:notebooklist-load)</code>or even this (if you want fast Emacs start-up):<code>;; load notebook list if Emacs is idle for 3 sec after start-up (run-with-idle-timer 3 nil #’ein:notebooklist-load)</code>You should setup ‘ein:url-or-port’ or ‘ein:default-url-or-port’ in order to make this code work.See also: ‘ein:connect-to-default-notebook’, ‘ein:connect-default-notebook’.</p>
</li>
</ul>
<h3 id="Notebook-1"><a href="#Notebook-1" class="headerlink" title="Notebook"></a>Notebook</h3><ul>
<li><p><em>variable</em> <code>ein:worksheet-enable-undo</code></p>
<p>When non-<code>nil</code>, allow undo of cell inputs only (as opposed towhole-cell operations such as killing, moving, executing cells).Changes to this variable only take effect for newly opened worksheets.</p>
</li>
<li><p><em>variable</em> <code>ein:polymode</code></p>
<p>When enabled ein will use polymode to provide multi-major mode support in a notebook buffer, otherwise ein’s custom and outdated multi-major mode support will be used. Emacs must be restarted after changing this setting!</p>
</li>
<li><p><em>variable</em> <code>ein:notebook-modes</code></p>
<p>Notebook modes to use (in order of preference).When the notebook is opened, mode in this value is checked one by one and the first usable mode is used.Available modes:<code>ein:notebook-multilang-mode`</code>ein:notebook-mumamo-mode<code>ein:notebook-python-mode</code>ein:notebook-plain-mode<code>Examples:Use MuMaMo if it is installed. Otherwise, use plain mode. This is the old default setting:</code>(setq ein:notebook-modes ‘(ein:notebook-mumamo-mode ein:notebook-plain-mode)) <code>Avoid using MuMaMo even when it is installed:</code>(setq ein:notebook-modes ‘(ein:notebook-plain-mode)) <code>Use simple</code>python-mode<code>based notebook mode when MuMaMo is not installed:</code>(setq ein:notebook-modes ‘(ein:notebook-mumamo-mode ein:notebook-python-mode)) `</p>
</li>
<li><p><em>variable</em> <code>ein:notebook-querty-timeout-open</code></p>
</li>
</ul>
<ul>
<li><p><em>variable</em> <code>ein:notebook-querty-timeout-save</code></p>
<p>Query timeout for saving notebook. Similar to <a href="https://millejoh.github.io/emacs-ipython-notebook/#ein:notebook-querty-timeout-open" target="_blank" rel="noopener"><code>ein:notebook-querty-timeout-open</code></a>, but for saving notebook. For global setting and more information, see <a href="https://millejoh.github.io/emacs-ipython-notebook/#ein:query-timeout" target="_blank" rel="noopener"><code>ein:query-timeout</code></a>.</p>
</li>
<li><p><em>variable</em> <code>ein:cell-traceback-level</code></p>
<p>Number of traceback stack to show. Hidden tracebacks are not discarded. You can view them using [ein:tb-show].</p>
</li>
<li><p><em>variable</em> <code>ein:cell-autoexec-prompt</code></p>
<p>String shown in the cell prompt when the auto-execution flag is on. See also <a href="https://millejoh.github.io/emacs-ipython-notebook/#ein:connect-aotoexec-lighter" target="_blank" rel="noopener"><code>ein:connect-aotoexec-lighter</code></a>.</p>
</li>
<li><p><em>variable</em> <code>ein:junk-notebook-name-template</code></p>
</li>
</ul>
<ul>
<li><p><em>variable</em> <code>ein:iexec-delay</code></p>
<p>Delay before executing cell after change in second.</p>
</li>
<li><p><em>variable</em> <code>ein:complete-on-dot</code></p>
</li>
</ul>
<ul>
<li><p><em>variable</em> <code>ein:helm-kernel-history-search-key</code></p>
<p>Bind <a href="https://millejoh.github.io/emacs-ipython-notebook/#helm-ein-kernel-history" target="_blank" rel="noopener"><code>helm-ein-kernel-history</code></a> to this key in notebook mode.Example:<code>(setq ein:helm-kernel-history-search-key &quot;\M-r&quot;)</code>This key will be installed in the <code>ein:notebook-mode-map</code>.</p>
</li>
<li><p><em>variable</em> <code>ein:anything-kernel-history-search-key</code></p>
<p>Bind <a href="https://millejoh.github.io/emacs-ipython-notebook/#anything-ein-kernel-history" target="_blank" rel="noopener"><code>anything-ein-kernel-history</code></a> to this key in notebook mode.Example:<code>(setq ein:anything-kernel-history-search-key &quot;\M-r&quot;)</code>This key will be installed in the <code>ein:notebook-mode-map</code>.</p>
</li>
<li><p><em>variable</em> <code>ein:helm-kernel-history-search-auto-pattern</code></p>
<p>Automatically construct search pattern when non-<code>nil</code>.Single space is converted to “<em>”.A backslash followed by a space is converted to a single space.A “</em>” is added at the beginning and end of the pattern.This variable applies to both <a href="https://millejoh.github.io/emacs-ipython-notebook/#helm-ein-kernel-history" target="_blank" rel="noopener"><code>helm-ein-kernel-history</code></a> and <a href="https://millejoh.github.io/emacs-ipython-notebook/#anything-ein-kernel-history" target="_blank" rel="noopener"><code>anything-ein-kernel-history</code></a>.</p>
</li>
<li><p><em>variable</em> <code>ein:output-type-preference</code></p>
<p>Output types to be used in notebook. First output-type found in this list will be used. This variable can be a list or a function returning a list given DATA plist. See also <code>ein:output-type-prefer-pretty-text-over-html</code>.<strong>Example</strong>: If you prefer HTML type over text type, you can set it as:<code>(setq ein:output-type-preference       &#39;(emacs-lisp svg png jpeg html text latex javascript))</code>Note that <code>html</code> comes before <code>text</code>.</p>
</li>
<li><p><em>variable</em> <code>ein:shr-env</code></p>
<p>Variables let-bound while calling <code>shr-insert-document</code>.To use default shr setting:<code>(setq ein:shr-env nil)</code>Draw boundaries for table (default):<code>(setq ein:shr-env       &#39;((shr-table-horizontal-line ?-)         (shr-table-vertical-line ?|)         (shr-table-corner ?+)))</code></p>
</li>
<li><p><em>variable</em> <code>ein:notebook-autosave-frequency</code></p>
<p>Sets the frequency (in seconds) at which the notebook is automatically saved, per IPEP15. Set to 0 to disable this feature.Autosaves are automatically enabled when a notebook is opened, but can be controlled manually via <code>ein:notebook-enable-autosave</code> and <code>ein:notebook-disable-autosave</code>.If you wish to change the autosave frequency for the current notebook call <code>ein:notebook-update-autosave-freqency</code>.</p>
</li>
<li><p><em>variable</em> <code>ein:notebook-create-checkpoint-on-save</code></p>
<p>If non-nil a checkpoint will be created every time the notebook is saved. Otherwise checkpoints must be created manually via <a href="https://millejoh.github.io/emacs-ipython-notebook/#ein:notebook-create-checkpoint" target="_blank" rel="noopener"><code>ein:notebook-create-checkpoint</code></a>.</p>
</li>
</ul>
<h3 id="Console"><a href="#Console" class="headerlink" title="Console"></a>Console</h3><ul>
<li><p><em>variable</em> <code>ein:console-security-dir</code></p>
<p>Security directory setting.Following types are valid:stringUse this value as a path to security directory. Handy when you have only one IPython server.alistAn alist whose element is “(URL-OR-PORT . DIR)”. Key (URL-OR-PORT) can be string (URL), integer (port), or<code>default</code> (symbol). The value of <code>default</code> is used when other key does not much. Normally you should have this entry.functionCalled with an argument URL-OR-PORT (integer or string). You can have complex setting using this.</p>
</li>
<li><p><em>variable</em> <code>ein:console-executable</code></p>
<p>IPython executable used for console.Example: <code>&quot;/user/bin/ipython&quot;</code>. Types same as <a href="https://millejoh.github.io/emacs-ipython-notebook/#ein:console-security-dir" target="_blank" rel="noopener"><code>ein:console-security-dir</code></a> are valid.</p>
</li>
<li><p><em>variable</em> <code>ein:console-args</code></p>
<p>Additional argument when using console.WarningSpace-separated string is obsolete now. Use a list of string as value now.Setting to use IPython profile named “YOUR-IPYTHON-PROFILE”:<code>(setq ein:console-args &#39;(&quot;--profile&quot; &quot;YOUR-IPYTHON-PROFILE&quot;))</code>Together with <a href="https://millejoh.github.io/emacs-ipython-notebook/#ein:console-security-dir" target="_blank" rel="noopener"><code>ein:console-security-dir</code></a>, you can open IPython console connecting to a remote kernel.:<code>(setq ein:console-args &#39;(&quot;--ssh&quot; &quot;HOSTNAME&quot;)) (setq ein:console-security-dir &quot;PATH/TO/SECURITY/DIR&quot;)</code>You can setup <a href="https://millejoh.github.io/emacs-ipython-notebook/#ein:console-args" target="_blank" rel="noopener"><code>ein:console-args</code></a> per server basis using alist form:<code>(setq ein:console-args       &#39;((8888 . &#39;(&quot;--profile&quot; &quot;PROFILE&quot;))         (8889 . &#39;(&quot;--ssh&quot; &quot;HOSTNAME&quot;))         (default . &#39;(&quot;--profile&quot; &quot;default&quot;))))</code>If you want to use more complex setting, you can set a function to it:<code>(setq ein:console-args       (lambda (url-or-port) &#39;(&quot;--ssh&quot; &quot;HOSTNAME&quot;)))</code>See also: <a href="https://millejoh.github.io/emacs-ipython-notebook/#ein:console-security-dir" target="_blank" rel="noopener"><code>ein:console-security-dir</code></a>.</p>
</li>
</ul>
<h3 id="Connect"><a href="#Connect" class="headerlink" title="Connect"></a>Connect</h3><ul>
<li><p><em>variable</em> <code>ein:connect-run-command</code></p>
<p><code>%run</code> magic command used for <a href="https://millejoh.github.io/emacs-ipython-notebook/#ein:connect-run-buffer" target="_blank" rel="noopener"><code>ein:connect-run-buffer</code></a>. Types same as <a href="https://millejoh.github.io/emacs-ipython-notebook/#ein:console-security-dir" target="_blank" rel="noopener"><code>ein:console-security-dir</code></a> are valid.</p>
</li>
<li><p><em>variable</em> <code>ein:connect-reload-command</code></p>
<p>Setting for <code>ein:connect-reload-buffer</code>. Same as <a href="https://millejoh.github.io/emacs-ipython-notebook/#ein:connect-run-command" target="_blank" rel="noopener"><code>ein:connect-run-command</code></a>.</p>
</li>
<li><p><em>variable</em> <code>ein:connect-save-before-run</code></p>
<p>Whether the buffer should be saved before <a href="https://millejoh.github.io/emacs-ipython-notebook/#ein:connect-run-buffer" target="_blank" rel="noopener"><code>ein:connect-run-buffer</code></a>.</p>
</li>
<li><p><em>variable</em> <code>ein:propagate-connect</code></p>
<p>Set to <code>t</code> to connect to the notebook after jumping to a buffer.</p>
</li>
<li><p><em>variable</em> <code>ein:connect-aotoexec-lighter</code></p>
<p>String appended to the lighter of <code>ein:connect-mode</code> (<code>ein:c</code>) when auto-execution mode is on. When <code>nil</code>, use the same string as <a href="https://millejoh.github.io/emacs-ipython-notebook/#ein:cell-autoexec-prompt" target="_blank" rel="noopener"><code>ein:cell-autoexec-prompt</code></a>.</p>
</li>
<li><p><em>variable</em> <code>ein:connect-default-notebook</code></p>
<p>Notebook to be connect when <a href="https://millejoh.github.io/emacs-ipython-notebook/#ein:connect-to-default-notebook" target="_blank" rel="noopener"><code>ein:connect-to-default-notebook</code></a> is called.Example setting to connect to “My_Notebook” in the server at port 8888 when opening any buffer in <code>python-mode</code>:<code>(setq ein:connect-default-notebook &quot;8888/My_Notebook&quot;) (add-hook &#39;python-mode-hook &#39;ein:connect-to-default-notebook)</code><a href="https://millejoh.github.io/emacs-ipython-notebook/#ein:connect-default-notebook" target="_blank" rel="noopener"><code>ein:connect-default-notebook</code></a> can also be a function without any argument. This function must return a string (notebook path of the form “URL-OR-PORT/NOTEBOOK-NAME”).As <a href="https://millejoh.github.io/emacs-ipython-notebook/#ein:connect-to-default-notebook" target="_blank" rel="noopener"><code>ein:connect-to-default-notebook</code></a> requires notebook list to be loaded, consider using <a href="https://millejoh.github.io/emacs-ipython-notebook/#ein:notebooklist-load" target="_blank" rel="noopener"><code>ein:notebooklist-load</code></a>to load notebook list if you want to connect to notebook without manually opening notebook list.</p>
</li>
<li><p><em>function</em> <code>ein:connect-to-default-notebook</code></p>
<p>Connect to the default notebook specified by ‘ein:connect-default-notebook’. Set this to ‘python-mode-hook’ to automatically connect any python-mode buffer to the notebook.</p>
</li>
</ul>
<h3 id="Misc-1"><a href="#Misc-1" class="headerlink" title="Misc"></a>Misc</h3><ul>
<li><p><em>variable</em> <code>ein:filename-translations</code></p>
<p>Convert file paths between Emacs and Python process.This value can take these form:alistIts key specifies URL-OR-PORT and value must be a list of two functions: (TO-PYTHON FROM-PYTHON). Key (URL-OR-PORT) can be string (URL), integer (port), or <code>default</code> (symbol). The value of <code>default</code> is used when other key does not much.functionCalled with an argument URL-OR-PORT (integer or string). This function must return a list of two functions: (TO-PYTHON FROM-PYTHON).Here, the functions TO-PYTHON and FROM-PYTHON are defined as:TO-PYTHONA function which converts a file name (returned by <code>buffer-file-name</code>) to the one Python understands.FROM-PYTHONA function which converts a file path returned by Python process to the one Emacs understands.Use <a href="https://millejoh.github.io/emacs-ipython-notebook/#ein:tramp-create-filename-translator" target="_blank" rel="noopener"><code>ein:tramp-create-filename-translator</code></a> to easily generate the pair of TO-PYTHON and FROM-PYTHON.</p>
</li>
<li><p><em>function</em> (<code>ein:tramp-create-filename-translator</code><em>remote-host</em> <em>&amp;optional</em> <em>username</em>)</p>
<p>Generate a pair of TO-PYTHON and FROM-PYTHON for ‘ein:filename-translations’.Usage:<code>(setq ein:filename-translations       ‘((8888          . ,(ein:tramp-create-filename-translator &quot;MY-HOSTNAME&quot;)))) ;; Equivalently: (setq ein:filename-translations       (lambda (url-or-port)         (when (equal url-or-port 8888)           (ein:tramp-create-filename-translator &quot;MY-HOSTNAME&quot;))))</code>This setting assumes that the IPython server which can be connected using the port 8888 in localhost is actually running in the host named MY-HOSTNAME.Adapted from ‘slime-create-filename-translator’.</p>
</li>
<li><p><em>variable</em> <code>ein:query-timeout</code></p>
<p>Default query timeout for HTTP access in millisecond.Setting this to <code>nil</code> means no timeout. If you have <code>curl</code> command line program, it is automatically set to <code>nil</code> as <code>curl</code> is reliable than <code>url-retrieve</code> therefore no need for a workaround (see below).If you do the same operation before the timeout, old operation will NO LONGER be canceled (as it the cookie jar gets clobbered when curl aborts). Instead you will see Race! in debug messages.NoteThis value exists because it looks like <code>url-retrieve</code> occasionally fails to finish (start?) querying. Timeout is used to let user notice that their operation is not finished. It also prevent opening a lot of useless process buffers. You will see them when closing Emacs if there is no timeout.If you know how to fix the problem with <code>url-retrieve</code>, please let me know or send pull request at github! (Related bug report in Emacs bug tracker: <a href="http://debbugs.gnu.org/cgi/bugreport.cgi?bug=11469" target="_blank" rel="noopener">http://debbugs.gnu.org/cgi/bugreport.cgi?bug=11469</a>)</p>
</li>
<li><p><em>function</em> (<code>ein:notebook-jump-to-opened-notebook</code><em>notebook</em>)</p>
<p>List all opened notebook buffers and switch to one that the user selects.</p>
</li>
</ul>
<h2 id="Gotchas-and-caveats"><a href="#Gotchas-and-caveats" class="headerlink" title="Gotchas and caveats"></a>Gotchas and caveats</h2><p>Although EIN mostly works fine, there are some deficits I noticed but have not fixed yet. It seems that they originate from some upstream bugs so there is little I can do in EIN (but I’m not sure – it’s possible that I am misusing the libraries!).</p>
<p>If you know how to fix/workaround them, patches are very welcome.</p>
<h3 id="url-retrieve"><a href="#url-retrieve" class="headerlink" title="url-retrieve"></a><code>url-retrieve</code></h3><p>While using EIN, probably most of the error messages are about server connections. It looks like the problem is in <code>url-retrieve</code>. But in those cases you don’t lose any notebook data and your IPython kernel is fine. You can just type the command again and it will go fine most of the time. For saving notebook, I implemented code to retry when there is an error comes from <code>url-retrieve</code> to make it even safer.</p>
<h3 id="MuMaMo"><a href="#MuMaMo" class="headerlink" title="MuMaMo"></a>MuMaMo</h3><p>When using MuMaMo based notebook mode, you will notice that highlighting outside of the cell input is turned off while you are in the input area. It seems there is a bug in MuMaMo <a href="https://millejoh.github.io/emacs-ipython-notebook/#m3bug" target="_blank" rel="noopener">6</a>.</p>
<p>If you are using smartrep and MuMaMo together, see also the warning in <a href="https://millejoh.github.io/emacs-ipython-notebook/#ein:use-smartrep" target="_blank" rel="noopener"><code>ein:use-smartrep</code></a> document.</p>
<ul>
<li><p><a href="https://millejoh.github.io/emacs-ipython-notebook/#id15" target="_blank" rel="noopener">6</a></p>
<p>See the relevant bug report I posted: <a href="https://bugs.launchpad.net/nxhtml/+bug/1013794" target="_blank" rel="noopener">https://bugs.launchpad.net/nxhtml/+bug/1013794</a></p>
</li>
</ul>
<h3 id="python-mode-el"><a href="#python-mode-el" class="headerlink" title="python-mode.el"></a>python-mode.el</h3><p>Using <a href="https://millejoh.github.io/emacs-ipython-notebook/#python-mode-el" target="_blank" rel="noopener">python-mode.el</a> without fisrt byte-compiling can cause a segfault with the MuMaMo based notebook mode.</p>
<p>Also, <code>mumamo-idle-set-major-mode</code> generates the error message <code>(wrong-type-argument listp python-saved-check-command)</code> time to time, making minibuffer bit noisy while editing notebook. See <a href="https://github.com/millejoh/emacs-ipython-notebook/wiki/Tips" target="_blank" rel="noopener">Tips</a> to fix this problem.</p>
<h2 id="Advanced"><a href="#Advanced" class="headerlink" title="Advanced"></a>Advanced</h2><p>By telling IPython a little bit about Emacs Lisp, you can execute Emacs Lisp from IPython, just like you can execute Javascript in the web client. See <a href="https://github.com/millejoh/emacs-ipython-notebook/blob/master/tools/emacslisp.py" target="_blank" rel="noopener">emacslisp.py</a> for more details.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">In [1]:</span><br><span class="line">%run PATH/TO/emacslisp.py</span><br><span class="line"></span><br><span class="line">In [2]:</span><br><span class="line">EmacsLisp(&apos;(+ 1 2 3)&apos;)</span><br><span class="line">Out [2]:</span><br><span class="line">6</span><br></pre></td></tr></table></figure>
<h2 id="Reporting-issues"><a href="#Reporting-issues" class="headerlink" title="Reporting issues"></a>Reporting issues</h2><p>Please use <code>M-x ein:dev-bug-report-template</code> to write a bug report. It pops up a buffer containing some system information and instruction for bug report.</p>
<h3 id="Logging"><a href="#Logging" class="headerlink" title="Logging"></a>Logging</h3><p>Sometime more information than provided in the <code>*Message*</code> buffer is needed to debug.</p>
<ol>
<li><p>Execute <code>(ein:log-set-level &#39;debug)</code> (e.g., <code>M-: (ein:log-set-level &#39;debug) RET</code>).</p>
</li>
<li><p>Then do some operation which cause the problem.</p>
</li>
<li><p>Go to the log buffer <code>_*ein:log-all*</code> (it starts with a space) and paste the whole buffer to the issue tracker.</p>
<p>Please enclose the log with three backquotes to make the snippet as a code block, like this:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"> </span><br></pre></td></tr></table></figure>
<p>[verbose] Start logging. @#&lt;buffer <em>ein: 8888/NAME</em>&gt;<br>[info] Notebook NAME is ready @#&lt;buffer <em>ein: 8888/NAME</em>&gt;<br>[info] Kernel started: 5e4f74d1-ce91-4e7e-9575-9646adea5172 @#<buffer *scratch*></buffer></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"> </span><br></pre></td></tr></table></figure>
<p>See also: <a href="http://github.github.com/github-flavored-markdown/" target="_blank" rel="noopener">GitHub Flavored Markdown - Introduction</a></p>
<p>If it is too long, you can use paste bin service such as <a href="https://gist.github.com/" target="_blank" rel="noopener">gist</a>.</p>
</li>
</ol>
<h4 id="websocket-el"><a href="#websocket-el" class="headerlink" title="websocket.el"></a>websocket.el</h4><p>websocket.el has its own logging buffer. Sometime it is useful to see this log. To do this:</p>
<ol>
<li><code>(require &#39;ein-dev)</code></li>
<li><code>(setq websocket-debug t)</code> or call <code>ein:dev-start-debug</code>.</li>
<li>Then do the operation which causes the problem.</li>
<li>Go to log buffer using <code>ein:dev-pop-to-debug-shell</code> and <code>ein:dev-pop-to-debug-iopub</code>. These command must be called in the notebook buffer.</li>
</ol>
<h3 id="Debugging"><a href="#Debugging" class="headerlink" title="Debugging"></a>Debugging</h3><p>If you are interested in debugging EIN, you should start by calling the command <code>ein:dev-start-debug</code>. If the bug is websocket related, you may need to run it with a prefix key like this: <code>C-u M-x ein:dev-start-debug RET</code> to get a backtrace. This command sets <code>debug-on-error</code> to <code>t</code> and does some patching to the debugger. This patching is required because printing EWOC objects freezes Emacs otherwise. It also changes log level to report everything the log buffer. You can reset the patch and log level with <code>ein:dev-stop-debug</code>.</p>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://alphaalgorithms.github.io/2019/06/11/elisp-more-complex-functions/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Gabriel">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="DummyHead">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                
                <a href="/2019/06/11/elisp-more-complex-functions/" class="post-title-link" itemprop="url">Intro to elisp 5. A Few More Complex Functions</a>
              
            
          </h2>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2019-06-11 09:20:03 / Modified: 09:23:18" itemprop="dateCreated datePublished" datetime="2019-06-11T09:20:03+08:00">2019-06-11</time>
            

            
              

              
            
          </span>

          

          
            
            
              
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
            
                <span class="post-meta-item-text">Comments: </span>
                <a href="/2019/06/11/elisp-more-complex-functions/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2019/06/11/elisp-more-complex-functions/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>In this chapter, we build on what we have learned in previous chapters by looking at more complex functions. The <code>copy-to-buffer</code> function illustrates use of two <code>save-excursion</code>expressions in one definition, while the <code>insert-buffer</code> function illustrates use of an asterisk in an <code>interactive</code> expression, use of <code>or</code>, and the important distinction between a name and the object to which the name refers.</p>
<ul>
<li><a href="https://www.gnu.org/software/emacs/manual/html_mono/eintr.html#copy_002dto_002dbuffer" target="_blank" rel="noopener">copy-to-buffer</a>: With <code>set-buffer</code>, <code>get-buffer-create</code>.</li>
<li><a href="https://www.gnu.org/software/emacs/manual/html_mono/eintr.html#insert_002dbuffer" target="_blank" rel="noopener">insert-buffer</a>: Read-only, and with <code>or</code>.</li>
<li><a href="https://www.gnu.org/software/emacs/manual/html_mono/eintr.html#beginning_002dof_002dbuffer" target="_blank" rel="noopener">beginning-of-buffer</a>: Shows <code>goto-char</code>, <code>point-min</code>, and <code>push-mark</code>.</li>
<li><a href="https://www.gnu.org/software/emacs/manual/html_mono/eintr.html#Second-Buffer-Related-Review" target="_blank" rel="noopener">Second Buffer Related Review</a></li>
<li><a href="https://www.gnu.org/software/emacs/manual/html_mono/eintr.html#optional-Exercise" target="_blank" rel="noopener">optional Exercise</a></li>
</ul>
<h3 id="5-1-The-Definition-of-copy-to-buffer"><a href="#5-1-The-Definition-of-copy-to-buffer" class="headerlink" title="5.1 The Definition of copy-to-buffer"></a>5.1 The Definition of <code>copy-to-buffer</code></h3><p>After understanding how <code>append-to-buffer</code> works, it is easy to understand <code>copy-to-buffer</code>. This function copies text into a buffer, but instead of adding to the second buffer, it replaces all the previous text in the second buffer.</p>
<p>The body of <code>copy-to-buffer</code> looks like this,</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line">(interactive &quot;BCopy to buffer: \nr&quot;)</span><br><span class="line">(let ((oldbuf (current-buffer)))</span><br><span class="line">  (with-current-buffer (get-buffer-create buffer)</span><br><span class="line">    (barf-if-buffer-read-only)</span><br><span class="line">    (erase-buffer)</span><br><span class="line">    (save-excursion</span><br><span class="line">      (insert-buffer-substring oldbuf start end)))))</span><br></pre></td></tr></table></figure>
<p>The <code>copy-to-buffer</code> function has a simpler <code>interactive</code> expression than <code>append-to-buffer</code>.</p>
<p>The definition then says</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(with-current-buffer (get-buffer-create buffer) ...</span><br></pre></td></tr></table></figure>
<p>First, look at the earliest inner expression; that is evaluated first. That expression starts with <code>get-buffer-create buffer</code>. The function tells the computer to use the buffer with the name specified as the one to which you are copying, or if such a buffer does not exist, to create it. Then, the <code>with-current-buffer</code> function evaluates its body with that buffer temporarily current.</p>
<p>(This demonstrates another way to shift the computer’s attention but not the user’s. The <code>append-to-buffer</code> function showed how to do the same with <code>save-excursion</code> and <code>set-buffer</code>. <code>with-current-buffer</code> is a newer, and arguably easier, mechanism.)</p>
<p>The <code>barf-if-buffer-read-only</code> function sends you an error message saying the buffer is read-only if you cannot modify it.</p>
<p>The next line has the <code>erase-buffer</code> function as its sole contents. That function erases the buffer.</p>
<p>Finally, the last two lines contain the <code>save-excursion</code> expression with <code>insert-buffer-substring</code> as its body. The <code>insert-buffer-substring</code> expression copies the text from the buffer you are in (and you have not seen the computer shift its attention, so you don’t know that that buffer is now called <code>oldbuf</code>).</p>
<p>Incidentally, this is what is meant by “replacement”. To replace text, Emacs erases the previous text and then inserts new text.</p>
<p>In outline, the body of <code>copy-to-buffer</code> looks like this:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">(let (bind-oldbuf-to-value-of-current-buffer)</span><br><span class="line">    (with-the-buffer-you-are-copying-to</span><br><span class="line">      (but-do-not-erase-or-copy-to-a-read-only-buffer)</span><br><span class="line">      (erase-buffer)</span><br><span class="line">      (save-excursion</span><br><span class="line">        insert-substring-from-oldbuf-into-buffer)))</span><br></pre></td></tr></table></figure>
<h3 id="5-2-The-Definition-of-insert-buffer"><a href="#5-2-The-Definition-of-insert-buffer" class="headerlink" title="5.2 The Definition of insert-buffer"></a>5.2 The Definition of <code>insert-buffer</code></h3><p><code>insert-buffer</code> is yet another buffer-related function. This command copies another buffer <em>into</em> the current buffer. It is the reverse of <code>append-to-buffer</code> or <code>copy-to-buffer</code>, since they copy a region of text <em>from</em> the current buffer to another buffer.</p>
<p>Here is a discussion based on the original code. The code was simplified in 2003 and is harder to understand.</p>
<p>(See <a href="https://www.gnu.org/software/emacs/manual/html_mono/eintr.html#New-insert_002dbuffer" target="_blank" rel="noopener">New Body for <code>insert-buffer</code></a>, to see a discussion of the new body.)</p>
<p>In addition, this code illustrates the use of <code>interactive</code> with a buffer that might be read-only and the important distinction between the name of an object and the object actually referred to.</p>
<ul>
<li><a href="https://www.gnu.org/software/emacs/manual/html_mono/eintr.html#insert_002dbuffer-code" target="_blank" rel="noopener">insert-buffer code</a></li>
<li><a href="https://www.gnu.org/software/emacs/manual/html_mono/eintr.html#insert_002dbuffer-interactive" target="_blank" rel="noopener">insert-buffer interactive</a>: When you can read, but not write.</li>
<li><a href="https://www.gnu.org/software/emacs/manual/html_mono/eintr.html#insert_002dbuffer-body" target="_blank" rel="noopener">insert-buffer body</a>: The body has an <code>or</code> and a <code>let</code>.</li>
<li><a href="https://www.gnu.org/software/emacs/manual/html_mono/eintr.html#if-_0026-or" target="_blank" rel="noopener">if &amp; or</a>: Using an <code>if</code> instead of an <code>or</code>.</li>
<li><a href="https://www.gnu.org/software/emacs/manual/html_mono/eintr.html#Insert-or" target="_blank" rel="noopener">Insert or</a>: How the <code>or</code> expression works.</li>
<li><a href="https://www.gnu.org/software/emacs/manual/html_mono/eintr.html#Insert-let" target="_blank" rel="noopener">Insert let</a>: Two <code>save-excursion</code> expressions.</li>
<li><a href="https://www.gnu.org/software/emacs/manual/html_mono/eintr.html#New-insert_002dbuffer" target="_blank" rel="noopener">New insert-buffer</a></li>
</ul>
<h4 id="The-Code-for-insert-buffer"><a href="#The-Code-for-insert-buffer" class="headerlink" title="The Code for insert-buffer"></a>The Code for <code>insert-buffer</code></h4><p>Here is the earlier code:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">(defun insert-buffer (buffer)</span><br><span class="line">  &quot;Insert after point the contents of BUFFER.</span><br><span class="line">Puts mark after the inserted text.</span><br><span class="line">BUFFER may be a buffer or a buffer name.&quot;</span><br><span class="line">  (interactive &quot;*bInsert buffer: &quot;)</span><br><span class="line">  (or (bufferp buffer)</span><br><span class="line">      (setq buffer (get-buffer buffer)))</span><br><span class="line">  (let (start end newmark)</span><br><span class="line">    (save-excursion</span><br><span class="line">      (save-excursion</span><br><span class="line">        (set-buffer buffer)</span><br><span class="line">        (setq start (point-min) end (point-max)))</span><br><span class="line">      (insert-buffer-substring buffer start end)</span><br><span class="line">      (setq newmark (point)))</span><br><span class="line">    (push-mark newmark)))</span><br></pre></td></tr></table></figure>
<p>As with other function definitions, you can use a template to see an outline of the function:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">(defun insert-buffer (buffer)</span><br><span class="line">  &quot;documentation...&quot;</span><br><span class="line">  (interactive &quot;*bInsert buffer: &quot;)</span><br><span class="line">  body...)</span><br></pre></td></tr></table></figure>
<h4 id="5-2-1-The-Interactive-Expression-in-insert-buffer"><a href="#5-2-1-The-Interactive-Expression-in-insert-buffer" class="headerlink" title="5.2.1 The Interactive Expression in insert-buffer"></a>5.2.1 The Interactive Expression in <code>insert-buffer</code></h4><p>In <code>insert-buffer</code>, the argument to the <code>interactive</code> declaration has two parts, an asterisk, ‘*’, and ‘bInsert buffer: ’.</p>
<ul>
<li><a href="https://www.gnu.org/software/emacs/manual/html_mono/eintr.html#Read_002donly-buffer" target="_blank" rel="noopener">Read-only buffer</a>: When a buffer cannot be modified.</li>
<li><a href="https://www.gnu.org/software/emacs/manual/html_mono/eintr.html#b-for-interactive" target="_blank" rel="noopener">b for interactive</a>: An existing buffer or else its name.</li>
</ul>
<h5 id="A-Read-only-Buffer"><a href="#A-Read-only-Buffer" class="headerlink" title="A Read-only Buffer"></a>A Read-only Buffer</h5><p>The asterisk is for the situation when the current buffer is a read-only buffer—a buffer that cannot be modified. If <code>insert-buffer</code> is called when the current buffer is read-only, a message to this effect is printed in the echo area and the terminal may beep or blink at you; you will not be permitted to insert anything into current buffer. The asterisk does not need to be followed by a newline to separate it from the next argument.</p>
<h5 id="‘b’-in-an-Interactive-Expression"><a href="#‘b’-in-an-Interactive-Expression" class="headerlink" title="‘b’ in an Interactive Expression"></a>‘b’ in an Interactive Expression</h5><p>The next argument in the interactive expression starts with a lower case ‘b’. (This is different from the code for <code>append-to-buffer</code>, which uses an upper-case ‘B’. See <a href="https://www.gnu.org/software/emacs/manual/html_mono/eintr.html#append_002dto_002dbuffer" target="_blank" rel="noopener">The Definition of <code>append-to-buffer</code></a>.) The lower-case ‘b’ tells the Lisp interpreter that the argument for <code>insert-buffer</code> should be an existing buffer or else its name. (The upper-case ‘B’ option provides for the possibility that the buffer does not exist.) Emacs will prompt you for the name of the buffer, offering you a default buffer, with name completion enabled. If the buffer does not exist, you receive a message that says “No match”; your terminal may beep at you as well.</p>
<p>The new and simplified code generates a list for <code>interactive</code>. It uses the <code>barf-if-buffer-read-only</code> and <code>read-buffer</code> functions with which we are already familiar and the <code>progn</code> special form with which we are not. (It will be described later.)</p>
<h4 id="5-2-2-The-Body-of-the-insert-buffer-Function"><a href="#5-2-2-The-Body-of-the-insert-buffer-Function" class="headerlink" title="5.2.2 The Body of the insert-buffer Function"></a>5.2.2 The Body of the <code>insert-buffer</code> Function</h4><p>The body of the <code>insert-buffer</code> function has two major parts: an <code>or</code> expression and a <code>let</code> expression. The purpose of the <code>or</code> expression is to ensure that the argument <code>buffer</code> is bound to a buffer and not just the name of a buffer. The body of the <code>let</code> expression contains the code which copies the other buffer into the current buffer.</p>
<p>In outline, the two expressions fit into the <code>insert-buffer</code> function like this:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">(defun insert-buffer (buffer)</span><br><span class="line">  &quot;documentation...&quot;</span><br><span class="line">  (interactive &quot;*bInsert buffer: &quot;)</span><br><span class="line">  (or ...</span><br><span class="line">      ...</span><br><span class="line">  (let (varlist)</span><br><span class="line">      body-of-let... )</span><br></pre></td></tr></table></figure>
<p>To understand how the <code>or</code> expression ensures that the argument <code>buffer</code> is bound to a buffer and not to the name of a buffer, it is first necessary to understand the <code>or</code> function.</p>
<p>Before doing this, let me rewrite this part of the function using <code>if</code> so that you can see what is done in a manner that will be familiar.</p>
<h4 id="5-2-3-insert-buffer-With-an-if-Instead-of-an-or"><a href="#5-2-3-insert-buffer-With-an-if-Instead-of-an-or" class="headerlink" title="5.2.3 insert-buffer With an if Instead of an or"></a>5.2.3 <code>insert-buffer</code> With an <code>if</code> Instead of an <code>or</code></h4><p>The job to be done is to make sure the value of <code>buffer</code> is a buffer itself and not the name of a buffer. If the value is the name, then the buffer itself must be got.</p>
<p>You can imagine yourself at a conference where an usher is wandering around holding a list with your name on it and looking for you: the usher is bound to your name, not to you; but when the usher finds you and takes your arm, the usher becomes bound to you.</p>
<p>In Lisp, you might describe this situation like this:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">(if (not (holding-on-to-guest))</span><br><span class="line">    (find-and-take-arm-of-guest))</span><br></pre></td></tr></table></figure>
<p>We want to do the same thing with a buffer—if we do not have the buffer itself, we want to get it.</p>
<p>Using a predicate called <code>bufferp</code> that tells us whether we have a buffer (rather than its name), we can write the code like this:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">(if (not (bufferp buffer))              ; if-part</span><br><span class="line">    (setq buffer (get-buffer buffer)))  ; then-part</span><br></pre></td></tr></table></figure>
<p>Here, the true-or-false-test of the <code>if</code> expression is <code>(not (bufferp buffer))</code>; and the then-part is the expression <code>(setq buffer (get-buffer buffer))</code>.</p>
<p>In the test, the function <code>bufferp</code> returns true if its argument is a buffer—but false if its argument is the name of the buffer. (The last character of the function name <code>bufferp</code> is the character ‘p’; as we saw earlier, such use of ‘p’ is a convention that indicates that the function is a predicate, which is a term that means that the function will determine whether some property is true or false. See <a href="https://www.gnu.org/software/emacs/manual/html_mono/eintr.html#Wrong-Type-of-Argument" target="_blank" rel="noopener">Using the Wrong Type Object as an Argument</a>.)</p>
<p>The function <code>not</code> precedes the expression <code>(bufferp buffer)</code>, so the true-or-false-test looks like this:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(not (bufferp buffer))</span><br></pre></td></tr></table></figure>
<p><code>not</code> is a function that returns true if its argument is false and false if its argument is true. So if <code>(bufferp buffer)</code> returns true, the <code>not</code> expression returns false and vice versa.</p>
<p>Using this test, the <code>if</code> expression works as follows: when the value of the variable <code>buffer</code> is actually a buffer rather than its name, the true-or-false-test returns false and the <code>if</code>expression does not evaluate the then-part. This is fine, since we do not need to do anything to the variable <code>buffer</code> if it really is a buffer.</p>
<p>On the other hand, when the value of <code>buffer</code> is not a buffer itself, but the name of a buffer, the true-or-false-test returns true and the then-part of the expression is evaluated. In this case, the then-part is <code>(setq buffer (get-buffer buffer))</code>. This expression uses the <code>get-buffer</code> function to return an actual buffer itself, given its name. The <code>setq</code> then sets the variable <code>buffer</code> to the value of the buffer itself, replacing its previous value (which was the name of the buffer).</p>
<h4 id="5-2-4-The-or-in-the-Body"><a href="#5-2-4-The-or-in-the-Body" class="headerlink" title="5.2.4 The or in the Body"></a>5.2.4 The <code>or</code> in the Body</h4><p>The purpose of the <code>or</code> expression in the <code>insert-buffer</code> function is to ensure that the argument <code>buffer</code> is bound to a buffer and not just to the name of a buffer. The previous section shows how the job could have been done using an <code>if</code> expression. However, the <code>insert-buffer</code> function actually uses <code>or</code>. To understand this, it is necessary to understand how <code>or</code>works.</p>
<p>An <code>or</code> function can have any number of arguments. It evaluates each argument in turn and returns the value of the first of its arguments that is not <code>nil</code>. Also, and this is a crucial feature of <code>or</code>, it does not evaluate any subsequent arguments after returning the first non-<code>nil</code> value.</p>
<p>The <code>or</code> expression looks like this:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">(or (bufferp buffer)</span><br><span class="line">    (setq buffer (get-buffer buffer)))</span><br></pre></td></tr></table></figure>
<p>The first argument to <code>or</code> is the expression <code>(bufferp buffer)</code>. This expression returns true (a non-<code>nil</code> value) if the buffer is actually a buffer, and not just the name of a buffer. In the <code>or</code> expression, if this is the case, the <code>or</code> expression returns this true value and does not evaluate the next expression—and this is fine with us, since we do not want to do anything to the value of <code>buffer</code> if it really is a buffer.</p>
<p>On the other hand, if the value of <code>(bufferp buffer)</code> is <code>nil</code>, which it will be if the value of <code>buffer</code> is the name of a buffer, the Lisp interpreter evaluates the next element of the <code>or</code>expression. This is the expression <code>(setq buffer (get-buffer buffer))</code>. This expression returns a non-<code>nil</code> value, which is the value to which it sets the variable <code>buffer</code>—and this value is a buffer itself, not the name of a buffer.</p>
<p>The result of all this is that the symbol <code>buffer</code> is always bound to a buffer itself rather than to the name of a buffer. All this is necessary because the <code>set-buffer</code> function in a following line only works with a buffer itself, not with the name to a buffer.</p>
<p>Incidentally, using <code>or</code>, the situation with the usher would be written like this:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(or (holding-on-to-guest) (find-and-take-arm-of-guest))</span><br></pre></td></tr></table></figure>
<h4 id="5-2-5-The-let-Expression-in-insert-buffer"><a href="#5-2-5-The-let-Expression-in-insert-buffer" class="headerlink" title="5.2.5 The let Expression in insert-buffer"></a>5.2.5 The <code>let</code> Expression in <code>insert-buffer</code></h4><p>After ensuring that the variable <code>buffer</code> refers to a buffer itself and not just to the name of a buffer, the <code>insert-buffer function</code> continues with a <code>let</code> expression. This specifies three local variables, <code>start</code>, <code>end</code>, and <code>newmark</code> and binds them to the initial value <code>nil</code>. These variables are used inside the remainder of the <code>let</code> and temporarily hide any other occurrence of variables of the same name in Emacs until the end of the <code>let</code>.</p>
<p>The body of the <code>let</code> contains two <code>save-excursion</code> expressions. First, we will look at the inner <code>save-excursion</code> expression in detail. The expression looks like this:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">(save-excursion</span><br><span class="line">  (set-buffer buffer)</span><br><span class="line">  (setq start (point-min) end (point-max)))</span><br></pre></td></tr></table></figure>
<p>The expression <code>(set-buffer buffer)</code> changes Emacs’s attention from the current buffer to the one from which the text will copied. In that buffer, the variables <code>start</code> and <code>end</code> are set to the beginning and end of the buffer, using the commands <code>point-min</code> and <code>point-max</code>. Note that we have here an illustration of how <code>setq</code> is able to set two variables in the same expression. The first argument of <code>setq</code> is set to the value of its second, and its third argument is set to the value of its fourth.</p>
<p>After the body of the inner <code>save-excursion</code> is evaluated, the <code>save-excursion</code> restores the original buffer, but <code>start</code> and <code>end</code> remain set to the values of the beginning and end of the buffer from which the text will be copied.</p>
<p>The outer <code>save-excursion</code> expression looks like this:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">(save-excursion</span><br><span class="line">  (inner-save-excursion-expression</span><br><span class="line">     (go-to-new-buffer-and-set-start-and-end)</span><br><span class="line">  (insert-buffer-substring buffer start end)</span><br><span class="line">  (setq newmark (point)))</span><br></pre></td></tr></table></figure>
<p>The <code>insert-buffer-substring</code> function copies the text <em>into</em> the current buffer <em>from</em> the region indicated by <code>start</code> and <code>end</code> in <code>buffer</code>. Since the whole of the second buffer lies between <code>start</code> and <code>end</code>, the whole of the second buffer is copied into the buffer you are editing. Next, the value of point, which will be at the end of the inserted text, is recorded in the variable <code>newmark</code>.</p>
<p>After the body of the outer <code>save-excursion</code> is evaluated, point is relocated to its original place.</p>
<p>However, it is convenient to locate a mark at the end of the newly inserted text and locate point at its beginning. The <code>newmark</code> variable records the end of the inserted text. In the last line of the <code>let</code> expression, the <code>(push-mark newmark)</code> expression function sets a mark to this location. (The previous location of the mark is still accessible; it is recorded on the mark ring and you can go back to it with C-u C-<spc>.) Meanwhile, point is located at the beginning of the inserted text, which is where it was before you called the insert function, the position of which was saved by the first <code>save-excursion</code>.</spc></p>
<p>The whole <code>let</code> expression looks like this:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">(let (start end newmark)</span><br><span class="line">  (save-excursion</span><br><span class="line">    (save-excursion</span><br><span class="line">      (set-buffer buffer)</span><br><span class="line">      (setq start (point-min) end (point-max)))</span><br><span class="line">    (insert-buffer-substring buffer start end)</span><br><span class="line">    (setq newmark (point)))</span><br><span class="line">  (push-mark newmark))</span><br></pre></td></tr></table></figure>
<p>Like the <code>append-to-buffer</code> function, the <code>insert-buffer</code> function uses <code>let</code>, <code>save-excursion</code>, and <code>set-buffer</code>. In addition, the function illustrates one way to use <code>or</code>. All these functions are building blocks that we will find and use again and again.</p>
<h4 id="5-2-6-New-Body-for-insert-buffer"><a href="#5-2-6-New-Body-for-insert-buffer" class="headerlink" title="5.2.6 New Body for insert-buffer"></a>5.2.6 New Body for <code>insert-buffer</code></h4><p>The body in the GNU Emacs 22 version is more confusing than the original.</p>
<p>It consists of two expressions,</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">(push-mark</span><br><span class="line"> (save-excursion</span><br><span class="line">   (insert-buffer-substring (get-buffer buffer))</span><br><span class="line">   (point)))</span><br><span class="line">     </span><br><span class="line"> nil</span><br></pre></td></tr></table></figure>
<p>except, and this is what confuses novices, very important work is done inside the <code>push-mark</code> expression.</p>
<p>The <code>get-buffer</code> function returns a buffer with the name provided. You will note that the function is <em>not</em> called <code>get-buffer-create</code>; it does not create a buffer if one does not already exist. The buffer returned by <code>get-buffer</code>, an existing buffer, is passed to <code>insert-buffer-substring</code>, which inserts the whole of the buffer (since you did not specify anything else).</p>
<p>The location into which the buffer is inserted is recorded by <code>push-mark</code>. Then the function returns <code>nil</code>, the value of its last command. Put another way, the <code>insert-buffer</code> function exists only to produce a side effect, inserting another buffer, not to return any value.</p>
<h3 id="5-3-Complete-Definition-of-beginning-of-buffer"><a href="#5-3-Complete-Definition-of-beginning-of-buffer" class="headerlink" title="5.3 Complete Definition of beginning-of-buffer"></a>5.3 Complete Definition of <code>beginning-of-buffer</code></h3><p>The basic structure of the <code>beginning-of-buffer</code> function has already been discussed. (See <a href="https://www.gnu.org/software/emacs/manual/html_mono/eintr.html#simplified_002dbeginning_002dof_002dbuffer" target="_blank" rel="noopener">A Simplified <code>beginning-of-buffer</code> Definition</a>.) This section describes the complex part of the definition.</p>
<p>As previously described, when invoked without an argument, <code>beginning-of-buffer</code> moves the cursor to the beginning of the buffer (in truth, the beginning of the accessible portion of the buffer), leaving the mark at the previous position. However, when the command is invoked with a number between one and ten, the function considers that number to be a fraction of the length of the buffer, measured in tenths, and Emacs moves the cursor that fraction of the way from the beginning of the buffer. Thus, you can either call this function with the key command M-&lt;, which will move the cursor to the beginning of the buffer, or with a key command such as C-u 7 M-&lt; which will move the cursor to a point 70% of the way through the buffer. If a number bigger than ten is used for the argument, it moves to the end of the buffer.</p>
<p>The <code>beginning-of-buffer</code> function can be called with or without an argument. The use of the argument is optional.</p>
<ul>
<li><a href="https://www.gnu.org/software/emacs/manual/html_mono/eintr.html#Optional-Arguments" target="_blank" rel="noopener">Optional Arguments</a></li>
<li><a href="https://www.gnu.org/software/emacs/manual/html_mono/eintr.html#beginning_002dof_002dbuffer-opt-arg" target="_blank" rel="noopener">beginning-of-buffer opt arg</a>: Example with optional argument.</li>
<li><a href="https://www.gnu.org/software/emacs/manual/html_mono/eintr.html#beginning_002dof_002dbuffer-complete" target="_blank" rel="noopener">beginning-of-buffer complete</a></li>
</ul>
<h4 id="5-3-1-Optional-Arguments"><a href="#5-3-1-Optional-Arguments" class="headerlink" title="5.3.1 Optional Arguments"></a>5.3.1 Optional Arguments</h4><p>Unless told otherwise, Lisp expects that a function with an argument in its function definition will be called with a value for that argument. If that does not happen, you get an error and a message that says ‘Wrong number of arguments’.</p>
<p>However, optional arguments are a feature of Lisp: a particular keyword is used to tell the Lisp interpreter that an argument is optional. The keyword is <code>&amp;optional</code>. (The ‘&amp;’ in front of ‘optional’ is part of the keyword.) In a function definition, if an argument follows the keyword <code>&amp;optional</code>, no value need be passed to that argument when the function is called.</p>
<p>The first line of the function definition of <code>beginning-of-buffer</code> therefore looks like this:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(defun beginning-of-buffer (&amp;optional arg)</span><br></pre></td></tr></table></figure>
<p>In outline, the whole function looks like this:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">(defun beginning-of-buffer (&amp;optional arg)</span><br><span class="line">  &quot;documentation...&quot;</span><br><span class="line">  (interactive &quot;P&quot;)</span><br><span class="line">  (or (is-the-argument-a-cons-cell arg)</span><br><span class="line">      (and are-both-transient-mark-mode-and-mark-active-true)</span><br><span class="line">      (push-mark))</span><br><span class="line">  (let (determine-size-and-set-it)</span><br><span class="line">  (goto-char</span><br><span class="line">    (if-there-is-an-argument</span><br><span class="line">        figure-out-where-to-go</span><br><span class="line">      else-go-to</span><br><span class="line">      (point-min))))</span><br><span class="line">   do-nicety</span><br></pre></td></tr></table></figure>
<p>The function is similar to the <code>simplified-beginning-of-buffer</code> function except that the <code>interactive</code> expression has <code>&quot;P&quot;</code> as an argument and the <code>goto-char</code> function is followed by an if-then-else expression that figures out where to put the cursor if there is an argument that is not a cons cell.</p>
<p>(Since I do not explain a cons cell for many more chapters, please consider ignoring the function <code>consp</code>. See <a href="https://www.gnu.org/software/emacs/manual/html_mono/eintr.html#List-Implementation" target="_blank" rel="noopener">How Lists are Implemented</a>, and <a href="https://www.gnu.org/software/emacs/manual/html_mono/elisp.html#Cons-Cell-Type" target="_blank" rel="noopener">Cons Cell and List Types</a>.)</p>
<p>The <code>&quot;P&quot;</code> in the <code>interactive</code> expression tells Emacs to pass a prefix argument, if there is one, to the function in raw form. A prefix argument is made by typing the <meta> key followed by a number, or by typing C-u and then a number. (If you don’t type a number, C-u defaults to a cons cell with a 4. A lowercase <code>&quot;p&quot;</code> in the <code>interactive</code> expression causes the function to convert a prefix arg to a number.)</p>
<p>The true-or-false-test of the <code>if</code> expression looks complex, but it is not: it checks whether <code>arg</code> has a value that is not <code>nil</code> and whether it is a cons cell. (That is what <code>consp</code> does; it checks whether its argument is a cons cell.) If <code>arg</code> has a value that is not <code>nil</code> (and is not a cons cell), which will be the case if <code>beginning-of-buffer</code> is called with a numeric argument, then this true-or-false-test will return true and the then-part of the <code>if</code> expression will be evaluated. On the other hand, if <code>beginning-of-buffer</code> is not called with an argument, the value of <code>arg</code> will be <code>nil</code> and the else-part of the <code>if</code> expression will be evaluated. The else-part is simply <code>point-min</code>, and when this is the outcome, the whole <code>goto-char</code> expression is <code>(goto-char (point-min))</code>, which is how we saw the <code>beginning-of-buffer</code> function in its simplified form.</p>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://alphaalgorithms.github.io/2019/06/11/elisp-buffer-functions/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Gabriel">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="DummyHead">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                
                <a href="/2019/06/11/elisp-buffer-functions/" class="post-title-link" itemprop="url">Intro elisp 4. A Few Buffer-Related Functions</a>
              
            
          </h2>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2019-06-11 09:17:58 / Modified: 09:30:34" itemprop="dateCreated datePublished" datetime="2019-06-11T09:17:58+08:00">2019-06-11</time>
            

            
              

              
            
          </span>

          

          
            
            
              
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
            
                <span class="post-meta-item-text">Comments: </span>
                <a href="/2019/06/11/elisp-buffer-functions/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2019/06/11/elisp-buffer-functions/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>In this chapter we study in detail several of the functions used in GNU Emacs. This is called a “walk-through”. These functions are used as examples of Lisp code, but are not imaginary examples; with the exception of the first, simplified function definition, these functions show the actual code used in GNU Emacs. You can learn a great deal from these definitions. The functions described here are all related to buffers. Later, we will study other functions.</p>
<ul>
<li><a href="https://www.gnu.org/software/emacs/manual/html_mono/eintr.html#Finding-More" target="_blank" rel="noopener">Finding More</a>: How to find more information.</li>
<li><a href="https://www.gnu.org/software/emacs/manual/html_mono/eintr.html#simplified_002dbeginning_002dof_002dbuffer" target="_blank" rel="noopener">simplified-beginning-of-buffer</a>: Shows <code>goto-char</code>, <code>point-min</code>, and <code>push-mark</code>.</li>
<li><a href="https://www.gnu.org/software/emacs/manual/html_mono/eintr.html#mark_002dwhole_002dbuffer" target="_blank" rel="noopener">mark-whole-buffer</a>: Almost the same as <code>beginning-of-buffer</code>.</li>
<li><a href="https://www.gnu.org/software/emacs/manual/html_mono/eintr.html#append_002dto_002dbuffer" target="_blank" rel="noopener">append-to-buffer</a>: Uses <code>save-excursion</code> and <code>insert-buffer-substring</code>.</li>
<li><a href="https://www.gnu.org/software/emacs/manual/html_mono/eintr.html#Buffer-Related-Review" target="_blank" rel="noopener">Buffer Related Review</a>: Review.</li>
<li><a href="https://www.gnu.org/software/emacs/manual/html_mono/eintr.html#Buffer-Exercises" target="_blank" rel="noopener">Buffer Exercises</a></li>
</ul>
<h3 id="4-1-Finding-More-Information"><a href="#4-1-Finding-More-Information" class="headerlink" title="4.1 Finding More Information"></a>4.1 Finding More Information</h3><p>In this walk-through, I will describe each new function as we come to it, sometimes in detail and sometimes briefly. If you are interested, you can get the full documentation of any Emacs Lisp function at any time by typing C-h f and then the name of the function (and then <ret>). Similarly, you can get the full documentation for a variable by typing C-h vand then the name of the variable (and then <ret>).</ret></ret></p>
<p>Also, <code>describe-function</code> will tell you the location of the function definition.</p>
<p>Put point into the name of the file that contains the function and press the <ret> key. In this case, <ret> means <code>push-button</code> rather than “return” or “enter”. Emacs will take you directly to the function definition.</ret></ret></p>
<p>More generally, if you want to see a function in its original source file, you can use the <code>xref-find-definitions</code> function to jump to it. <code>xref-find-definitions</code> works with a wide variety of languages, not just Lisp, and C, and it works with non-programming text as well. For example, <code>xref-find-definitions</code> will jump to the various nodes in the Texinfo source file of this document (provided that you’ve run the etags utility to record all the nodes in the manuals that come with Emacs; see <a href="https://www.gnu.org/software/emacs/manual/html_mono/emacs.html#Create-Tags-Table" target="_blank" rel="noopener">Create Tags Table</a>).</p>
<p>To use the <code>xref-find-definitions</code> command, type M-. (i.e., press the period key while holding down the <meta> key, or else type the <esc> key and then type the period key), and then, at the prompt, type in the name of the function whose source code you want to see, such as <code>mark-whole-buffer</code>, and then type <ret>. (If the command doesn’t prompt, invoke it with an argument: C-u M-.; see <a href="https://www.gnu.org/software/emacs/manual/html_mono/eintr.html#Interactive-Options" target="_blank" rel="noopener">Interactive Options</a>.) Emacs will switch buffers and display the source code for the function on your screen<a href="https://www.gnu.org/software/emacs/manual/html_mono/eintr.html#fn-10" target="_blank" rel="noopener">10</a>. To switch back to your current buffer, type M-, or C-x b <ret>. (On some keyboards, the <meta> key is labeled <alt>.)</alt></ret></ret></esc></p>
<p>Incidentally, the files that contain Lisp code are conventionally called libraries. The metaphor is derived from that of a specialized library, such as a law library or an engineering library, rather than a general library. Each library, or file, contains functions that relate to a particular topic or activity, such as abbrev.el for handling abbreviations and other typing shortcuts, and help.el for help. (Sometimes several libraries provide code for a single activity, as the various rmail… files provide code for reading electronic mail.) In The GNU Emacs Manual, you will see sentences such as “The C-h p command lets you search the standard Emacs Lisp libraries by topic keywords.”</p>
<h3 id="4-2-A-Simplified-beginning-of-buffer-Definition"><a href="#4-2-A-Simplified-beginning-of-buffer-Definition" class="headerlink" title="4.2 A Simplified beginning-of-buffer Definition"></a>4.2 A Simplified <code>beginning-of-buffer</code> Definition</h3><p>The <code>beginning-of-buffer</code> command is a good function to start with since you are likely to be familiar with it and it is easy to understand. Used as an interactive command, <code>beginning-of-buffer</code> moves the cursor to the beginning of the buffer, leaving the mark at the previous position. It is generally bound to M-&lt;.</p>
<p>In this section, we will discuss a shortened version of the function that shows how it is most frequently used. This shortened function works as written, but it does not contain the code for a complex option. In another section, we will describe the entire function. (See <a href="https://www.gnu.org/software/emacs/manual/html_mono/eintr.html#beginning_002dof_002dbuffer" target="_blank" rel="noopener">Complete Definition of <code>beginning-of-buffer</code></a>.)</p>
<p>Before looking at the code, let’s consider what the function definition has to contain: it must include an expression that makes the function interactive so it can be called by typing M-x beginning-of-buffer or by typing a keychord such as M-&lt;; it must include code to leave a mark at the original position in the buffer; and it must include code to move the cursor to the beginning of the buffer.</p>
<p>Here is the complete text of the shortened version of the function:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">(defun simplified-beginning-of-buffer ()</span><br><span class="line">  &quot;Move point to the beginning of the buffer;</span><br><span class="line">leave mark at previous position.&quot;</span><br><span class="line">  (interactive)</span><br><span class="line">  (push-mark)</span><br><span class="line">  (goto-char (point-min)))</span><br></pre></td></tr></table></figure>
<p>Like all function definitions, this definition has five parts following the macro <code>defun</code>:</p>
<ol>
<li>The name: in this example, <code>simplified-beginning-of-buffer</code>.</li>
<li>A list of the arguments: in this example, an empty list, <code>()</code>,</li>
<li>The documentation string.</li>
<li>The interactive expression.</li>
<li>The body.</li>
</ol>
<p>In this function definition, the argument list is empty; this means that this function does not require any arguments. (When we look at the definition for the complete function, we will see that it may be passed an optional argument.)</p>
<p>The interactive expression tells Emacs that the function is intended to be used interactively. In this example, <code>interactive</code> does not have an argument because <code>simplified-beginning-of-buffer</code> does not require one.</p>
<p>The body of the function consists of the two lines:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">(push-mark)</span><br><span class="line">(goto-char (point-min))</span><br></pre></td></tr></table></figure>
<p>The first of these lines is the expression, <code>(push-mark)</code>. When this expression is evaluated by the Lisp interpreter, it sets a mark at the current position of the cursor, wherever that may be. The position of this mark is saved in the mark ring.</p>
<p>The next line is <code>(goto-char (point-min))</code>. This expression jumps the cursor to the minimum point in the buffer, that is, to the beginning of the buffer (or to the beginning of the accessible portion of the buffer if it is narrowed. See <a href="https://www.gnu.org/software/emacs/manual/html_mono/eintr.html#Narrowing-_0026-Widening" target="_blank" rel="noopener">Narrowing and Widening</a>.)</p>
<p>The <code>push-mark</code> command sets a mark at the place where the cursor was located before it was moved to the beginning of the buffer by the <code>(goto-char (point-min))</code> expression. Consequently, you can, if you wish, go back to where you were originally by typing C-x C-x.</p>
<p>That is all there is to the function definition!</p>
<p>When you are reading code such as this and come upon an unfamiliar function, such as <code>goto-char</code>, you can find out what it does by using the <code>describe-function</code> command. To use this command, type C-h f and then type in the name of the function and press <ret>. The <code>describe-function</code> command will print the function’s documentation string in a <em>Help</em> window. For example, the documentation for <code>goto-char</code> is:</ret></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Set point to POSITION, a number or marker.</span><br><span class="line">Beginning of buffer is position (point-min), end is (point-max).</span><br></pre></td></tr></table></figure>
<p>The function’s one argument is the desired position.</p>
<p>(The prompt for <code>describe-function</code> will offer you the symbol under or preceding the cursor, so you can save typing by positioning the cursor right over or after the function and then typing C-h f <ret>.)</ret></p>
<p>The <code>end-of-buffer</code> function definition is written in the same way as the <code>beginning-of-buffer</code> definition except that the body of the function contains the expression <code>(goto-char (point-max))</code> in place of <code>(goto-char (point-min))</code>.</p>
<h3 id="4-3-The-Definition-of-mark-whole-buffer"><a href="#4-3-The-Definition-of-mark-whole-buffer" class="headerlink" title="4.3 The Definition of mark-whole-buffer"></a>4.3 The Definition of <code>mark-whole-buffer</code></h3><p>The <code>mark-whole-buffer</code> function is no harder to understand than the <code>simplified-beginning-of-buffer</code> function. In this case, however, we will look at the complete function, not a shortened version.</p>
<p>The <code>mark-whole-buffer</code> function is not as commonly used as the <code>beginning-of-buffer</code> function, but is useful nonetheless: it marks a whole buffer as a region by putting point at the beginning and a mark at the end of the buffer. It is generally bound to C-x h.</p>
<ul>
<li><a href="https://www.gnu.org/software/emacs/manual/html_mono/eintr.html#mark_002dwhole_002dbuffer-overview" target="_blank" rel="noopener">mark-whole-buffer overview</a></li>
<li><a href="https://www.gnu.org/software/emacs/manual/html_mono/eintr.html#Body-of-mark_002dwhole_002dbuffer" target="_blank" rel="noopener">Body of mark-whole-buffer</a>: Only three lines of code.</li>
</ul>
<h4 id="An-overview-of-mark-whole-buffer"><a href="#An-overview-of-mark-whole-buffer" class="headerlink" title="An overview of mark-whole-buffer"></a>An overview of <code>mark-whole-buffer</code></h4><p>In GNU Emacs 22, the code for the complete function looks like this:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">(defun mark-whole-buffer ()</span><br><span class="line">  &quot;Put point at beginning and mark at end of buffer.</span><br><span class="line">You probably should not use this function in Lisp programs;</span><br><span class="line">it is usually a mistake for a Lisp function to use any subroutine</span><br><span class="line">that uses or sets the mark.&quot;</span><br><span class="line">  (interactive)</span><br><span class="line">  (push-mark (point))</span><br><span class="line">  (push-mark (point-max) nil t)</span><br><span class="line">  (goto-char (point-min)))</span><br></pre></td></tr></table></figure>
<p>Like all other functions, the <code>mark-whole-buffer</code> function fits into the template for a function definition. The template looks like this:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">(defun name-of-function (argument-list)</span><br><span class="line">  &quot;documentation...&quot;</span><br><span class="line">  (interactive-expression...)</span><br><span class="line">  body...)</span><br></pre></td></tr></table></figure>
<p>Here is how the function works: the name of the function is <code>mark-whole-buffer</code>; it is followed by an empty argument list, ‘()’, which means that the function does not require arguments. The documentation comes next.</p>
<p>The next line is an <code>(interactive)</code> expression that tells Emacs that the function will be used interactively. These details are similar to the <code>simplified-beginning-of-buffer</code>function described in the previous section.</p>
<h4 id="4-3-1-Body-of-mark-whole-buffer"><a href="#4-3-1-Body-of-mark-whole-buffer" class="headerlink" title="4.3.1 Body of mark-whole-buffer"></a>4.3.1 Body of <code>mark-whole-buffer</code></h4><p>The body of the <code>mark-whole-buffer</code> function consists of three lines of code:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">(push-mark (point))</span><br><span class="line">(push-mark (point-max) nil t)</span><br><span class="line">(goto-char (point-min))</span><br></pre></td></tr></table></figure>
<p>The first of these lines is the expression, <code>(push-mark (point))</code>.</p>
<p>This line does exactly the same job as the first line of the body of the <code>simplified-beginning-of-buffer</code> function, which is written <code>(push-mark)</code>. In both cases, the Lisp interpreter sets a mark at the current position of the cursor.</p>
<p>I don’t know why the expression in <code>mark-whole-buffer</code> is written <code>(push-mark (point))</code> and the expression in <code>beginning-of-buffer</code> is written <code>(push-mark)</code>. Perhaps whoever wrote the code did not know that the arguments for <code>push-mark</code> are optional and that if <code>push-mark</code> is not passed an argument, the function automatically sets mark at the location of point by default. Or perhaps the expression was written so as to parallel the structure of the next line. In any case, the line causes Emacs to determine the position of point and set a mark there.</p>
<p>In earlier versions of GNU Emacs, the next line of <code>mark-whole-buffer</code> was <code>(push-mark (point-max))</code>. This expression sets a mark at the point in the buffer that has the highest number. This will be the end of the buffer (or, if the buffer is narrowed, the end of the accessible portion of the buffer. See <a href="https://www.gnu.org/software/emacs/manual/html_mono/eintr.html#Narrowing-_0026-Widening" target="_blank" rel="noopener">Narrowing and Widening</a>, for more about narrowing.) After this mark has been set, the previous mark, the one set at point, is no longer set, but Emacs remembers its position, just as all other recent marks are always remembered. This means that you can, if you wish, go back to that position by typing C-u C-<spc> twice.</spc></p>
<p>In GNU Emacs 22, the <code>(point-max)</code> is slightly more complicated. The line reads</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(push-mark (point-max) nil t)</span><br></pre></td></tr></table></figure>
<p>The expression works nearly the same as before. It sets a mark at the highest numbered place in the buffer that it can. However, in this version, <code>push-mark</code> has two additional arguments. The second argument to <code>push-mark</code> is <code>nil</code>. This tells the function it <em>should</em> display a message that says “Mark set” when it pushes the mark. The third argument is <code>t</code>. This tells <code>push-mark</code> to activate the mark when Transient Mark mode is turned on. Transient Mark mode highlights the currently active region. It is often turned off.</p>
<p>Finally, the last line of the function is <code>(goto-char (point-min)))</code>. This is written exactly the same way as it is written in <code>beginning-of-buffer</code>. The expression moves the cursor to the minimum point in the buffer, that is, to the beginning of the buffer (or to the beginning of the accessible portion of the buffer). As a result of this, point is placed at the beginning of the buffer and mark is set at the end of the buffer. The whole buffer is, therefore, the region.</p>
<h3 id="4-4-The-Definition-of-append-to-buffer"><a href="#4-4-The-Definition-of-append-to-buffer" class="headerlink" title="4.4 The Definition of append-to-buffer"></a>4.4 The Definition of <code>append-to-buffer</code></h3><p>The <code>append-to-buffer</code> command is more complex than the <code>mark-whole-buffer</code> command. What it does is copy the region (that is, the part of the buffer between point and mark) from the current buffer to a specified buffer.</p>
<ul>
<li><a href="https://www.gnu.org/software/emacs/manual/html_mono/eintr.html#append_002dto_002dbuffer-overview" target="_blank" rel="noopener">append-to-buffer overview</a></li>
<li><a href="https://www.gnu.org/software/emacs/manual/html_mono/eintr.html#append-interactive" target="_blank" rel="noopener">append interactive</a>: A two part interactive expression.</li>
<li><a href="https://www.gnu.org/software/emacs/manual/html_mono/eintr.html#append_002dto_002dbuffer-body" target="_blank" rel="noopener">append-to-buffer body</a>: Incorporates a <code>let</code> expression.</li>
<li><a href="https://www.gnu.org/software/emacs/manual/html_mono/eintr.html#append-save_002dexcursion" target="_blank" rel="noopener">append save-excursion</a>: How the <code>save-excursion</code> works.</li>
</ul>
<h4 id="An-Overview-of-append-to-buffer"><a href="#An-Overview-of-append-to-buffer" class="headerlink" title="An Overview of append-to-buffer"></a>An Overview of <code>append-to-buffer</code></h4><p>The <code>append-to-buffer</code> command uses the <code>insert-buffer-substring</code> function to copy the region. <code>insert-buffer-substring</code> is described by its name: it takes a substring from a buffer, and inserts it into another buffer.</p>
<p>Most of <code>append-to-buffer</code> is concerned with setting up the conditions for <code>insert-buffer-substring</code> to work: the code must specify both the buffer to which the text will go, the window it comes from and goes to, and the region that will be copied.</p>
<p>Here is the complete text of the function:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">(defun append-to-buffer (buffer start end)</span><br><span class="line">  &quot;Append to specified buffer the text of the region.</span><br><span class="line">It is inserted into that buffer before its point.</span><br><span class="line"></span><br><span class="line">When calling from a program, give three arguments:</span><br><span class="line">BUFFER (or buffer name), START and END.</span><br><span class="line">START and END specify the portion of the current buffer to be copied.&quot;</span><br><span class="line">  (interactive</span><br><span class="line">   (list (read-buffer &quot;Append to buffer: &quot; (other-buffer</span><br><span class="line">                                            (current-buffer) t))</span><br><span class="line">         (region-beginning) (region-end)))</span><br><span class="line">  (let ((oldbuf (current-buffer)))</span><br><span class="line">    (save-excursion</span><br><span class="line">      (let* ((append-to (get-buffer-create buffer))</span><br><span class="line">             (windows (get-buffer-window-list append-to t t))</span><br><span class="line">             point)</span><br><span class="line">        (set-buffer append-to)</span><br><span class="line">        (setq point (point))</span><br><span class="line">        (barf-if-buffer-read-only)</span><br><span class="line">        (insert-buffer-substring oldbuf start end)</span><br><span class="line">        (dolist (window windows)</span><br><span class="line">          (when (= (window-point window) point)</span><br><span class="line">            (set-window-point window (point))))))))</span><br></pre></td></tr></table></figure>
<p>The function can be understood by looking at it as a series of filled-in templates.</p>
<p>The outermost template is for the function definition. In this function, it looks like this (with several slots filled in):</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">(defun append-to-buffer (buffer start end)</span><br><span class="line">  &quot;documentation...&quot;</span><br><span class="line">  (interactive ...)</span><br><span class="line">  body...)</span><br></pre></td></tr></table></figure>
<p>The first line of the function includes its name and three arguments. The arguments are the <code>buffer</code> to which the text will be copied, and the <code>start</code> and <code>end</code> of the region in the current buffer that will be copied.</p>
<p>The next part of the function is the documentation, which is clear and complete. As is conventional, the three arguments are written in upper case so you will notice them easily. Even better, they are described in the same order as in the argument list.</p>
<p>Note that the documentation distinguishes between a buffer and its name. (The function can handle either.)</p>
<h4 id="4-4-1-The-append-to-buffer-Interactive-Expression"><a href="#4-4-1-The-append-to-buffer-Interactive-Expression" class="headerlink" title="4.4.1 The append-to-buffer Interactive Expression"></a>4.4.1 The <code>append-to-buffer</code> Interactive Expression</h4><p>Since the <code>append-to-buffer</code> function will be used interactively, the function must have an <code>interactive</code> expression. (For a review of <code>interactive</code>, see <a href="https://www.gnu.org/software/emacs/manual/html_mono/eintr.html#Interactive" target="_blank" rel="noopener">Making a Function Interactive</a>.) The expression reads as follows:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">(interactive</span><br><span class="line"> (list (read-buffer</span><br><span class="line">        &quot;Append to buffer: &quot;</span><br><span class="line">        (other-buffer (current-buffer) t))</span><br><span class="line">       (region-beginning)</span><br><span class="line">       (region-end)))</span><br></pre></td></tr></table></figure>
<p>This expression is not one with letters standing for parts, as described earlier. Instead, it starts a list with these parts:</p>
<p>The first part of the list is an expression to read the name of a buffer and return it as a string. That is <code>read-buffer</code>. The function requires a prompt as its first argument, ‘“Append to buffer: “’. Its second argument tells the command what value to provide if you don’t specify anything.</p>
<p>In this case that second argument is an expression containing the function <code>other-buffer</code>, an exception, and a ‘t’, standing for true.</p>
<p>The first argument to <code>other-buffer</code>, the exception, is yet another function, <code>current-buffer</code>. That is not going to be returned. The second argument is the symbol for true, <code>t</code>. that tells <code>other-buffer</code> that it may show visible buffers (except in this case, it will not show the current buffer, which makes sense).</p>
<p>The expression looks like this:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(other-buffer (current-buffer) t)</span><br></pre></td></tr></table></figure>
<p>The second and third arguments to the <code>list</code> expression are <code>(region-beginning)</code> and <code>(region-end)</code>. These two functions specify the beginning and end of the text to be appended.</p>
<p>Originally, the command used the letters ‘B’ and ‘r’. The whole <code>interactive</code> expression looked like this:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(interactive &quot;BAppend to buffer: \nr&quot;)</span><br></pre></td></tr></table></figure>
<p>But when that was done, the default value of the buffer switched to was invisible. That was not wanted.</p>
<p>(The prompt was separated from the second argument with a newline, ‘\n’. It was followed by an ‘r’ that told Emacs to bind the two arguments that follow the symbol <code>buffer</code> in the function’s argument list (that is, <code>start</code> and <code>end</code>) to the values of point and mark. That argument worked fine.)</p>
<h4 id="4-4-2-The-Body-of-append-to-buffer"><a href="#4-4-2-The-Body-of-append-to-buffer" class="headerlink" title="4.4.2 The Body of append-to-buffer"></a>4.4.2 The Body of <code>append-to-buffer</code></h4><p>The body of the <code>append-to-buffer</code> function begins with <code>let</code>.</p>
<p>As we have seen before (see <a href="https://www.gnu.org/software/emacs/manual/html_mono/eintr.html#let" target="_blank" rel="noopener"><code>let</code></a>), the purpose of a <code>let</code> expression is to create and give initial values to one or more variables that will only be used within the body of the <code>let</code>. This means that such a variable will not be confused with any variable of the same name outside the <code>let</code> expression.</p>
<p>We can see how the <code>let</code> expression fits into the function as a whole by showing a template for <code>append-to-buffer</code> with the <code>let</code> expression in outline:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">(defun append-to-buffer (buffer start end)</span><br><span class="line">  &quot;documentation...&quot;</span><br><span class="line">  (interactive ...)</span><br><span class="line">  (let ((variable value))</span><br><span class="line">        body...)</span><br></pre></td></tr></table></figure>
<p>The <code>let</code> expression has three elements:</p>
<ol>
<li>The symbol <code>let</code>;</li>
<li>A varlist containing, in this case, a single two-element list, <code>(</code>variable value<code>)</code>;</li>
<li>The body of the <code>let</code> expression.</li>
</ol>
<p>In the <code>append-to-buffer</code> function, the varlist looks like this:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(oldbuf (current-buffer))</span><br></pre></td></tr></table></figure>
<p>In this part of the <code>let</code> expression, the one variable, <code>oldbuf</code>, is bound to the value returned by the <code>(current-buffer)</code> expression. The variable, <code>oldbuf</code>, is used to keep track of the buffer in which you are working and from which you will copy.</p>
<p>The element or elements of a varlist are surrounded by a set of parentheses so the Lisp interpreter can distinguish the varlist from the body of the <code>let</code>. As a consequence, the two-element list within the varlist is surrounded by a circumscribing set of parentheses. The line looks like this:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">(let ((oldbuf (current-buffer)))</span><br><span class="line">  ... )</span><br></pre></td></tr></table></figure>
<p>The two parentheses before <code>oldbuf</code> might surprise you if you did not realize that the first parenthesis before <code>oldbuf</code> marks the boundary of the varlist and the second parenthesis marks the beginning of the two-element list, <code>(oldbuf (current-buffer))</code>.</p>
<h4 id="4-4-3-save-excursion-in-append-to-buffer"><a href="#4-4-3-save-excursion-in-append-to-buffer" class="headerlink" title="4.4.3 save-excursion in append-to-buffer"></a>4.4.3 <code>save-excursion</code> in <code>append-to-buffer</code></h4><p>The body of the <code>let</code> expression in <code>append-to-buffer</code> consists of a <code>save-excursion</code> expression.</p>
<p>The <code>save-excursion</code> function saves the location of point, and restores it to that position after the expressions in the body of the <code>save-excursion</code> complete execution. In addition,<code>save-excursion</code> keeps track of the original buffer, and restores it. This is how <code>save-excursion</code> is used in <code>append-to-buffer</code>.</p>
<p>Incidentally, it is worth noting here that a Lisp function is normally formatted so that everything that is enclosed in a multi-line spread is indented more to the right than the first symbol. In this function definition, the <code>let</code> is indented more than the <code>defun</code>, and the <code>save-excursion</code> is indented more than the <code>let</code>, like this:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">(defun ...</span><br><span class="line">  ...</span><br><span class="line">  ...</span><br><span class="line">  (let...</span><br><span class="line">    (save-excursion</span><br><span class="line">      ...</span><br></pre></td></tr></table></figure>
<p>This formatting convention makes it easy to see that the lines in the body of the <code>save-excursion</code> are enclosed by the parentheses associated with <code>save-excursion</code>, just as the<code>save-excursion</code> itself is enclosed by the parentheses associated with the <code>let</code>:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">(let ((oldbuf (current-buffer)))</span><br><span class="line">  (save-excursion</span><br><span class="line">    ...</span><br><span class="line">    (set-buffer ...)</span><br><span class="line">    (insert-buffer-substring oldbuf start end)</span><br><span class="line">    ...))</span><br></pre></td></tr></table></figure>
<p>The use of the <code>save-excursion</code> function can be viewed as a process of filling in the slots of a template:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">(save-excursion</span><br><span class="line">  first-expression-in-body</span><br><span class="line">  second-expression-in-body</span><br><span class="line">   ...</span><br><span class="line">  last-expression-in-body)</span><br></pre></td></tr></table></figure>
<p>In this function, the body of the <code>save-excursion</code> contains only one expression, the <code>let*</code> expression. You know about a <code>let</code> function. The <code>let*</code> function is different. It has a ‘*’ in its name. It enables Emacs to set each variable in its varlist in sequence, one after another.</p>
<p>Its critical feature is that variables later in the varlist can make use of the values to which Emacs set variables earlier in the varlist. See <a href="https://www.gnu.org/software/emacs/manual/html_mono/eintr.html#fwd_002dpara-let" target="_blank" rel="noopener">The <code>let*</code> expression</a>.</p>
<p>We will skip functions like <code>let*</code> and focus on two: the <code>set-buffer</code> function and the <code>insert-buffer-substring</code> function.</p>
<p>In the old days, the <code>set-buffer</code> expression was simply</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(set-buffer (get-buffer-create buffer))</span><br></pre></td></tr></table></figure>
<p>but now it is</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(set-buffer append-to)</span><br></pre></td></tr></table></figure>
<p><code>append-to</code> is bound to <code>(get-buffer-create buffer)</code> earlier on in the <code>let*</code> expression. That extra binding would not be necessary except for that <code>append-to</code> is used later in the varlist as an argument to <code>get-buffer-window-list</code>.</p>
<p>The <code>append-to-buffer</code> function definition inserts text from the buffer in which you are currently to a named buffer. It happens that <code>insert-buffer-substring</code> does just the reverse—it copies text from another buffer to the current buffer—that is why the <code>append-to-buffer</code> definition starts out with a <code>let</code> that binds the local symbol <code>oldbuf</code> to the value returned by <code>current-buffer</code>.</p>
<p>The <code>insert-buffer-substring</code> expression looks like this:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(insert-buffer-substring oldbuf start end)</span><br></pre></td></tr></table></figure>
<p>The <code>insert-buffer-substring</code> function copies a string <em>from</em> the buffer specified as its first argument and inserts the string into the present buffer. In this case, the argument to<code>insert-buffer-substring</code> is the value of the variable created and bound by the <code>let</code>, namely the value of <code>oldbuf</code>, which was the current buffer when you gave the <code>append-to-buffer</code> command.</p>
<p>After <code>insert-buffer-substring</code> has done its work, <code>save-excursion</code> will restore the action to the original buffer and <code>append-to-buffer</code> will have done its job.</p>
<p>Written in skeletal form, the workings of the body look like this:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">(let (bind-oldbuf-to-value-of-current-buffer)</span><br><span class="line">  (save-excursion                       ; Keep track of buffer.</span><br><span class="line">    change-buffer</span><br><span class="line">    insert-substring-from-oldbuf-into-buffer)</span><br><span class="line"></span><br><span class="line">  change-back-to-original-buffer-when-finished</span><br><span class="line">let-the-local-meaning-of-oldbuf-disappear-when-finished</span><br></pre></td></tr></table></figure>
<p>In summary, <code>append-to-buffer</code> works as follows: it saves the value of the current buffer in the variable called <code>oldbuf</code>. It gets the new buffer (creating one if need be) and switches Emacs’s attention to it. Using the value of <code>oldbuf</code>, it inserts the region of text from the old buffer into the new buffer; and then using <code>save-excursion</code>, it brings you back to your original buffer.</p>
<p>In looking at <code>append-to-buffer</code>, you have explored a fairly complex function. It shows how to use <code>let</code> and <code>save-excursion</code>, and how to change to and come back from another buffer. Many function definitions use <code>let</code>, <code>save-excursion</code>, and <code>set-buffer</code> this way.</p>
<h3 id="4-5-Review"><a href="#4-5-Review" class="headerlink" title="4.5 Review"></a>4.5 Review</h3><p>Here is a brief summary of the various functions discussed in this chapter.</p>
<ul>
<li><p><code>describe-function</code></p>
</li>
<li><p><code>describe-variable</code></p>
<p>Print the documentation for a function or variable. Conventionally bound to C-h f and C-h v.  </p>
</li>
<li><p><code>xref-find-definitions</code></p>
<p>Find the file containing the source for a function or variable and switch buffers to it, positioning point at the beginning of the item. Conventionally bound to M-. (that’s a period following the <meta> key).  </p>
</li>
<li><p><code>save-excursion</code></p>
<p>Save the location of point and restore its value after the arguments to <code>save-excursion</code> have been evaluated. Also, remember the current buffer and return to it.  </p>
</li>
<li><p><code>push-mark</code></p>
<p>Set mark at a location and record the value of the previous mark on the mark ring. The mark is a location in the buffer that will keep its relative position even if text is added to or removed from the buffer.  </p>
</li>
<li><p><code>goto-char</code></p>
<p>Set point to the location specified by the value of the argument, which can be a number, a marker, or an expression that returns the number of a position, such as <code>(point-min)</code>.  </p>
</li>
<li><p><code>insert-buffer-substring</code></p>
<p>Copy a region of text from a buffer that is passed to the function as an argument and insert the region into the current buffer.  </p>
</li>
<li><p><code>mark-whole-buffer</code></p>
<p>Mark the whole buffer as a region. Normally bound to C-x h.  </p>
</li>
<li><p><code>set-buffer</code></p>
<p>Switch the attention of Emacs to another buffer, but do not change the window being displayed. Used when the program rather than a human is to work on a different buffer.  </p>
</li>
<li><p><code>get-buffer-create</code></p>
</li>
<li><p><code>get-buffer</code></p>
<p>Find a named buffer or create one if a buffer of that name does not exist. The <code>get-buffer</code> function returns <code>nil</code> if the named buffer does not exist.</p>
</li>
</ul>
<h3 id="4-6-Exercises"><a href="#4-6-Exercises" class="headerlink" title="4.6 Exercises"></a>4.6 Exercises</h3><ul>
<li>Write your own <code>simplified-end-of-buffer</code> function definition; then test it to see whether it works.</li>
<li>Use <code>if</code> and <code>get-buffer</code> to write a function that prints a message telling you whether a buffer exists.</li>
<li>Using <code>xref-find-definitions</code>, find the source for the <code>copy-to-buffer</code> function.</li>
</ul>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://alphaalgorithms.github.io/2019/06/11/elisp-function/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Gabriel">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="DummyHead">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                
                <a href="/2019/06/11/elisp-function/" class="post-title-link" itemprop="url">Intro to elisp 3 How To Write Function Definitions</a>
              
            
          </h2>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2019-06-11 09:15:41 / Modified: 09:29:40" itemprop="dateCreated datePublished" datetime="2019-06-11T09:15:41+08:00">2019-06-11</time>
            

            
              

              
            
          </span>

          

          
            
            
              
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
            
                <span class="post-meta-item-text">Comments: </span>
                <a href="/2019/06/11/elisp-function/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2019/06/11/elisp-function/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>When the Lisp interpreter evaluates a list, it looks to see whether the first symbol on the list has a function definition attached to it; or, put another way, whether the symbol points to a function definition. If it does, the computer carries out the instructions in the definition. A symbol that has a function definition is called, simply, a function (although, properly speaking, the definition is the function and the symbol refers to it.)</p>
<ul>
<li><a href="https://www.gnu.org/software/emacs/manual/html_mono/eintr.html#Primitive-Functions" target="_blank" rel="noopener">Primitive Functions</a></li>
<li><a href="https://www.gnu.org/software/emacs/manual/html_mono/eintr.html#defun" target="_blank" rel="noopener">defun</a>: The <code>defun</code> macro.</li>
<li><a href="https://www.gnu.org/software/emacs/manual/html_mono/eintr.html#Install" target="_blank" rel="noopener">Install</a>: Install a function definition.</li>
<li><a href="https://www.gnu.org/software/emacs/manual/html_mono/eintr.html#Interactive" target="_blank" rel="noopener">Interactive</a>: Making a function interactive.</li>
<li><a href="https://www.gnu.org/software/emacs/manual/html_mono/eintr.html#Interactive-Options" target="_blank" rel="noopener">Interactive Options</a>: Different options for <code>interactive</code>.</li>
<li><a href="https://www.gnu.org/software/emacs/manual/html_mono/eintr.html#Permanent-Installation" target="_blank" rel="noopener">Permanent Installation</a>: Installing code permanently.</li>
<li><a href="https://www.gnu.org/software/emacs/manual/html_mono/eintr.html#let" target="_blank" rel="noopener">let</a>: Creating and initializing local variables.</li>
<li><a href="https://www.gnu.org/software/emacs/manual/html_mono/eintr.html#if" target="_blank" rel="noopener">if</a>: What if?</li>
<li><a href="https://www.gnu.org/software/emacs/manual/html_mono/eintr.html#else" target="_blank" rel="noopener">else</a>: If–then–else expressions.</li>
<li><a href="https://www.gnu.org/software/emacs/manual/html_mono/eintr.html#Truth-_0026-Falsehood" target="_blank" rel="noopener">Truth &amp; Falsehood</a>: What Lisp considers false and true.</li>
<li><a href="https://www.gnu.org/software/emacs/manual/html_mono/eintr.html#save_002dexcursion" target="_blank" rel="noopener">save-excursion</a>: Keeping track of point and buffer.</li>
<li><a href="https://www.gnu.org/software/emacs/manual/html_mono/eintr.html#Review" target="_blank" rel="noopener">Review</a></li>
<li><a href="https://www.gnu.org/software/emacs/manual/html_mono/eintr.html#defun-Exercises" target="_blank" rel="noopener">defun Exercises</a></li>
</ul>
<h3 id="An-Aside-about-Primitive-Functions"><a href="#An-Aside-about-Primitive-Functions" class="headerlink" title="An Aside about Primitive Functions"></a>An Aside about Primitive Functions</h3><p>All functions are defined in terms of other functions, except for a few primitive functions that are written in the C programming language. When you write functions’ definitions, you will write them in Emacs Lisp and use other functions as your building blocks. Some of the functions you will use will themselves be written in Emacs Lisp (perhaps by you) and some will be primitives written in C. The primitive functions are used exactly like those written in Emacs Lisp and behave like them. They are written in C so we can easily run GNU Emacs on any computer that has sufficient power and can run C.</p>
<p>Let me re-emphasize this: when you write code in Emacs Lisp, you do not distinguish between the use of functions written in C and the use of functions written in Emacs Lisp. The difference is irrelevant. I mention the distinction only because it is interesting to know. Indeed, unless you investigate, you won’t know whether an already-written function is written in Emacs Lisp or C.</p>
<h3 id="3-1-The-defun-Macro"><a href="#3-1-The-defun-Macro" class="headerlink" title="3.1 The defun Macro"></a>3.1 The <code>defun</code> Macro</h3><p>In Lisp, a symbol such as <code>mark-whole-buffer</code> has code attached to it that tells the computer what to do when the function is called. This code is called the function definition and is created by evaluating a Lisp expression that starts with the symbol <code>defun</code> (which is an abbreviation for <em>define function</em>).</p>
<p>In subsequent sections, we will look at function definitions from the Emacs source code, such as <code>mark-whole-buffer</code>. In this section, we will describe a simple function definition so you can see how it looks. This function definition uses arithmetic because it makes for a simple example. Some people dislike examples using arithmetic; however, if you are such a person, do not despair. Hardly any of the code we will study in the remainder of this introduction involves arithmetic or mathematics. The examples mostly involve text in one way or another.</p>
<p>A function definition has up to five parts following the word <code>defun</code>:</p>
<ol>
<li><p>The name of the symbol to which the function definition should be attached.</p>
</li>
<li><p>A list of the arguments that will be passed to the function. If no arguments will be passed to the function, this is an empty list, <code>()</code>.</p>
</li>
<li><p>Documentation describing the function. (Technically optional, but strongly recommended.)</p>
</li>
<li><p>Optionally, an expression to make the function interactive so you can use it by typing</p>
<p><code>M-x</code></p>
<p>and then the name of the function; or by typing an appropriate key or keychord.</p>
</li>
<li><p>The code that instructs the computer what to do: the body of the function definition.</p>
</li>
</ol>
<p>It is helpful to think of the five parts of a function definition as being organized in a template, with slots for each part:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">(defun function-name (arguments...)</span><br><span class="line">  &quot;optional-documentation...&quot;</span><br><span class="line">  (interactive argument-passing-info)     ; optional</span><br><span class="line">  body...)</span><br></pre></td></tr></table></figure>
<p>As an example, here is the code for a function that multiplies its argument by 7. (This example is not interactive. See <a href="https://www.gnu.org/software/emacs/manual/html_mono/eintr.html#Interactive" target="_blank" rel="noopener">Making a Function Interactive</a>, for that information.)</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">(defun multiply-by-seven (number)</span><br><span class="line">  &quot;Multiply NUMBER by seven.&quot;</span><br><span class="line">  (* 7 number))</span><br></pre></td></tr></table></figure>
<p>This definition begins with a parenthesis and the symbol <code>defun</code>, followed by the name of the function.</p>
<p>The name of the function is followed by a list that contains the arguments that will be passed to the function. This list is called the argument list. In this example, the list has only one element, the symbol, <code>number</code>. When the function is used, the symbol will be bound to the value that is used as the argument to the function.</p>
<p>Instead of choosing the word <code>number</code> for the name of the argument, I could have picked any other name. For example, I could have chosen the word <code>multiplicand</code>. I picked the word “number” because it tells what kind of value is intended for this slot; but I could just as well have chosen the word “multiplicand” to indicate the role that the value placed in this slot will play in the workings of the function. I could have called it <code>foogle</code>, but that would have been a bad choice because it would not tell humans what it means. The choice of name is up to the programmer and should be chosen to make the meaning of the function clear.</p>
<p>Indeed, you can choose any name you wish for a symbol in an argument list, even the name of a symbol used in some other function: the name you use in an argument list is private to that particular definition. In that definition, the name refers to a different entity than any use of the same name outside the function definition. Suppose you have a nick-name “Shorty” in your family; when your family members refer to “Shorty”, they mean you. But outside your family, in a movie, for example, the name “Shorty” refers to someone else. Because a name in an argument list is private to the function definition, you can change the value of such a symbol inside the body of a function without changing its value outside the function. The effect is similar to that produced by a <code>let</code> expression. (See <a href="https://www.gnu.org/software/emacs/manual/html_mono/eintr.html#let" target="_blank" rel="noopener"><code>let</code></a>.)</p>
<p>The argument list is followed by the documentation string that describes the function. This is what you see when you type C-h f and the name of a function. Incidentally, when you write a documentation string like this, you should make the first line a complete sentence since some commands, such as <code>apropos</code>, print only the first line of a multi-line documentation string. Also, you should not indent the second line of a documentation string, if you have one, because that looks odd when you use C-h f (<code>describe-function</code>). The documentation string is optional, but it is so useful, it should be included in almost every function you write.</p>
<p>The third line of the example consists of the body of the function definition. (Most functions’ definitions, of course, are longer than this.) In this function, the body is the list, <code>(* 7 number)</code>, which says to multiply the value of number by 7. (In Emacs Lisp, <code>*</code> is the function for multiplication, just as <code>+</code> is the function for addition.)</p>
<p>When you use the <code>multiply-by-seven</code> function, the argument <code>number</code> evaluates to the actual number you want used. Here is an example that shows how <code>multiply-by-seven</code> is used; but don’t try to evaluate this yet!</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(multiply-by-seven 3)</span><br></pre></td></tr></table></figure>
<p>The symbol <code>number</code>, specified in the function definition in the next section, is bound to the value 3 in the actual use of the function. Note that although <code>number</code> was inside parentheses in the function definition, the argument passed to the <code>multiply-by-seven</code> function is not in parentheses. The parentheses are written in the function definition so the computer can figure out where the argument list ends and the rest of the function definition begins.</p>
<p>If you evaluate this example, you are likely to get an error message. (Go ahead, try it!) This is because we have written the function definition, but not yet told the computer about the definition—we have not yet loaded the function definition in Emacs. Installing a function is the process that tells the Lisp interpreter the definition of the function. Installation is described in the next section.</p>
<h3 id="3-2-Install-a-Function-Definition"><a href="#3-2-Install-a-Function-Definition" class="headerlink" title="3.2 Install a Function Definition"></a>3.2 Install a Function Definition</h3><p>If you are reading this inside of Info in Emacs, you can try out the <code>multiply-by-seven</code> function by first evaluating the function definition and then evaluating <code>(multiply-by-seven 3)</code>. A copy of the function definition follows. Place the cursor after the last parenthesis of the function definition and type C-x C-e. When you do this, <code>multiply-by-seven</code>will appear in the echo area. (What this means is that when a function definition is evaluated, the value it returns is the name of the defined function.) At the same time, this action installs the function definition.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">(defun multiply-by-seven (number)</span><br><span class="line">  &quot;Multiply NUMBER by seven.&quot;</span><br><span class="line">  (* 7 number))</span><br></pre></td></tr></table></figure>
<p>By evaluating this <code>defun</code>, you have just installed <code>multiply-by-seven</code> in Emacs. The function is now just as much a part of Emacs as <code>forward-word</code> or any other editing function you use. (<code>multiply-by-seven</code> will stay installed until you quit Emacs. To reload code automatically whenever you start Emacs, see <a href="https://www.gnu.org/software/emacs/manual/html_mono/eintr.html#Permanent-Installation" target="_blank" rel="noopener">Installing Code Permanently</a>.)</p>
<ul>
<li><a href="https://www.gnu.org/software/emacs/manual/html_mono/eintr.html#Effect-of-installation" target="_blank" rel="noopener">Effect of installation</a></li>
<li><a href="https://www.gnu.org/software/emacs/manual/html_mono/eintr.html#Change-a-defun" target="_blank" rel="noopener">Change a defun</a>: How to change a function definition.</li>
</ul>
<h4 id="The-effect-of-installation"><a href="#The-effect-of-installation" class="headerlink" title="The effect of installation"></a>The effect of installation</h4><p>You can see the effect of installing <code>multiply-by-seven</code> by evaluating the following sample. Place the cursor after the following expression and type C-x C-e. The number 21 will appear in the echo area.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(multiply-by-seven 3)</span><br></pre></td></tr></table></figure>
<p>If you wish, you can read the documentation for the function by typing C-h f (<code>describe-function</code>) and then the name of the function, <code>multiply-by-seven</code>. When you do this, a<em>Help</em> window will appear on your screen that says:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">multiply-by-seven is a Lisp function.</span><br><span class="line"></span><br><span class="line">(multiply-by-seven NUMBER)</span><br><span class="line"></span><br><span class="line">Multiply NUMBER by seven.</span><br></pre></td></tr></table></figure>
<p>(To return to a single window on your screen, type C-x 1.)</p>
<h4 id="3-2-1-Change-a-Function-Definition"><a href="#3-2-1-Change-a-Function-Definition" class="headerlink" title="3.2.1 Change a Function Definition"></a>3.2.1 Change a Function Definition</h4><p>If you want to change the code in <code>multiply-by-seven</code>, just rewrite it. To install the new version in place of the old one, evaluate the function definition again. This is how you modify code in Emacs. It is very simple.</p>
<p>As an example, you can change the <code>multiply-by-seven</code> function to add the number to itself seven times instead of multiplying the number by seven. It produces the same answer, but by a different path. At the same time, we will add a comment to the code; a comment is text that the Lisp interpreter ignores, but that a human reader may find useful or enlightening. The comment is that this is the second version.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">(defun multiply-by-seven (number)       ; Second version.</span><br><span class="line">  &quot;Multiply NUMBER by seven.&quot;</span><br><span class="line">  (+ number number number number number number number))</span><br></pre></td></tr></table></figure>
<p>The comment follows a semicolon, ‘;’. In Lisp, everything on a line that follows a semicolon is a comment. The end of the line is the end of the comment. To stretch a comment over two or more lines, begin each line with a semicolon.</p>
<p>See <a href="https://www.gnu.org/software/emacs/manual/html_mono/eintr.html#Beginning-init-File" target="_blank" rel="noopener">Beginning a .emacs File</a>, and <a href="https://www.gnu.org/software/emacs/manual/html_mono/elisp.html#Comments" target="_blank" rel="noopener">Comments</a>, for more about comments.</p>
<p>You can install this version of the <code>multiply-by-seven</code> function by evaluating it in the same way you evaluated the first function: place the cursor after the last parenthesis and type C-x C-e.</p>
<p>In summary, this is how you write code in Emacs Lisp: you write a function; install it; test it; and then make fixes or enhancements and install it again.</p>
<h3 id="3-3-Make-a-Function-Interactive"><a href="#3-3-Make-a-Function-Interactive" class="headerlink" title="3.3 Make a Function Interactive"></a>3.3 Make a Function Interactive</h3><p>You make a function interactive by placing a list that begins with the special form <code>interactive</code> immediately after the documentation. A user can invoke an interactive function by typing M-x and then the name of the function; or by typing the keys to which it is bound, for example, by typing C-n for <code>next-line</code> or C-x h for <code>mark-whole-buffer</code>.</p>
<p>Interestingly, when you call an interactive function interactively, the value returned is not automatically displayed in the echo area. This is because you often call an interactive function for its side effects, such as moving forward by a word or line, and not for the value returned. If the returned value were displayed in the echo area each time you typed a key, it would be very distracting.</p>
<ul>
<li><a href="https://www.gnu.org/software/emacs/manual/html_mono/eintr.html#Interactive-multiply_002dby_002dseven" target="_blank" rel="noopener">Interactive multiply-by-seven</a>: An overview.</li>
<li><a href="https://www.gnu.org/software/emacs/manual/html_mono/eintr.html#multiply_002dby_002dseven-in-detail" target="_blank" rel="noopener">multiply-by-seven in detail</a>: The interactive version.</li>
</ul>
<h4 id="An-Interactive-multiply-by-seven-An-Overview"><a href="#An-Interactive-multiply-by-seven-An-Overview" class="headerlink" title="An Interactive multiply-by-seven, An Overview"></a>An Interactive <code>multiply-by-seven</code>, An Overview</h4><p>Both the use of the special form <code>interactive</code> and one way to display a value in the echo area can be illustrated by creating an interactive version of <code>multiply-by-seven</code>.</p>
<p>Here is the code:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">(defun multiply-by-seven (number)       ; Interactive version.</span><br><span class="line">  &quot;Multiply NUMBER by seven.&quot;</span><br><span class="line">  (interactive &quot;p&quot;)</span><br><span class="line">  (message &quot;The result is %d&quot; (* 7 number)))</span><br></pre></td></tr></table></figure>
<p>You can install this code by placing your cursor after it and typing C-x C-e. The name of the function will appear in your echo area. Then, you can use this code by typing C-u and a number and then typing M-x multiply-by-seven and pressing <ret>. The phrase ‘The result is …’ followed by the product will appear in the echo area.</ret></p>
<p>Speaking more generally, you invoke a function like this in either of two ways:</p>
<ol>
<li>By typing a prefix argument that contains the number to be passed, and then typing M-x and the name of the function, as with C-u 3 M-x forward-sentence; or,</li>
<li>By typing whatever key or keychord the function is bound to, as with C-u 3 M-e.</li>
</ol>
<p>Both the examples just mentioned work identically to move point forward three sentences. (Since <code>multiply-by-seven</code> is not bound to a key, it could not be used as an example of key binding.)</p>
<p>(See <a href="https://www.gnu.org/software/emacs/manual/html_mono/eintr.html#Keybindings" target="_blank" rel="noopener">Some Keybindings</a>, to learn how to bind a command to a key.)</p>
<p>A prefix argument is passed to an interactive function by typing the <meta> key followed by a number, for example, M-3 M-e, or by typing C-u and then a number, for example, C-u 3 M-e (if you type C-u without a number, it defaults to 4).</p>
<h3 id="3-4-Different-Options-for-interactive"><a href="#3-4-Different-Options-for-interactive" class="headerlink" title="3.4 Different Options for interactive"></a>3.4 Different Options for <code>interactive</code></h3><p>In the example, <code>multiply-by-seven</code> used <code>&quot;p&quot;</code> as the argument to <code>interactive</code>. This argument told Emacs to interpret your typing either C-u followed by a number or <meta> followed by a number as a command to pass that number to the function as its argument. Emacs has more than twenty characters predefined for use with <code>interactive</code>. In almost every case, one of these options will enable you to pass the right information interactively to a function. (See <a href="https://www.gnu.org/software/emacs/manual/html_mono/elisp.html#Interactive-Codes" target="_blank" rel="noopener">Code Characters for <code>interactive</code></a>.)</p>
<p>Consider the function <code>zap-to-char</code>. Its interactive expression is</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(interactive &quot;p\ncZap to char: &quot;)</span><br></pre></td></tr></table></figure>
<p>The first part of the argument to <code>interactive</code> is ‘p’, with which you are already familiar. This argument tells Emacs to interpret a prefix, as a number to be passed to the function. You can specify a prefix either by typing C-u followed by a number or by typing <meta> followed by a number. The prefix is the number of specified characters. Thus, if your prefix is three and the specified character is ‘x’, then you will delete all the text up to and including the third next ‘x’. If you do not set a prefix, then you delete all the text up to and including the specified character, but no more.</p>
<p>The ‘c’ tells the function the name of the character to which to delete.</p>
<p>More formally, a function with two or more arguments can have information passed to each argument by adding parts to the string that follows <code>interactive</code>. When you do this, the information is passed to each argument in the same order it is specified in the <code>interactive</code> list. In the string, each part is separated from the next part by a ‘\n’, which is a newline. For example, you can follow ‘p’ with a ‘\n’ and an ‘cZap to char: ’. This causes Emacs to pass the value of the prefix argument (if there is one) and the character.</p>
<p>In this case, the function definition looks like the following, where <code>arg</code> and <code>char</code> are the symbols to which <code>interactive</code> binds the prefix argument and the specified character:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">(defun name-of-function (arg char)</span><br><span class="line">  &quot;documentation...&quot;</span><br><span class="line">  (interactive &quot;p\ncZap to char: &quot;)</span><br><span class="line">  body-of-function...)</span><br></pre></td></tr></table></figure>
<p>(The space after the colon in the prompt makes it look better when you are prompted. See <a href="https://www.gnu.org/software/emacs/manual/html_mono/eintr.html#copy_002dto_002dbuffer" target="_blank" rel="noopener">The Definition of <code>copy-to-buffer</code></a>, for an example.)</p>
<p>When a function does not take arguments, <code>interactive</code> does not require any. Such a function contains the simple expression <code>(interactive)</code>. The <code>mark-whole-buffer</code> function is like this.</p>
<p>Alternatively, if the special letter-codes are not right for your application, you can pass your own arguments to <code>interactive</code> as a list.</p>
<p>See <a href="https://www.gnu.org/software/emacs/manual/html_mono/eintr.html#append_002dto_002dbuffer" target="_blank" rel="noopener">The Definition of <code>append-to-buffer</code></a>, for an example. See <a href="https://www.gnu.org/software/emacs/manual/html_mono/elisp.html#Using-Interactive" target="_blank" rel="noopener">Using <code>Interactive</code></a>, for a more complete explanation about this technique.</p>
<h3 id="3-5-Install-Code-Permanently"><a href="#3-5-Install-Code-Permanently" class="headerlink" title="3.5 Install Code Permanently"></a>3.5 Install Code Permanently</h3><p>When you install a function definition by evaluating it, it will stay installed until you quit Emacs. The next time you start a new session of Emacs, the function will not be installed unless you evaluate the function definition again.</p>
<p>At some point, you may want to have code installed automatically whenever you start a new session of Emacs. There are several ways of doing this:</p>
<ul>
<li>If you have code that is just for yourself, you can put the code for the function definition in your .emacs initialization file. When you start Emacs, your .emacs file is automatically evaluated and all the function definitions within it are installed. See <a href="https://www.gnu.org/software/emacs/manual/html_mono/eintr.html#Emacs-Initialization" target="_blank" rel="noopener">Your .emacs File</a>.</li>
<li>Alternatively, you can put the function definitions that you want installed in one or more files of their own and use the <code>load</code> function to cause Emacs to evaluate and thereby install each of the functions in the files. See <a href="https://www.gnu.org/software/emacs/manual/html_mono/eintr.html#Loading-Files" target="_blank" rel="noopener">Loading Files</a>.</li>
<li>Thirdly, if you have code that your whole site will use, it is usual to put it in a file called site-init.el that is loaded when Emacs is built. This makes the code available to everyone who uses your machine. (See the INSTALL file that is part of the Emacs distribution.)</li>
</ul>
<p>Finally, if you have code that everyone who uses Emacs may want, you can post it on a computer network or send a copy to the Free Software Foundation. (When you do this, please license the code and its documentation under a license that permits other people to run, copy, study, modify, and redistribute the code and which protects you from having your work taken from you.) If you send a copy of your code to the Free Software Foundation, and properly protect yourself and others, it may be included in the next release of Emacs. In large part, this is how Emacs has grown over the past years, by donations.</p>
<h3 id="3-6-let"><a href="#3-6-let" class="headerlink" title="3.6 let"></a>3.6 <code>let</code></h3><p>The <code>let</code> expression is a special form in Lisp that you will need to use in most function definitions.</p>
<p><code>let</code> is used to attach or bind a symbol to a value in such a way that the Lisp interpreter will not confuse the variable with a variable of the same name that is not part of the function.</p>
<p>To understand why the <code>let</code> special form is necessary, consider the situation in which you own a home that you generally refer to as “the house”, as in the sentence, “The house needs painting.” If you are visiting a friend and your host refers to “the house”, he is likely to be referring to <em>his</em> house, not yours, that is, to a different house.</p>
<p>If your friend is referring to his house and you think he is referring to your house, you may be in for some confusion. The same thing could happen in Lisp if a variable that is used inside of one function has the same name as a variable that is used inside of another function, and the two are not intended to refer to the same value. The <code>let</code> special form prevents this kind of confusion.</p>
<ul>
<li><a href="https://www.gnu.org/software/emacs/manual/html_mono/eintr.html#Prevent-confusion" target="_blank" rel="noopener">Prevent confusion</a></li>
<li><a href="https://www.gnu.org/software/emacs/manual/html_mono/eintr.html#Parts-of-let-Expression" target="_blank" rel="noopener">Parts of let Expression</a></li>
<li><a href="https://www.gnu.org/software/emacs/manual/html_mono/eintr.html#Sample-let-Expression" target="_blank" rel="noopener">Sample let Expression</a></li>
<li><a href="https://www.gnu.org/software/emacs/manual/html_mono/eintr.html#Uninitialized-let-Variables" target="_blank" rel="noopener">Uninitialized let Variables</a></li>
</ul>
<h4 id="let-Prevents-Confusion"><a href="#let-Prevents-Confusion" class="headerlink" title="let Prevents Confusion"></a><code>let</code> Prevents Confusion</h4><p>The <code>let</code> special form prevents confusion. <code>let</code> creates a name for a local variable that overshadows any use of the same name outside the <code>let</code> expression. This is like understanding that whenever your host refers to “the house”, he means his house, not yours. (Symbols used in argument lists work the same way. See <a href="https://www.gnu.org/software/emacs/manual/html_mono/eintr.html#defun" target="_blank" rel="noopener">The <code>defun</code> Macro</a>.)</p>
<p>Local variables created by a <code>let</code> expression retain their value <em>only</em> within the <code>let</code> expression itself (and within expressions called within the <code>let</code> expression); the local variables have no effect outside the <code>let</code> expression.</p>
<p>Another way to think about <code>let</code> is that it is like a <code>setq</code> that is temporary and local. The values set by <code>let</code> are automatically undone when the <code>let</code> is finished. The setting only affects expressions that are inside the bounds of the <code>let</code> expression. In computer science jargon, we would say the binding of a symbol is visible only in functions called in the <code>let</code> form; in Emacs Lisp, scoping is dynamic, not lexical.</p>
<p><code>let</code> can create more than one variable at once. Also, <code>let</code> gives each variable it creates an initial value, either a value specified by you, or <code>nil</code>. (In the jargon, this is binding the variable to the value.) After <code>let</code> has created and bound the variables, it executes the code in the body of the <code>let</code>, and returns the value of the last expression in the body, as the value of the whole <code>let</code> expression. (“Execute” is a jargon term that means to evaluate a list; it comes from the use of the word meaning “to give practical effect to” (Oxford English Dictionary). Since you evaluate an expression to perform an action, “execute” has evolved as a synonym to “evaluate”.)</p>
<h4 id="3-6-2-Sample-let-Expression"><a href="#3-6-2-Sample-let-Expression" class="headerlink" title="3.6.2 Sample let Expression"></a>3.6.2 Sample <code>let</code> Expression</h4><p>The following expression creates and gives initial values to the two variables <code>zebra</code> and <code>tiger</code>. The body of the <code>let</code> expression is a list which calls the <code>message</code> function.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">(let ((zebra &quot;stripes&quot;)</span><br><span class="line">      (tiger &quot;fierce&quot;))</span><br><span class="line">  (message &quot;One kind of animal has %s and another is %s.&quot;</span><br><span class="line">           zebra tiger))</span><br></pre></td></tr></table></figure>
<p>Here, the varlist is <code>((zebra &quot;stripes&quot;) (tiger &quot;fierce&quot;))</code>.</p>
<p>The two variables are <code>zebra</code> and <code>tiger</code>. Each variable is the first element of a two-element list and each value is the second element of its two-element list. In the varlist, Emacs binds the variable <code>zebra</code> to the value <code>&quot;stripes&quot;</code><a href="https://www.gnu.org/software/emacs/manual/html_mono/eintr.html#fn-9" target="_blank" rel="noopener">9</a>, and binds the variable <code>tiger</code> to the value <code>&quot;fierce&quot;</code>. In this example, both values are strings. The values could just as well have been another list or a symbol. The body of the <code>let</code> follows after the list holding the variables. In this example, the body is a list that uses the <code>message</code> function to print a string in the echo area.</p>
<p>You may evaluate the example in the usual fashion, by placing the cursor after the last parenthesis and typing C-x C-e. When you do this, the following will appear in the echo area:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&quot;One kind of animal has stripes and another is fierce.&quot;</span><br></pre></td></tr></table></figure>
<p>As we have seen before, the <code>message</code> function prints its first argument, except for ‘%s’. In this example, the value of the variable <code>zebra</code> is printed at the location of the first ‘%s’ and the value of the variable <code>tiger</code> is printed at the location of the second ‘%s’.</p>
<h4 id="3-6-3-Uninitialized-Variables-in-a-let-Statement"><a href="#3-6-3-Uninitialized-Variables-in-a-let-Statement" class="headerlink" title="3.6.3 Uninitialized Variables in a let Statement"></a>3.6.3 Uninitialized Variables in a <code>let</code> Statement</h4><p>If you do not bind the variables in a <code>let</code> statement to specific initial values, they will automatically be bound to an initial value of <code>nil</code>, as in the following expression:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">(let ((birch 3)</span><br><span class="line">      pine</span><br><span class="line">      fir</span><br><span class="line">      (oak &apos;some))</span><br><span class="line">  (message</span><br><span class="line">   &quot;Here are %d variables with %s, %s, and %s value.&quot;</span><br><span class="line">   birch pine fir oak))</span><br></pre></td></tr></table></figure>
<p>Here, the varlist is <code>((birch 3) pine fir (oak &#39;some))</code>.</p>
<p>If you evaluate this expression in the usual way, the following will appear in your echo area:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&quot;Here are 3 variables with nil, nil, and some value.&quot;</span><br></pre></td></tr></table></figure>
<p>In this example, Emacs binds the symbol <code>birch</code> to the number 3, binds the symbols <code>pine</code> and <code>fir</code> to <code>nil</code>, and binds the symbol <code>oak</code> to the value <code>some</code>.</p>
<p>Note that in the first part of the <code>let</code>, the variables <code>pine</code> and <code>fir</code> stand alone as atoms that are not surrounded by parentheses; this is because they are being bound to <code>nil</code>, the empty list. But <code>oak</code> is bound to <code>some</code> and so is a part of the list <code>(oak &#39;some)</code>. Similarly, <code>birch</code> is bound to the number 3 and so is in a list with that number. (Since a number evaluates to itself, the number does not need to be quoted. Also, the number is printed in the message using a ‘%d’ rather than a ‘%s’.) The four variables as a group are put into a list to delimit them from the body of the <code>let</code>.</p>
<h3 id="3-7-The-if-Special-Form"><a href="#3-7-The-if-Special-Form" class="headerlink" title="3.7 The if Special Form"></a>3.7 The <code>if</code> Special Form</h3><p>A third special form, in addition to <code>defun</code> and <code>let</code>, is the conditional <code>if</code>. This form is used to instruct the computer to make decisions. You can write function definitions without using <code>if</code>, but it is used often enough, and is important enough, to be included here. It is used, for example, in the code for the function <code>beginning-of-buffer</code>.</p>
<p>The basic idea behind an <code>if</code>, is that <em>if</em> a test is true, <em>then</em> an expression is evaluated. If the test is not true, the expression is not evaluated. For example, you might make a decision such as, “if it is warm and sunny, then go to the beach!”</p>
<ul>
<li><a href="https://www.gnu.org/software/emacs/manual/html_mono/eintr.html#if-in-more-detail" target="_blank" rel="noopener">if in more detail</a></li>
</ul>
<h4 id="if-in-more-detail"><a href="#if-in-more-detail" class="headerlink" title="if in more detail"></a><code>if</code> in more detail</h4><p>An <code>if</code> expression written in Lisp does not use the word “then”; the test and the action are the second and third elements of the list whose first element is <code>if</code>. Nonetheless, the test part of an <code>if</code> expression is often called the if-part and the second argument is often called the then-part.</p>
<p>Also, when an <code>if</code> expression is written, the true-or-false-test is usually written on the same line as the symbol <code>if</code>, but the action to carry out if the test is true, the then-part, is written on the second and subsequent lines. This makes the <code>if</code> expression easier to read.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">(if true-or-false-test</span><br><span class="line">    action-to-carry-out-if-test-is-true)</span><br></pre></td></tr></table></figure>
<p>The true-or-false-test will be an expression that is evaluated by the Lisp interpreter.</p>
<p>Here is an example that you can evaluate in the usual manner. The test is whether the number 5 is greater than the number 4. Since it is, the message ‘5 is greater than 4!’ will be printed.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">(if (&gt; 5 4)                             ; if-part</span><br><span class="line">    (message &quot;5 is greater than 4!&quot;))   ; then-part</span><br></pre></td></tr></table></figure>
<p>(The function <code>&gt;</code> tests whether its first argument is greater than its second argument and returns true if it is.) Of course, in actual use, the test in an <code>if</code> expression will not be fixed for all time as it is by the expression <code>(&gt; 5 4)</code>. Instead, at least one of the variables used in the test will be bound to a value that is not known ahead of time. (If the value were known ahead of time, we would not need to run the test!)</p>
<p>For example, the value may be bound to an argument of a function definition. In the following function definition, the character of the animal is a value that is passed to the function. If the value bound to <code>characteristic</code> is <code>&quot;fierce&quot;</code>, then the message, ‘It is a tiger!’ will be printed; otherwise, <code>nil</code> will be returned.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">(defun type-of-animal (characteristic)</span><br><span class="line">  &quot;Print message in echo area depending on CHARACTERISTIC.</span><br><span class="line">If the CHARACTERISTIC is the string \&quot;fierce\&quot;,</span><br><span class="line">then warn of a tiger.&quot;</span><br><span class="line">  (if (equal characteristic &quot;fierce&quot;)</span><br><span class="line">      (message &quot;It is a tiger!&quot;)))</span><br></pre></td></tr></table></figure>
<p>If you are reading this inside of GNU Emacs, you can evaluate the function definition in the usual way to install it in Emacs, and then you can evaluate the following two expressions to see the results:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">(type-of-animal &quot;fierce&quot;)</span><br><span class="line"></span><br><span class="line">(type-of-animal &quot;striped&quot;)</span><br></pre></td></tr></table></figure>
<p>When you evaluate <code>(type-of-animal &quot;fierce&quot;)</code>, you will see the following message printed in the echo area: <code>&quot;It is a tiger!&quot;</code>; and when you evaluate <code>(type-of-animal &quot;striped&quot;)</code> you will see <code>nil</code> printed in the echo area.</p>
<h4 id="if-in-more-detail-1"><a href="#if-in-more-detail-1" class="headerlink" title="if in more detail"></a><code>if</code> in more detail</h4><p>An <code>if</code> expression written in Lisp does not use the word “then”; the test and the action are the second and third elements of the list whose first element is <code>if</code>. Nonetheless, the test part of an <code>if</code> expression is often called the if-part and the second argument is often called the then-part.</p>
<p>Also, when an <code>if</code> expression is written, the true-or-false-test is usually written on the same line as the symbol <code>if</code>, but the action to carry out if the test is true, the then-part, is written on the second and subsequent lines. This makes the <code>if</code> expression easier to read.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">(if true-or-false-test</span><br><span class="line">    action-to-carry-out-if-test-is-true)</span><br></pre></td></tr></table></figure>
<p>The true-or-false-test will be an expression that is evaluated by the Lisp interpreter.</p>
<p>Here is an example that you can evaluate in the usual manner. The test is whether the number 5 is greater than the number 4. Since it is, the message ‘5 is greater than 4!’ will be printed.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">(if (&gt; 5 4)                             ; if-part</span><br><span class="line">    (message &quot;5 is greater than 4!&quot;))   ; then-part</span><br></pre></td></tr></table></figure>
<p>(The function <code>&gt;</code> tests whether its first argument is greater than its second argument and returns true if it is.) Of course, in actual use, the test in an <code>if</code> expression will not be fixed for all time as it is by the expression <code>(&gt; 5 4)</code>. Instead, at least one of the variables used in the test will be bound to a value that is not known ahead of time. (If the value were known ahead of time, we would not need to run the test!)</p>
<p>For example, the value may be bound to an argument of a function definition. In the following function definition, the character of the animal is a value that is passed to the function. If the value bound to <code>characteristic</code> is <code>&quot;fierce&quot;</code>, then the message, ‘It is a tiger!’ will be printed; otherwise, <code>nil</code> will be returned.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">(defun type-of-animal (characteristic)</span><br><span class="line">  &quot;Print message in echo area depending on CHARACTERISTIC.</span><br><span class="line">If the CHARACTERISTIC is the string \&quot;fierce\&quot;,</span><br><span class="line">then warn of a tiger.&quot;</span><br><span class="line">  (if (equal characteristic &quot;fierce&quot;)</span><br><span class="line">      (message &quot;It is a tiger!&quot;)))</span><br></pre></td></tr></table></figure>
<p>If you are reading this inside of GNU Emacs, you can evaluate the function definition in the usual way to install it in Emacs, and then you can evaluate the following two expressions to see the results:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">(type-of-animal &quot;fierce&quot;)</span><br><span class="line"></span><br><span class="line">(type-of-animal &quot;striped&quot;)</span><br></pre></td></tr></table></figure>
<p>When you evaluate <code>(type-of-animal &quot;fierce&quot;)</code>, you will see the following message printed in the echo area: <code>&quot;It is a tiger!&quot;</code>; and when you evaluate <code>(type-of-animal &quot;striped&quot;)</code> you will see <code>nil</code> printed in the echo area.</p>
<h4 id="3-7-1-The-type-of-animal-Function-in-Detail"><a href="#3-7-1-The-type-of-animal-Function-in-Detail" class="headerlink" title="3.7.1 The type-of-animal Function in Detail"></a>3.7.1 The <code>type-of-animal</code> Function in Detail</h4><p>Let’s look at the <code>type-of-animal</code> function in detail.</p>
<p>The function definition for <code>type-of-animal</code> was written by filling the slots of two templates, one for a function definition as a whole, and a second for an <code>if</code> expression.</p>
<p>The template for every function that is not interactive is:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">(defun name-of-function (argument-list)</span><br><span class="line">  &quot;documentation...&quot;</span><br><span class="line">  body...)</span><br></pre></td></tr></table></figure>
<p>The parts of the function that match this template look like this:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">(defun type-of-animal (characteristic)</span><br><span class="line">  &quot;Print message in echo area depending on CHARACTERISTIC.</span><br><span class="line">If the CHARACTERISTIC is the string \&quot;fierce\&quot;,</span><br><span class="line">then warn of a tiger.&quot;</span><br><span class="line">  body: the if expression)</span><br></pre></td></tr></table></figure>
<p>The name of function is <code>type-of-animal</code>; it is passed the value of one argument. The argument list is followed by a multi-line documentation string. The documentation string is included in the example because it is a good habit to write documentation string for every function definition. The body of the function definition consists of the <code>if</code> expression.</p>
<p>The template for an <code>if</code> expression looks like this:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">(if true-or-false-test</span><br><span class="line">    action-to-carry-out-if-the-test-returns-true)</span><br></pre></td></tr></table></figure>
<p>In the <code>type-of-animal</code> function, the code for the <code>if</code> looks like this:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">(if (equal characteristic &quot;fierce&quot;)</span><br><span class="line">    (message &quot;It is a tiger!&quot;)))</span><br></pre></td></tr></table></figure>
<p>Here, the true-or-false-test is the expression:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(equal characteristic &quot;fierce&quot;)</span><br></pre></td></tr></table></figure>
<p>In Lisp, <code>equal</code> is a function that determines whether its first argument is equal to its second argument. The second argument is the string <code>&quot;fierce&quot;</code> and the first argument is the value of the symbol <code>characteristic</code>—in other words, the argument passed to this function.</p>
<p>In the first exercise of <code>type-of-animal</code>, the argument <code>&quot;fierce&quot;</code> is passed to <code>type-of-animal</code>. Since <code>&quot;fierce&quot;</code> is equal to <code>&quot;fierce&quot;</code>, the expression, <code>(equal characteristic &quot;fierce&quot;)</code>, returns a value of true. When this happens, the <code>if</code> evaluates the second argument or then-part of the <code>if</code>: <code>(message &quot;It is a tiger!&quot;)</code>.</p>
<p>On the other hand, in the second exercise of <code>type-of-animal</code>, the argument <code>&quot;striped&quot;</code> is passed to <code>type-of-animal</code>. <code>&quot;striped&quot;</code> is not equal to <code>&quot;fierce&quot;</code>, so the then-part is not evaluated and <code>nil</code> is returned by the <code>if</code> expression.</p>
<h3 id="3-8-If–then–else-Expressions"><a href="#3-8-If–then–else-Expressions" class="headerlink" title="3.8 If–then–else Expressions"></a>3.8 If–then–else Expressions</h3><p>An <code>if</code> expression may have an optional third argument, called the else-part, for the case when the true-or-false-test returns false. When this happens, the second argument or then-part of the overall <code>if</code> expression is <em>not</em> evaluated, but the third or else-part <em>is</em> evaluated. You might think of this as the cloudy day alternative for the decision “if it is warm and sunny, then go to the beach, else read a book!”.</p>
<p>The word “else” is not written in the Lisp code; the else-part of an <code>if</code> expression comes after the then-part. In the written Lisp, the else-part is usually written to start on a line of its own and is indented less than the then-part:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">(if true-or-false-test</span><br><span class="line">    action-to-carry-out-if-the-test-returns-true</span><br><span class="line">  action-to-carry-out-if-the-test-returns-false)</span><br></pre></td></tr></table></figure>
<p>For example, the following <code>if</code> expression prints the message ‘4 is not greater than 5!’ when you evaluate it in the usual way:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">(if (&gt; 4 5)                               ; if-part</span><br><span class="line">    (message &quot;4 falsely greater than 5!&quot;) ; then-part</span><br><span class="line">  (message &quot;4 is not greater than 5!&quot;))   ; else-part</span><br></pre></td></tr></table></figure>
<p>Note that the different levels of indentation make it easy to distinguish the then-part from the else-part. (GNU Emacs has several commands that automatically indent <code>if</code> expressions correctly. See <a href="https://www.gnu.org/software/emacs/manual/html_mono/eintr.html#Typing-Lists" target="_blank" rel="noopener">GNU Emacs Helps You Type Lists</a>.)</p>
<p>We can extend the <code>type-of-animal</code> function to include an else-part by simply incorporating an additional part to the <code>if</code> expression.</p>
<p>You can see the consequences of doing this if you evaluate the following version of the <code>type-of-animal</code> function definition to install it and then evaluate the two subsequent expressions to pass different arguments to the function.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">(defun type-of-animal (characteristic)  ; Second version.</span><br><span class="line">  &quot;Print message in echo area depending on CHARACTERISTIC.</span><br><span class="line">If the CHARACTERISTIC is the string \&quot;fierce\&quot;,</span><br><span class="line">then warn of a tiger; else say it is not fierce.&quot;</span><br><span class="line">  (if (equal characteristic &quot;fierce&quot;)</span><br><span class="line">      (message &quot;It is a tiger!&quot;)</span><br><span class="line">    (message &quot;It is not fierce!&quot;)))</span><br><span class="line"></span><br><span class="line">(type-of-animal &quot;fierce&quot;)</span><br><span class="line"></span><br><span class="line">(type-of-animal &quot;striped&quot;)</span><br></pre></td></tr></table></figure>
<p>When you evaluate <code>(type-of-animal &quot;fierce&quot;)</code>, you will see the following message printed in the echo area: <code>&quot;It is a tiger!&quot;</code>; but when you evaluate <code>(type-of-animal &quot;striped&quot;)</code>, you will see <code>&quot;It is not fierce!&quot;</code>.</p>
<p>(Of course, if the characteristic were <code>&quot;ferocious&quot;</code>, the message <code>&quot;It is not fierce!&quot;</code> would be printed; and it would be misleading! When you write code, you need to take into account the possibility that some such argument will be tested by the <code>if</code> and write your program accordingly.)</p>
<h3 id="3-9-Truth-and-Falsehood-in-Emacs-Lisp"><a href="#3-9-Truth-and-Falsehood-in-Emacs-Lisp" class="headerlink" title="3.9 Truth and Falsehood in Emacs Lisp"></a>3.9 Truth and Falsehood in Emacs Lisp</h3><p>There is an important aspect to the truth test in an <code>if</code> expression. So far, we have spoken of “true” and “false” as values of predicates as if they were new kinds of Emacs Lisp objects. In fact, “false” is just our old friend <code>nil</code>. Anything else—anything at all—is “true”.</p>
<p>The expression that tests for truth is interpreted as true if the result of evaluating it is a value that is not <code>nil</code>. In other words, the result of the test is considered true if the value returned is a number such as 47, a string such as <code>&quot;hello&quot;</code>, or a symbol (other than <code>nil</code>) such as <code>flowers</code>, or a list (so long as it is not empty), or even a buffer!</p>
<ul>
<li><a href="https://www.gnu.org/software/emacs/manual/html_mono/eintr.html#nil-explained" target="_blank" rel="noopener">nil explained</a>: <code>nil</code> has two meanings.</li>
</ul>
<h4 id="An-explanation-of-nil"><a href="#An-explanation-of-nil" class="headerlink" title="An explanation of nil"></a>An explanation of <code>nil</code></h4><p>Before illustrating a test for truth, we need an explanation of <code>nil</code>.</p>
<p>In Emacs Lisp, the symbol <code>nil</code> has two meanings. First, it means the empty list. Second, it means false and is the value returned when a true-or-false-test tests false. <code>nil</code> can be written as an empty list, <code>()</code>, or as <code>nil</code>. As far as the Lisp interpreter is concerned, <code>()</code> and <code>nil</code> are the same. Humans, however, tend to use <code>nil</code> for false and <code>()</code> for the empty list.</p>
<p>In Emacs Lisp, any value that is not <code>nil</code>—is not the empty list—is considered true. This means that if an evaluation returns something that is not an empty list, an <code>if</code> expression will test true. For example, if a number is put in the slot for the test, it will be evaluated and will return itself, since that is what numbers do when evaluated. In this conditional, the <code>if</code>expression will test true. The expression tests false only when <code>nil</code>, an empty list, is returned by evaluating the expression.</p>
<p>You can see this by evaluating the two expressions in the following examples.</p>
<p>In the first example, the number 4 is evaluated as the test in the <code>if</code> expression and returns itself; consequently, the then-part of the expression is evaluated and returned: ‘true’ appears in the echo area. In the second example, the <code>nil</code> indicates false; consequently, the else-part of the expression is evaluated and returned: ‘false’ appears in the echo area.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">(if 4</span><br><span class="line">    &apos;true</span><br><span class="line">  &apos;false)</span><br><span class="line"></span><br><span class="line">(if nil</span><br><span class="line">    &apos;true</span><br><span class="line">  &apos;false)</span><br></pre></td></tr></table></figure>
<p>Incidentally, if some other useful value is not available for a test that returns true, then the Lisp interpreter will return the symbol <code>t</code> for true. For example, the expression <code>(&gt; 5 4)</code>returns <code>t</code> when evaluated, as you can see by evaluating it in the usual way:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(&gt; 5 4)</span><br></pre></td></tr></table></figure>
<p>On the other hand, this function returns <code>nil</code> if the test is false.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(&gt; 4 5)</span><br></pre></td></tr></table></figure>
<h4 id="An-explanation-of-nil-1"><a href="#An-explanation-of-nil-1" class="headerlink" title="An explanation of nil"></a>An explanation of <code>nil</code></h4><p>Before illustrating a test for truth, we need an explanation of <code>nil</code>.</p>
<p>In Emacs Lisp, the symbol <code>nil</code> has two meanings. First, it means the empty list. Second, it means false and is the value returned when a true-or-false-test tests false. <code>nil</code> can be written as an empty list, <code>()</code>, or as <code>nil</code>. As far as the Lisp interpreter is concerned, <code>()</code> and <code>nil</code> are the same. Humans, however, tend to use <code>nil</code> for false and <code>()</code> for the empty list.</p>
<p>In Emacs Lisp, any value that is not <code>nil</code>—is not the empty list—is considered true. This means that if an evaluation returns something that is not an empty list, an <code>if</code> expression will test true. For example, if a number is put in the slot for the test, it will be evaluated and will return itself, since that is what numbers do when evaluated. In this conditional, the <code>if</code>expression will test true. The expression tests false only when <code>nil</code>, an empty list, is returned by evaluating the expression.</p>
<p>You can see this by evaluating the two expressions in the following examples.</p>
<p>In the first example, the number 4 is evaluated as the test in the <code>if</code> expression and returns itself; consequently, the then-part of the expression is evaluated and returned: ‘true’ appears in the echo area. In the second example, the <code>nil</code> indicates false; consequently, the else-part of the expression is evaluated and returned: ‘false’ appears in the echo area.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">(if 4</span><br><span class="line">    &apos;true</span><br><span class="line">  &apos;false)</span><br><span class="line"></span><br><span class="line">(if nil</span><br><span class="line">    &apos;true</span><br><span class="line">  &apos;false)</span><br></pre></td></tr></table></figure>
<p>Incidentally, if some other useful value is not available for a test that returns true, then the Lisp interpreter will return the symbol <code>t</code> for true. For example, the expression <code>(&gt; 5 4)</code>returns <code>t</code> when evaluated, as you can see by evaluating it in the usual way:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(&gt; 5 4)</span><br></pre></td></tr></table></figure>
<p>On the other hand, this function returns <code>nil</code> if the test is false.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(&gt; 4 5)</span><br></pre></td></tr></table></figure>
<h4 id="Point-and-Mark"><a href="#Point-and-Mark" class="headerlink" title="Point and Mark"></a>Point and Mark</h4><p>Before discussing <code>save-excursion</code>, however, it may be useful first to review what point and mark are in GNU Emacs. Point is the current location of the cursor. Wherever the cursor is, that is point. More precisely, on terminals where the cursor appears to be on top of a character, point is immediately before the character. In Emacs Lisp, point is an integer. The first character in a buffer is number one, the second is number two, and so on. The function <code>point</code> returns the current position of the cursor as a number. Each buffer has its own value for point.</p>
<p>The mark is another position in the buffer; its value can be set with a command such as C-<spc> (<code>set-mark-command</code>). If a mark has been set, you can use the command C-x C-x(<code>exchange-point-and-mark</code>) to cause the cursor to jump to the mark and set the mark to be the previous position of point. In addition, if you set another mark, the position of the previous mark is saved in the mark ring. Many mark positions can be saved this way. You can jump the cursor to a saved mark by typing C-u C-<spc> one or more times.</spc></spc></p>
<p>The part of the buffer between point and mark is called the region. Numerous commands work on the region, including <code>center-region</code>, <code>count-lines-region</code>, <code>kill-region</code>, and<code>print-region</code>.</p>
<p>The <code>save-excursion</code> special form saves the location of point and restores this position after the code within the body of the special form is evaluated by the Lisp interpreter. Thus, if point were in the beginning of a piece of text and some code moved point to the end of the buffer, the <code>save-excursion</code> would put point back to where it was before, after the expressions in the body of the function were evaluated.</p>
<p>In Emacs, a function frequently moves point as part of its internal workings even though a user would not expect this. For example, <code>count-lines-region</code> moves point. To prevent the user from being bothered by jumps that are both unexpected and (from the user’s point of view) unnecessary, <code>save-excursion</code> is often used to keep point in the location expected by the user. The use of <code>save-excursion</code> is good housekeeping.</p>
<p>To make sure the house stays clean, <code>save-excursion</code> restores the value of point even if something goes wrong in the code inside of it (or, to be more precise and to use the proper jargon, “in case of abnormal exit”). This feature is very helpful.</p>
<p>In addition to recording the value of point, <code>save-excursion</code> keeps track of the current buffer, and restores it, too. This means you can write code that will change the buffer and have <code>save-excursion</code> switch you back to the original buffer. This is how <code>save-excursion</code> is used in <code>append-to-buffer</code>. (See <a href="https://www.gnu.org/software/emacs/manual/html_mono/eintr.html#append_002dto_002dbuffer" target="_blank" rel="noopener">The Definition of <code>append-to-buffer</code></a>.)</p>
<h4 id="3-10-1-Template-for-a-save-excursion-Expression"><a href="#3-10-1-Template-for-a-save-excursion-Expression" class="headerlink" title="3.10.1 Template for a save-excursion Expression"></a>3.10.1 Template for a <code>save-excursion</code> Expression</h4><p>The template for code using <code>save-excursion</code> is simple:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">(save-excursion</span><br><span class="line">  body...)</span><br></pre></td></tr></table></figure>
<p>The body of the function is one or more expressions that will be evaluated in sequence by the Lisp interpreter. If there is more than one expression in the body, the value of the last one will be returned as the value of the <code>save-excursion</code> function. The other expressions in the body are evaluated only for their side effects; and <code>save-excursion</code> itself is used only for its side effect (which is restoring the position of point).</p>
<p>In more detail, the template for a <code>save-excursion</code> expression looks like this:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">(save-excursion</span><br><span class="line">  first-expression-in-body</span><br><span class="line">  second-expression-in-body</span><br><span class="line">  third-expression-in-body</span><br><span class="line">   ...</span><br><span class="line">  last-expression-in-body)</span><br></pre></td></tr></table></figure>
<p>An expression, of course, may be a symbol on its own or a list.</p>
<p>In Emacs Lisp code, a <code>save-excursion</code> expression often occurs within the body of a <code>let</code> expression. It looks like this:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">(let varlist</span><br><span class="line">  (save-excursion</span><br><span class="line">    body...))</span><br></pre></td></tr></table></figure>
<h3 id="3-11-Review"><a href="#3-11-Review" class="headerlink" title="3.11 Review"></a>3.11 Review</h3><p>In the last few chapters we have introduced a macro and a fair number of functions and special forms. Here they are described in brief, along with a few similar functions that have not been mentioned yet.</p>
<ul>
<li><p><code>eval-last-sexp</code></p>
<p>Evaluate the last symbolic expression before the current location of point. The value is printed in the echo area unless the function is invoked with an argument; in that case, the output is printed in the current buffer. This command is normally bound to C-x C-e.  </p>
</li>
<li><p><code>defun</code></p>
<p>Define function. This macro has up to five parts: the name, a template for the arguments that will be passed to the function, documentation, an optional interactive declaration, and the body of the definition.For example, in Emacs the function definition of <code>dired-unmark-all-marks</code> is as follows.<code>(defun dired-unmark-all-marks ()             &quot;Remove all marks from all files in the Dired buffer.&quot;             (interactive)             (dired-unmark-all-files ?\r))</code> </p>
</li>
<li><p><code>interactive</code></p>
<p>Declare to the interpreter that the function can be used interactively. This special form may be followed by a string with one or more parts that pass the information to the arguments of the function, in sequence. These parts may also tell the interpreter to prompt for information. Parts of the string are separated by newlines, ‘\n’.Common code characters are:<code>b</code>The name of an existing buffer.  <code>f</code>The name of an existing file.  <code>p</code>The numeric prefix argument. (Note that this <code>p</code> is lower case.)  <code>r</code>Point and the mark, as two numeric arguments, smallest first. This is the only code letter that specifies two successive arguments rather than one.See <a href="https://www.gnu.org/software/emacs/manual/html_mono/elisp.html#Interactive-Codes" target="_blank" rel="noopener">Code Characters for ‘interactive’</a>, for a complete list of code characters.  </p>
</li>
<li><p><code>let</code></p>
<p>Declare that a list of variables is for use within the body of the <code>let</code> and give them an initial value, either <code>nil</code> or a specified value; then evaluate the rest of the expressions in the body of the <code>let</code> and return the value of the last one. Inside the body of the <code>let</code>, the Lisp interpreter does not see the values of the variables of the same names that are bound outside of the <code>let</code>.For example,<code>(let ((foo (buffer-name))                 (bar (buffer-size)))             (message              &quot;This buffer is %s and has %d characters.&quot;              foo bar))</code> </p>
</li>
<li><p><code>save-excursion</code></p>
<p>Record the values of point and the current buffer before evaluating the body of this special form. Restore the value of point and buffer afterward.For example,<code>(message &quot;We are %d characters into this buffer.&quot;                    (- (point)                       (save-excursion                         (goto-char (point-min)) (point))))</code> </p>
</li>
<li><p><code>if</code></p>
<p>Evaluate the first argument to the function; if it is true, evaluate the second argument; else evaluate the third argument, if there is one.The <code>if</code> special form is called a conditional. There are other conditionals in Emacs Lisp, but <code>if</code> is perhaps the most commonly used.For example,<code>(if (= 22 emacs-major-version)               (message &quot;This is version 22 Emacs&quot;)             (message &quot;This is not version 22 Emacs&quot;))</code> </p>
</li>
<li><p><code>&lt;</code></p>
</li>
<li><p><code>&gt;</code></p>
</li>
<li><p><code>&lt;=</code></p>
</li>
<li><p><code>&gt;=</code></p>
<p>The <code>&lt;</code> function tests whether its first argument is smaller than its second argument. A corresponding function, <code>&gt;</code>, tests whether the first argument is greater than the second. Likewise, <code>&lt;=</code> tests whether the first argument is less than or equal to the second and <code>&gt;=</code> tests whether the first argument is greater than or equal to the second. In all cases, both arguments must be numbers or markers (markers indicate positions in buffers).  </p>
</li>
<li><p><code>=</code></p>
<p>The <code>=</code> function tests whether two arguments, both numbers or markers, are equal.  </p>
</li>
<li><p><code>equal</code></p>
</li>
<li><p><code>eq</code></p>
<p>Test whether two objects are the same. <code>equal</code> uses one meaning of the word “same” and <code>eq</code> uses another: <code>equal</code> returns true if the two objects have a similar structure and contents, such as two copies of the same book. On the other hand, <code>eq</code>, returns true if both arguments are actually the same object.  </p>
</li>
<li><p><code>string&lt;</code></p>
</li>
<li><p><code>string-lessp</code></p>
</li>
<li><p><code>string=</code></p>
</li>
<li><p><code>string-equal</code></p>
<p>The <code>string-lessp</code> function tests whether its first argument is smaller than the second argument. A shorter, alternative name for the same function (a <code>defalias</code>) is <code>string&lt;</code>.The arguments to <code>string-lessp</code> must be strings or symbols; the ordering is lexicographic, so case is significant. The print names of symbols are used instead of the symbols themselves.An empty string, ‘“”’, a string with no characters in it, is smaller than any string of characters.<code>string-equal</code> provides the corresponding test for equality. Its shorter, alternative name is <code>string=</code>. There are no string test functions that correspond to &gt;, <code>&gt;=</code>, or <code>&lt;=</code>.  </p>
</li>
<li><p><code>message</code></p>
<p>Print a message in the echo area. The first argument is a string that can contain ‘%s’, ‘%d’, or ‘%c’ to print the value of arguments that follow the string. The argument used by ‘%s’ must be a string or a symbol; the argument used by ‘%d’ must be a number. The argument used by ‘%c’ must be an ascii code number; it will be printed as the character with that ascii code. (Various other %-sequences have not been mentioned.)  </p>
</li>
<li><p><code>setq</code></p>
</li>
<li><p><code>set</code></p>
<p>The <code>setq</code> function sets the value of its first argument to the value of the second argument. The first argument is automatically quoted by <code>setq</code>. It does the same for succeeding pairs of arguments. Another function, <code>set</code>, takes only two arguments and evaluates both of them before setting the value returned by its first argument to the value returned by its second argument.  </p>
</li>
<li><p><code>buffer-name</code></p>
<p>Without an argument, return the name of the buffer, as a string.  </p>
</li>
<li><p><code>buffer-file-name</code></p>
<p>Without an argument, return the name of the file the buffer is visiting.  </p>
</li>
<li><p><code>current-buffer</code></p>
<p>Return the buffer in which Emacs is active; it may not be the buffer that is visible on the screen.  </p>
</li>
<li><p><code>other-buffer</code></p>
<p>Return the most recently selected buffer (other than the buffer passed to <code>other-buffer</code> as an argument and other than the current buffer).  </p>
</li>
<li><p><code>switch-to-buffer</code></p>
<p>Select a buffer for Emacs to be active in and display it in the current window so users can look at it. Usually bound to C-x b.  </p>
</li>
<li><p><code>set-buffer</code></p>
<p>Switch Emacs’s attention to a buffer on which programs will run. Don’t alter what the window is showing.  </p>
</li>
<li><p><code>buffer-size</code></p>
<p>Return the number of characters in the current buffer.  </p>
</li>
<li><p><code>point</code></p>
<p>Return the value of the current position of the cursor, as an integer counting the number of characters from the beginning of the buffer.  </p>
</li>
<li><p><code>point-min</code></p>
<p>Return the minimum permissible value of point in the current buffer. This is 1, unless narrowing is in effect.  </p>
</li>
<li><p><code>point-max</code></p>
<p>Return the value of the maximum permissible value of point in the current buffer. This is the end of the buffer, unless narrowing is in effect.</p>
</li>
</ul>
<h3 id="3-12-Exercises"><a href="#3-12-Exercises" class="headerlink" title="3.12 Exercises"></a>3.12 Exercises</h3><ul>
<li>Write a non-interactive function that doubles the value of its argument, a number. Make that function interactive.</li>
<li>Write a function that tests whether the current value of <code>fill-column</code> is greater than the argument passed to the function, and if so, prints an appropriate message.</li>
</ul>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://alphaalgorithms.github.io/2019/06/11/elisp-list-practise/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Gabriel">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="DummyHead">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                
                <a href="/2019/06/11/elisp-list-practise/" class="post-title-link" itemprop="url">Intro to Elisp 2. Practicing Evaluation</a>
              
            
          </h2>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2019-06-11 09:13:32 / Modified: 09:30:13" itemprop="dateCreated datePublished" datetime="2019-06-11T09:13:32+08:00">2019-06-11</time>
            

            
              

              
            
          </span>

          

          
            
            
              
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
            
                <span class="post-meta-item-text">Comments: </span>
                <a href="/2019/06/11/elisp-list-practise/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2019/06/11/elisp-list-practise/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>Before learning how to write a function definition in Emacs Lisp, it is useful to spend a little time evaluating various expressions that have already been written. These expressions will be lists with the functions as their first (and often only) element. Since some of the functions associated with buffers are both simple and interesting, we will start with those. In this section, we will evaluate a few of these. In another section, we will study the code of several other buffer-related functions, to see how they were written.</p>
<ul>
<li><a href="https://www.gnu.org/software/emacs/manual/html_mono/eintr.html#How-to-Evaluate" target="_blank" rel="noopener">How to Evaluate</a>: Typing editing commands or C-x C-e causes evaluation.</li>
<li><a href="https://www.gnu.org/software/emacs/manual/html_mono/eintr.html#Buffer-Names" target="_blank" rel="noopener">Buffer Names</a>: Buffers and files are different.</li>
<li><a href="https://www.gnu.org/software/emacs/manual/html_mono/eintr.html#Getting-Buffers" target="_blank" rel="noopener">Getting Buffers</a>: Getting a buffer itself, not merely its name.</li>
<li><a href="https://www.gnu.org/software/emacs/manual/html_mono/eintr.html#Switching-Buffers" target="_blank" rel="noopener">Switching Buffers</a>: How to change to another buffer.</li>
<li><a href="https://www.gnu.org/software/emacs/manual/html_mono/eintr.html#Buffer-Size-_0026-Locations" target="_blank" rel="noopener">Buffer Size &amp; Locations</a>: Where point is located and the size of the buffer.</li>
<li><a href="https://www.gnu.org/software/emacs/manual/html_mono/eintr.html#Evaluation-Exercise" target="_blank" rel="noopener">Evaluation Exercise</a></li>
</ul>
<h3 id="How-to-Evaluate"><a href="#How-to-Evaluate" class="headerlink" title="How to Evaluate"></a>How to Evaluate</h3><p><em>Whenever you give an editing command</em> to Emacs Lisp, such as the command to move the cursor or to scroll the screen, <em>you are evaluating an expression,</em> the first element of which is a function. <em>This is how Emacs works.</em></p>
<p>When you type keys, you cause the Lisp interpreter to evaluate an expression and that is how you get your results. Even typing plain text involves evaluating an Emacs Lisp function, in this case, one that uses <code>self-insert-command</code>, which simply inserts the character you typed. The functions you evaluate by typing keystrokes are called interactivefunctions, or commands; how you make a function interactive will be illustrated in the chapter on how to write function definitions. See <a href="https://www.gnu.org/software/emacs/manual/html_mono/eintr.html#Interactive" target="_blank" rel="noopener">Making a Function Interactive</a>.</p>
<p>In addition to typing keyboard commands, we have seen a second way to evaluate an expression: by positioning the cursor after a list and typing C-x C-e. This is what we will do in the rest of this section. There are other ways to evaluate an expression as well; these will be described as we come to them.</p>
<p>Besides being used for practicing evaluation, the functions shown in the next few sections are important in their own right. A study of these functions makes clear the distinction between buffers and files, how to switch to a buffer, and how to determine a location within it.</p>
<h3 id="2-1-Buffer-Names"><a href="#2-1-Buffer-Names" class="headerlink" title="2.1 Buffer Names"></a>2.1 Buffer Names</h3><p>The two functions, <code>buffer-name</code> and <code>buffer-file-name</code>, show the difference between a file and a buffer. When you evaluate the following expression, <code>(buffer-name)</code>, the name of the buffer appears in the echo area. When you evaluate <code>(buffer-file-name)</code>, the name of the file to which the buffer refers appears in the echo area. Usually, the name returned by <code>(buffer-name)</code> is the same as the name of the file to which it refers, and the name returned by <code>(buffer-file-name)</code> is the full path-name of the file.</p>
<p>A file and a buffer are two different entities. A file is information recorded permanently in the computer (unless you delete it). A buffer, on the other hand, is information inside of Emacs that will vanish at the end of the editing session (or when you kill the buffer). Usually, a buffer contains information that you have copied from a file; we say the buffer is visiting that file. This copy is what you work on and modify. Changes to the buffer do not change the file, until you save the buffer. When you save the buffer, the buffer is copied to the file and is thus saved permanently.</p>
<p>If you are reading this in Info inside of GNU Emacs, you can evaluate each of the following expressions by positioning the cursor after it and typing C-x C-e.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">(buffer-name)</span><br><span class="line"></span><br><span class="line">(buffer-file-name)</span><br></pre></td></tr></table></figure>
<p>When I do this in Info, the value returned by evaluating <code>(buffer-name)</code> is “<em>info</em>“, and the value returned by evaluating <code>(buffer-file-name)</code> is nil.</p>
<p>On the other hand, while I am writing this document, the value returned by evaluating <code>(buffer-name)</code> is “introduction.texinfo”, and the value returned by evaluating <code>(buffer-file-name)</code> is “/gnu/work/intro/introduction.texinfo”.</p>
<p>The former is the name of the buffer and the latter is the name of the file. In Info, the buffer name is “<em>info</em>“. Info does not point to any file, so the result of evaluating <code>(buffer-file-name)</code> is nil. The symbol <code>nil</code> is from the Latin word for “nothing”; in this case, it means that the buffer is not associated with any file. (In Lisp, <code>nil</code> is also used to mean “false” and is a synonym for the empty list, <code>()</code>.)</p>
<p>When I am writing, the name of my buffer is “introduction.texinfo”. The name of the file to which it points is “/gnu/work/intro/introduction.texinfo”.</p>
<p>(In the expressions, the parentheses tell the Lisp interpreter to treat <code>buffer-name</code> and <code>buffer-file-name</code> as functions; without the parentheses, the interpreter would attempt to evaluate the symbols as variables. See <a href="https://www.gnu.org/software/emacs/manual/html_mono/eintr.html#Variables" target="_blank" rel="noopener">Variables</a>.)</p>
<p>In spite of the distinction between files and buffers, you will often find that people refer to a file when they mean a buffer and vice versa. Indeed, most people say, “I am editing a file,” rather than saying, “I am editing a buffer which I will soon save to a file.” It is almost always clear from context what people mean. When dealing with computer programs, however, it is important to keep the distinction in mind, since the computer is not as smart as a person.</p>
<p>The word “buffer”, by the way, comes from the meaning of the word as a cushion that deadens the force of a collision. In early computers, a buffer cushioned the interaction between files and the computer’s central processing unit. The drums or tapes that held a file and the central processing unit were pieces of equipment that were very different from each other, working at their own speeds, in spurts. The buffer made it possible for them to work together effectively. Eventually, the buffer grew from being an intermediary, a temporary holding place, to being the place where work is done. This transformation is rather like that of a small seaport that grew into a great city: once it was merely the place where cargo was warehoused temporarily before being loaded onto ships; then it became a business and cultural center in its own right.</p>
<p>Not all buffers are associated with files. For example, a <em>scratch</em> buffer does not visit any file. Similarly, a <em>Help</em> buffer is not associated with any file.</p>
<p>In the old days, when you lacked a ~/.emacs file and started an Emacs session by typing the command <code>emacs</code> alone, without naming any files, Emacs started with the <em>scratch</em>buffer visible. Nowadays, you will see a splash screen. You can follow one of the commands suggested on the splash screen, visit a file, or press q to quit the splash screen and reach the <em>scratch</em> buffer.</p>
<p>If you switch to the <em>scratch</em> buffer, type <code>(buffer-name)</code>, position the cursor after it, and then type C-x C-e to evaluate the expression. The name <code>&quot;*scratch*&quot;</code> will be returned and will appear in the echo area. <code>&quot;*scratch*&quot;</code> is the name of the buffer. When you type <code>(buffer-file-name)</code> in the <em>scratch</em> buffer and evaluate that, <code>nil</code> will appear in the echo area, just as it does when you evaluate <code>(buffer-file-name)</code> in Info.</p>
<p>Incidentally, if you are in the <em>scratch</em> buffer and want the value returned by an expression to appear in the <em>scratch</em> buffer itself rather than in the echo area, type C-u C-x C-e instead of C-x C-e. This causes the value returned to appear after the expression. The buffer will look like this:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(buffer-name)&quot;*scratch*&quot;</span><br></pre></td></tr></table></figure>
<p>You cannot do this in Info since Info is read-only and it will not allow you to change the contents of the buffer. But you can do this in any buffer you can edit; and when you write code or documentation (such as this book), this feature is very useful.</p>
<h3 id="2-2-Getting-Buffers"><a href="#2-2-Getting-Buffers" class="headerlink" title="2.2 Getting Buffers"></a>2.2 Getting Buffers</h3><p>The <code>buffer-name</code> function returns the <em>name</em> of the buffer; to get the buffer <em>itself</em>, a different function is needed: the <code>current-buffer</code> function. If you use this function in code, what you get is the buffer itself.</p>
<p>A name and the object or entity to which the name refers are different from each other. You are not your name. You are a person to whom others refer by name. If you ask to speak to George and someone hands you a card with the letters ‘G’, ‘e’, ‘o’, ‘r’, ‘g’, and ‘e’ written on it, you might be amused, but you would not be satisfied. You do not want to speak to the name, but to the person to whom the name refers. A buffer is similar: the name of the scratch buffer is <em>scratch</em>, but the name is not the buffer. To get a buffer itself, you need to use a function such as <code>current-buffer</code>.</p>
<p>However, there is a slight complication: if you evaluate <code>current-buffer</code> in an expression on its own, as we will do here, what you see is a printed representation of the name of the buffer without the contents of the buffer. Emacs works this way for two reasons: the buffer may be thousands of lines long—too long to be conveniently displayed; and, another buffer may have the same contents but a different name, and it is important to distinguish between them.</p>
<p>Here is an expression containing the function:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(current-buffer)</span><br></pre></td></tr></table></figure>
<p>If you evaluate this expression in Info in Emacs in the usual way, #<buffer *info*> will appear in the echo area. The special format indicates that the buffer itself is being returned, rather than just its name.</buffer></p>
<p>Incidentally, while you can type a number or symbol into a program, you cannot do that with the printed representation of a buffer: the only way to get a buffer itself is with a function such as <code>current-buffer</code>.</p>
<p>A related function is <code>other-buffer</code>. This returns the most recently selected buffer other than the one you are in currently, not a printed representation of its name. If you have recently switched back and forth from the <em>scratch</em> buffer, <code>other-buffer</code> will return that buffer.</p>
<p>You can see this by evaluating the expression:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(other-buffer)</span><br></pre></td></tr></table></figure>
<p>You should see #<buffer *scratch*> appear in the echo area, or the name of whatever other buffer you switched back from most recently<a href="https://www.gnu.org/software/emacs/manual/html_mono/eintr.html#fn-6" target="_blank" rel="noopener">6</a>.</buffer></p>
<h3 id="2-3-Switching-Buffers"><a href="#2-3-Switching-Buffers" class="headerlink" title="2.3 Switching Buffers"></a>2.3 Switching Buffers</h3><p>The <code>other-buffer</code> function actually provides a buffer when it is used as an argument to a function that requires one. We can see this by using <code>other-buffer</code> and <code>switch-to-buffer</code> to switch to a different buffer.</p>
<p>But first, a brief introduction to the <code>switch-to-buffer</code> function. When you switched back and forth from Info to the <em>scratch</em> buffer to evaluate <code>(buffer-name)</code>, you most likely typed C-x b and then typed <em>scratch</em><a href="https://www.gnu.org/software/emacs/manual/html_mono/eintr.html#fn-7" target="_blank" rel="noopener">7</a> when prompted in the minibuffer for the name of the buffer to which you wanted to switch. The keystrokes, C-x b, cause the Lisp interpreter to evaluate the interactive function <code>switch-to-buffer</code>. As we said before, this is how Emacs works: different keystrokes call or run different functions. For example, C-f calls <code>forward-char</code>, M-e calls <code>forward-sentence</code>, and so on.</p>
<p>By writing <code>switch-to-buffer</code> in an expression, and giving it a buffer to switch to, we can switch buffers just the way C-x b does:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(switch-to-buffer (other-buffer))</span><br></pre></td></tr></table></figure>
<p>The symbol <code>switch-to-buffer</code> is the first element of the list, so the Lisp interpreter will treat it as a function and carry out the instructions that are attached to it. But before doing that, the interpreter will note that <code>other-buffer</code> is inside parentheses and work on that symbol first. <code>other-buffer</code> is the first (and in this case, the only) element of this list, so the Lisp interpreter calls or runs the function. It returns another buffer. Next, the interpreter runs <code>switch-to-buffer</code>, passing to it, as an argument, the other buffer, which is what Emacs will switch to. If you are reading this in Info, try this now. Evaluate the expression. (To get back, type C-x b <ret>.)<a href="https://www.gnu.org/software/emacs/manual/html_mono/eintr.html#fn-8" target="_blank" rel="noopener">8</a></ret></p>
<p>In the programming examples in later sections of this document, you will see the function <code>set-buffer</code> more often than <code>switch-to-buffer</code>. This is because of a difference between computer programs and humans: humans have eyes and expect to see the buffer on which they are working on their computer terminals. This is so obvious, it almost goes without saying. However, programs do not have eyes. When a computer program works on a buffer, that buffer does not need to be visible on the screen.</p>
<p><code>switch-to-buffer</code> is designed for humans and does two different things: it switches the buffer to which Emacs’s attention is directed; and it switches the buffer displayed in the window to the new buffer. <code>set-buffer</code>, on the other hand, does only one thing: it switches the attention of the computer program to a different buffer. The buffer on the screen remains unchanged (of course, normally nothing happens there until the command finishes running).</p>
<p>Also, we have just introduced another jargon term, the word call. When you evaluate a list in which the first symbol is a function, you are calling that function. The use of the term comes from the notion of the function as an entity that can do something for you if you call it—just as a plumber is an entity who can fix a leak if you call him or her.</p>
<h3 id="2-4-Buffer-Size-and-the-Location-of-Point"><a href="#2-4-Buffer-Size-and-the-Location-of-Point" class="headerlink" title="2.4 Buffer Size and the Location of Point"></a>2.4 Buffer Size and the Location of Point</h3><p>Finally, let’s look at several rather simple functions, <code>buffer-size</code>, <code>point</code>, <code>point-min</code>, and <code>point-max</code>. These give information about the size of a buffer and the location of point within it.</p>
<p>The function <code>buffer-size</code> tells you the size of the current buffer; that is, the function returns a count of the number of characters in the buffer.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(buffer-size)</span><br></pre></td></tr></table></figure>
<p>You can evaluate this in the usual way, by positioning the cursor after the expression and typing C-x C-e.</p>
<p>In Emacs, the current position of the cursor is called point. The expression <code>(point)</code> returns a number that tells you where the cursor is located as a count of the number of characters from the beginning of the buffer up to point.</p>
<p>You can see the character count for point in this buffer by evaluating the following expression in the usual way:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(point)</span><br></pre></td></tr></table></figure>
<p>As I write this, the value of point is 65724. The <code>point</code> function is frequently used in some of the examples later in this book.</p>
<p>The value of point depends, of course, on its location within the buffer. If you evaluate point in this spot, the number will be larger:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(point)</span><br></pre></td></tr></table></figure>
<p>For me, the value of point in this location is 66043, which means that there are 319 characters (including spaces) between the two expressions. (Doubtless, you will see different numbers, since I will have edited this since I first evaluated point.)</p>
<p>The function <code>point-min</code> is somewhat similar to <code>point</code>, but it returns the value of the minimum permissible value of point in the current buffer. This is the number 1 unless narrowing is in effect. (Narrowing is a mechanism whereby you can restrict yourself, or a program, to operations on just a part of a buffer. See <a href="https://www.gnu.org/software/emacs/manual/html_mono/eintr.html#Narrowing-_0026-Widening" target="_blank" rel="noopener">Narrowing and Widening</a>.) Likewise, the function <code>point-max</code> returns the value of the maximum permissible value of point in the current buffer.</p>
<h3 id="2-5-Exercise"><a href="#2-5-Exercise" class="headerlink" title="2.5 Exercise"></a>2.5 Exercise</h3><p>Find a file with which you are working and move towards its middle. Find its buffer name, file name, length, and your position in the file.</p>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://alphaalgorithms.github.io/2019/06/11/elisp-list/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Gabriel">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="DummyHead">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                
                <a href="/2019/06/11/elisp-list/" class="post-title-link" itemprop="url">Intro to elisp 1. List Processing</a>
              
            
          </h2>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2019-06-11 07:47:28 / Modified: 09:28:50" itemprop="dateCreated datePublished" datetime="2019-06-11T07:47:28+08:00">2019-06-11</time>
            

            
              

              
            
          </span>

          

          
            
            
              
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
            
                <span class="post-meta-item-text">Comments: </span>
                <a href="/2019/06/11/elisp-list/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2019/06/11/elisp-list/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>To the untutored eye, Lisp is a strange programming language. In Lisp code there are parentheses everywhere. Some people even claim that the name stands for “Lots of Isolated Silly Parentheses”. But the claim is unwarranted. Lisp stands for LISt Processing, and the programming language handles <em>lists</em> (and lists of lists) by putting them between parentheses. The parentheses mark the boundaries of the list. Sometimes a list is preceded by an apostrophe ‘’’, called a single-quote in Lisp.<a href="https://www.gnu.org/software/emacs/manual/html_mono/eintr.html#fn-1" target="_blank" rel="noopener">1</a> Lists are the basis of Lisp.</p>
<ul>
<li><a href="https://www.gnu.org/software/emacs/manual/html_mono/eintr.html#Lisp-Lists" target="_blank" rel="noopener">Lisp Lists</a>: What are lists?</li>
<li><a href="https://www.gnu.org/software/emacs/manual/html_mono/eintr.html#Run-a-Program" target="_blank" rel="noopener">Run a Program</a>: Any list in Lisp is a program ready to run.</li>
<li><a href="https://www.gnu.org/software/emacs/manual/html_mono/eintr.html#Making-Errors" target="_blank" rel="noopener">Making Errors</a>: Generating an error message.</li>
<li><a href="https://www.gnu.org/software/emacs/manual/html_mono/eintr.html#Names-_0026-Definitions" target="_blank" rel="noopener">Names &amp; Definitions</a>: Names of symbols and function definitions.</li>
<li><a href="https://www.gnu.org/software/emacs/manual/html_mono/eintr.html#Lisp-Interpreter" target="_blank" rel="noopener">Lisp Interpreter</a>: What the Lisp interpreter does.</li>
<li><a href="https://www.gnu.org/software/emacs/manual/html_mono/eintr.html#Evaluation" target="_blank" rel="noopener">Evaluation</a>: Running a program.</li>
<li><a href="https://www.gnu.org/software/emacs/manual/html_mono/eintr.html#Variables" target="_blank" rel="noopener">Variables</a>: Returning a value from a variable.</li>
<li><a href="https://www.gnu.org/software/emacs/manual/html_mono/eintr.html#Arguments" target="_blank" rel="noopener">Arguments</a>: Passing information to a function.</li>
<li><a href="https://www.gnu.org/software/emacs/manual/html_mono/eintr.html#set-_0026-setq" target="_blank" rel="noopener">set &amp; setq</a>: Setting the value of a variable.</li>
<li><a href="https://www.gnu.org/software/emacs/manual/html_mono/eintr.html#Summary" target="_blank" rel="noopener">Summary</a>: The major points.</li>
<li><a href="https://www.gnu.org/software/emacs/manual/html_mono/eintr.html#Error-Message-Exercises" target="_blank" rel="noopener">Error Message Exercises</a></li>
</ul>
<h3 id="1-1-Lisp-Lists"><a href="#1-1-Lisp-Lists" class="headerlink" title="1.1 Lisp Lists"></a>1.1 Lisp Lists</h3><p>In Lisp, a list looks like this: <code>&#39;(rose violet daisy buttercup)</code>. This list is preceded by a single apostrophe. It could just as well be written as follows, which looks more like the kind of list you are likely to be familiar with:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&apos;(rose</span><br><span class="line">  violet</span><br><span class="line">  daisy</span><br><span class="line">  buttercup)</span><br></pre></td></tr></table></figure>
<p>The elements of this list are the names of the four different flowers, separated from each other by whitespace and surrounded by parentheses, like flowers in a field with a stone wall around them.</p>
<ul>
<li><a href="https://www.gnu.org/software/emacs/manual/html_mono/eintr.html#Numbers-Lists" target="_blank" rel="noopener">Numbers Lists</a>: List have numbers, other lists, in them.</li>
<li><a href="https://www.gnu.org/software/emacs/manual/html_mono/eintr.html#Lisp-Atoms" target="_blank" rel="noopener">Lisp Atoms</a>: Elemental entities.</li>
<li><a href="https://www.gnu.org/software/emacs/manual/html_mono/eintr.html#Whitespace-in-Lists" target="_blank" rel="noopener">Whitespace in Lists</a>: Formatting lists to be readable.</li>
<li><a href="https://www.gnu.org/software/emacs/manual/html_mono/eintr.html#Typing-Lists" target="_blank" rel="noopener">Typing Lists</a>: How GNU Emacs helps you type lists.</li>
</ul>
<h4 id="Numbers-Lists-inside-of-Lists"><a href="#Numbers-Lists-inside-of-Lists" class="headerlink" title="Numbers, Lists inside of Lists"></a>Numbers, Lists inside of Lists</h4><p>Lists can also have numbers in them, as in this list: <code>(+ 2 2)</code>. This list has a plus-sign, ‘+’, followed by two ‘2’s, each separated by whitespace.</p>
<p>In Lisp, both data and programs are represented the same way; that is, they are both lists of words, numbers, or other lists, separated by whitespace and surrounded by parentheses. (Since a program looks like data, one program may easily serve as data for another; this is a very powerful feature of Lisp.) (Incidentally, these two parenthetical remarks are <em>not</em>Lisp lists, because they contain ‘;’ and ‘.’ as punctuation marks.)</p>
<p>Here is another list, this time with a list inside of it:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&apos;(this list has (a list inside of it))</span><br></pre></td></tr></table></figure>
<p>The components of this list are the words ‘this’, ‘list’, ‘has’, and the list ‘(a list inside of it)’. The interior list is made up of the words ‘a’, ‘list’, ‘inside’, ‘of’, ‘it’.</p>
<h4 id="1-1-1-Lisp-Atoms"><a href="#1-1-1-Lisp-Atoms" class="headerlink" title="1.1.1 Lisp Atoms"></a>1.1.1 Lisp Atoms</h4><p>In Lisp, what we have been calling words are called atoms. This term comes from the historical meaning of the word atom, which means “indivisible”. As far as Lisp is concerned, the words we have been using in the lists cannot be divided into any smaller parts and still mean the same thing as part of a program; likewise with numbers and single character symbols like ‘+’. On the other hand, unlike an ancient atom, a list can be split into parts. (See <a href="https://www.gnu.org/software/emacs/manual/html_mono/eintr.html#car-cdr-_0026-cons" target="_blank" rel="noopener"><code>car</code> <code>cdr</code> &amp; <code>cons</code> Fundamental Functions</a>.)</p>
<p>In a list, atoms are separated from each other by whitespace. They can be right next to a parenthesis.</p>
<p>Technically speaking, a list in Lisp consists of parentheses surrounding atoms separated by whitespace or surrounding other lists or surrounding both atoms and other lists. A list can have just one atom in it or have nothing in it at all. A list with nothing in it looks like this: <code>()</code>, and is called the empty list. Unlike anything else, an empty list is considered both an atom and a list at the same time.</p>
<p>The printed representation of both atoms and lists are called symbolic expressions or, more concisely, s-expressions. The word expression by itself can refer to either the printed representation, or to the atom or list as it is held internally in the computer. Often, people use the term expression indiscriminately. (Also, in many texts, the word form is used as a synonym for expression.)</p>
<p>Incidentally, the atoms that make up our universe were named such when they were thought to be indivisible; but it has been found that physical atoms are not indivisible. Parts can split off an atom or it can fission into two parts of roughly equal size. Physical atoms were named prematurely, before their truer nature was found. In Lisp, certain kinds of atom, such as an array, can be separated into parts; but the mechanism for doing this is different from the mechanism for splitting a list. As far as list operations are concerned, the atoms of a list are unsplittable.</p>
<p>As in English, the meanings of the component letters of a Lisp atom are different from the meaning the letters make as a word. For example, the word for the South American sloth, the ‘ai’, is completely different from the two words, ‘a’, and ‘i’.</p>
<p>There are many kinds of atom in nature but only a few in Lisp: for example, numbers, such as 37, 511, or 1729, and symbols, such as ‘+’, ‘foo’, or ‘forward-line’. The words we have listed in the examples above are all symbols. In everyday Lisp conversation, the word “atom” is not often used, because programmers usually try to be more specific about what kind of atom they are dealing with. Lisp programming is mostly about symbols (and sometimes numbers) within lists. (Incidentally, the preceding three word parenthetical remark is a proper list in Lisp, since it consists of atoms, which in this case are symbols, separated by whitespace and enclosed by parentheses, without any non-Lisp punctuation.)</p>
<p>Text between double quotation marks—even sentences or paragraphs—is also an atom. Here is an example:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&apos;(this list includes &quot;text between quotation marks.&quot;)</span><br></pre></td></tr></table></figure>
<p>In Lisp, all of the quoted text including the punctuation mark and the blank spaces is a single atom. This kind of atom is called a string (for “string of characters”) and is the sort of thing that is used for messages that a computer can print for a human to read. Strings are a different kind of atom than numbers or symbols and are used differently.</p>
<h4 id="1-1-2-Whitespace-in-Lists"><a href="#1-1-2-Whitespace-in-Lists" class="headerlink" title="1.1.2 Whitespace in Lists"></a>1.1.2 Whitespace in Lists</h4><p>The amount of whitespace in a list does not matter. From the point of view of the Lisp language,</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&apos;(this list</span><br><span class="line">   looks like this)</span><br></pre></td></tr></table></figure>
<p>is exactly the same as this:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&apos;(this list looks like this)</span><br></pre></td></tr></table></figure>
<p>Both examples show what to Lisp is the same list, the list made up of the symbols ‘this’, ‘list’, ‘looks’, ‘like’, and ‘this’ in that order.</p>
<p>Extra whitespace and newlines are designed to make a list more readable by humans. When Lisp reads the expression, it gets rid of all the extra whitespace (but it needs to have at least one space between atoms in order to tell them apart.)</p>
<p>Odd as it seems, the examples we have seen cover almost all of what Lisp lists look like! Every other list in Lisp looks more or less like one of these examples, except that the list may be longer and more complex. In brief, a list is between parentheses, a string is between quotation marks, a symbol looks like a word, and a number looks like a number. (For certain situations, square brackets, dots and a few other special characters may be used; however, we will go quite far without them.)</p>
<h4 id="1-1-3-GNU-Emacs-Helps-You-Type-Lists"><a href="#1-1-3-GNU-Emacs-Helps-You-Type-Lists" class="headerlink" title="1.1.3 GNU Emacs Helps You Type Lists"></a>1.1.3 GNU Emacs Helps You Type Lists</h4><p>When you type a Lisp expression in GNU Emacs using either Lisp Interaction mode or Emacs Lisp mode, you have available to you several commands to format the Lisp expression so it is easy to read. For example, pressing the <tab> key automatically indents the line the cursor is on by the right amount. A command to properly indent the code in a region is customarily bound to M-C-. Indentation is designed so that you can see which elements of a list belong to which list—elements of a sub-list are indented more than the elements of the enclosing list.</tab></p>
<p>In addition, when you type a closing parenthesis, Emacs momentarily jumps the cursor back to the matching opening parenthesis, so you can see which one it is. This is very useful, since every list you type in Lisp must have its closing parenthesis match its opening parenthesis. (See <a href="https://www.gnu.org/software/emacs/manual/html_mono/emacs.html#Major-Modes" target="_blank" rel="noopener">Major Modes</a>, for more information about Emacs’s modes.)</p>
<h3 id="1-2-Run-a-Program"><a href="#1-2-Run-a-Program" class="headerlink" title="1.2 Run a Program"></a>1.2 Run a Program</h3><p>A list in Lisp—any list—is a program ready to run. If you run it (for which the Lisp jargon is evaluate), the computer will do one of three things: do nothing except return to you the list itself; send you an error message; or, treat the first symbol in the list as a command to do something. (Usually, of course, it is the last of these three things that you really want!)</p>
<p>The single apostrophe, <code>&#39;</code>, that I put in front of some of the example lists in preceding sections is called a quote; when it precedes a list, it tells Lisp to do nothing with the list, other than take it as it is written. But if there is no quote preceding a list, the first item of the list is special: it is a command for the computer to obey. (In Lisp, these commands are called <em>functions</em>.) The list <code>(+ 2 2)</code> shown above did not have a quote in front of it, so Lisp understands that the <code>+</code> is an instruction to do something with the rest of the list: add the numbers that follow.</p>
<p>If you are reading this inside of GNU Emacs in Info, here is how you can evaluate such a list: place your cursor immediately after the right hand parenthesis of the following list and then type C-x C-e:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(+ 2 2)</span><br></pre></td></tr></table></figure>
<p>You will see the number <code>4</code> appear in the echo area<a href="https://www.gnu.org/software/emacs/manual/html_mono/eintr.html#fn-2" target="_blank" rel="noopener">2</a>. (What you have just done is evaluate the list. The echo area is the line at the bottom of the screen that displays or echoes text.) Now try the same thing with a quoted list: place the cursor right after the following list and type C-x C-e:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&apos;(this is a quoted list)</span><br></pre></td></tr></table></figure>
<p>You will see <code>(this is a quoted list)</code> appear in the echo area.</p>
<p>In both cases, what you are doing is giving a command to the program inside of GNU Emacs called the Lisp interpreter—giving the interpreter a command to evaluate the expression. The name of the Lisp interpreter comes from the word for the task done by a human who comes up with the meaning of an expression—who interprets it.</p>
<p>You can also evaluate an atom that is not part of a list—one that is not surrounded by parentheses; again, the Lisp interpreter translates from the humanly readable expression to the language of the computer. But before discussing this (see <a href="https://www.gnu.org/software/emacs/manual/html_mono/eintr.html#Variables" target="_blank" rel="noopener">Variables</a>), we will discuss what the Lisp interpreter does when you make an error.</p>
<h3 id="1-3-Generate-an-Error-Message"><a href="#1-3-Generate-an-Error-Message" class="headerlink" title="1.3 Generate an Error Message"></a>1.3 Generate an Error Message</h3><p>Partly so you won’t worry if you do it accidentally, we will now give a command to the Lisp interpreter that generates an error message. This is a harmless activity; and indeed, we will often try to generate error messages intentionally. Once you understand the jargon, error messages can be informative. Instead of being called “error” messages, they should be called “help” messages. They are like signposts to a traveler in a strange country; deciphering them can be hard, but once understood, they can point the way.</p>
<p>The error message is generated by a built-in GNU Emacs debugger. We will enter the debugger. You get out of the debugger by typing <code>q</code>.</p>
<p>What we will do is evaluate a list that is not quoted and does not have a meaningful command as its first element. Here is a list almost exactly the same as the one we just used, but without the single-quote in front of it. Position the cursor right after it and type C-x C-e:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(this is an unquoted list)</span><br></pre></td></tr></table></figure>
<p>A <em>Backtrace</em> window will open up and you should see the following in it:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">---------- Buffer: *Backtrace* ----------</span><br><span class="line">Debugger entered--Lisp error: (void-function this)</span><br><span class="line">  (this is an unquoted list)</span><br><span class="line">  eval((this is an unquoted list) nil)</span><br><span class="line">  elisp--eval-last-sexp(nil)</span><br><span class="line">  eval-last-sexp(nil)</span><br><span class="line">  funcall-interactively(eval-last-sexp nil)</span><br><span class="line">  call-interactively(eval-last-sexp nil nil)</span><br><span class="line">  command-execute(eval-last-sexp)</span><br><span class="line">---------- Buffer: *Backtrace* ----------</span><br></pre></td></tr></table></figure>
<p>Your cursor will be in this window (you may have to wait a few seconds before it becomes visible). To quit the debugger and make the debugger window go away, type:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">q</span><br></pre></td></tr></table></figure>
<p>Please type q right now, so you become confident that you can get out of the debugger. Then, type C-x C-e again to re-enter it.</p>
<p>Based on what we already know, we can almost read this error message.</p>
<p>You read the <em>Backtrace</em> buffer from the bottom up; it tells you what Emacs did. When you typed C-x C-e, you made an interactive call to the command <code>eval-last-sexp</code>. <code>eval</code>is an abbreviation for “evaluate” and <code>sexp</code> is an abbreviation for “symbolic expression”. The command means “evaluate last symbolic expression”, which is the expression just before your cursor.</p>
<p>Each line above tells you what the Lisp interpreter evaluated next. The most recent action is at the top. The buffer is called the <em>Backtrace</em> buffer because it enables you to track Emacs backwards.</p>
<p>At the top of the <em>Backtrace</em> buffer, you see the line:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Debugger entered--Lisp error: (void-function this)</span><br></pre></td></tr></table></figure>
<p>The Lisp interpreter tried to evaluate the first atom of the list, the word ‘this’. It is this action that generated the error message ‘void-function this’.</p>
<p>The message contains the words ‘void-function’ and ‘this’.</p>
<p>The word ‘function’ was mentioned once before. It is a very important word. For our purposes, we can define it by saying that a function is a set of instructions to the computer that tell the computer to do something.</p>
<p>Now we can begin to understand the error message: ‘void-function this’. The function (that is, the word ‘this’) does not have a definition of any set of instructions for the computer to carry out.</p>
<p>The slightly odd word, ‘void-function’, is designed to cover the way Emacs Lisp is implemented, which is that when a symbol does not have a function definition attached to it, the place that should contain the instructions is void.</p>
<p>On the other hand, since we were able to add 2 plus 2 successfully, by evaluating <code>(+ 2 2)</code>, we can infer that the symbol <code>+</code> must have a set of instructions for the computer to obey and those instructions must be to add the numbers that follow the <code>+</code>.</p>
<p>It is possible to prevent Emacs entering the debugger in cases like this. We do not explain how to do that here, but we will mention what the result looks like, because you may encounter a similar situation if there is a bug in some Emacs code that you are using. In such cases, you will see only one line of error message; it will appear in the echo area and look like this:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Symbol&apos;s function definition is void: this</span><br></pre></td></tr></table></figure>
<p>The message goes away as soon as you type a key, even just to move the cursor.</p>
<p>We know the meaning of the word ‘Symbol’. It refers to the first atom of the list, the word ‘this’. The word ‘function’ refers to the instructions that tell the computer what to do. (Technically, the symbol tells the computer where to find the instructions, but this is a complication we can ignore for the moment.)</p>
<p>The error message can be understood: ‘Symbol’s function definition is void: this’. The symbol (that is, the word ‘this’) lacks instructions for the computer to carry out.</p>
<h3 id="1-4-Symbol-Names-and-Function-Definitions"><a href="#1-4-Symbol-Names-and-Function-Definitions" class="headerlink" title="1.4 Symbol Names and Function Definitions"></a>1.4 Symbol Names and Function Definitions</h3><p>We can articulate another characteristic of Lisp based on what we have discussed so far—an important characteristic: a symbol, like <code>+</code>, is not itself the set of instructions for the computer to carry out. Instead, the symbol is used, perhaps temporarily, as a way of locating the definition or set of instructions. What we see is the name through which the instructions can be found. Names of people work the same way. I can be referred to as ‘Bob’; however, I am not the letters ‘B’, ‘o’, ‘b’ but am, or was, the consciousness consistently associated with a particular life-form. The name is not me, but it can be used to refer to me.</p>
<p>In Lisp, one set of instructions can be attached to several names. For example, the computer instructions for adding numbers can be linked to the symbol <code>plus</code> as well as to the symbol <code>+</code> (and are in some dialects of Lisp). Among humans, I can be referred to as ‘Robert’ as well as ‘Bob’ and by other words as well.</p>
<p>On the other hand, a symbol can have only one function definition attached to it at a time. Otherwise, the computer would be confused as to which definition to use. If this were the case among people, only one person in the world could be named ‘Bob’. However, the function definition to which the name refers can be changed readily. (See <a href="https://www.gnu.org/software/emacs/manual/html_mono/eintr.html#Install" target="_blank" rel="noopener">Install a Function Definition</a>.)</p>
<p>Since Emacs Lisp is large, it is customary to name symbols in a way that identifies the part of Emacs to which the function belongs. Thus, all the names for functions that deal with Texinfo start with ‘texinfo-’ and those for functions that deal with reading mail start with ‘rmail-’. </p>
<h3 id="1-5-The-Lisp-Interpreter"><a href="#1-5-The-Lisp-Interpreter" class="headerlink" title="1.5 The Lisp Interpreter"></a>1.5 The Lisp Interpreter</h3><p>Based on what we have seen, we can now start to figure out what the Lisp interpreter does when we command it to evaluate a list. First, it looks to see whether there is a quote before the list; if there is, the interpreter just gives us the list. On the other hand, if there is no quote, the interpreter looks at the first element in the list and sees whether it has a function definition. If it does, the interpreter carries out the instructions in the function definition. Otherwise, the interpreter prints an error message.</p>
<p>This is how Lisp works. Simple. There are added complications which we will get to in a minute, but these are the fundamentals. Of course, to write Lisp programs, you need to know how to write function definitions and attach them to names, and how to do this without confusing either yourself or the computer.</p>
<ul>
<li><a href="https://www.gnu.org/software/emacs/manual/html_mono/eintr.html#Complications" target="_blank" rel="noopener">Complications</a>: Variables, Special forms, Lists within.</li>
<li><a href="https://www.gnu.org/software/emacs/manual/html_mono/eintr.html#Byte-Compiling" target="_blank" rel="noopener">Byte Compiling</a>: Specially processing code for speed.</li>
</ul>
<h4 id="Complications"><a href="#Complications" class="headerlink" title="Complications"></a>Complications</h4><p>Now, for the first complication. In addition to lists, the Lisp interpreter can evaluate a symbol that is not quoted and does not have parentheses around it. The Lisp interpreter will attempt to determine the symbol’s value as a variable. This situation is described in the section on variables. (See <a href="https://www.gnu.org/software/emacs/manual/html_mono/eintr.html#Variables" target="_blank" rel="noopener">Variables</a>.)</p>
<p>The second complication occurs because some functions are unusual and do not work in the usual manner. Those that don’t are called special forms. They are used for special jobs, like defining a function, and there are not many of them. In the next few chapters, you will be introduced to several of the more important special forms.</p>
<p>As well as special forms, there are also macros. A macro is a construct defined in Lisp, which differs from a function in that it translates a Lisp expression into another expression that is to be evaluated in place of the original expression. (See <a href="https://www.gnu.org/software/emacs/manual/html_mono/eintr.html#Lisp-macro" target="_blank" rel="noopener">Lisp macro</a>.)</p>
<p>For the purposes of this introduction, you do not need to worry too much about whether something is a special form, macro, or ordinary function. For example, <code>if</code> is a special form (see <a href="https://www.gnu.org/software/emacs/manual/html_mono/eintr.html#if" target="_blank" rel="noopener">if</a>), but <code>when</code> is a macro (see <a href="https://www.gnu.org/software/emacs/manual/html_mono/eintr.html#Lisp-macro" target="_blank" rel="noopener">Lisp macro</a>). In earlier versions of Emacs, <code>defun</code> was a special form, but now it is a macro (see <a href="https://www.gnu.org/software/emacs/manual/html_mono/eintr.html#defun" target="_blank" rel="noopener">defun</a>). It still behaves in the same way.</p>
<p>The final complication is this: if the function that the Lisp interpreter is looking at is not a special form, and if it is part of a list, the Lisp interpreter looks to see whether the list has a list inside of it. If there is an inner list, the Lisp interpreter first figures out what it should do with the inside list, and then it works on the outside list. If there is yet another list embedded inside the inner list, it works on that one first, and so on. It always works on the innermost list first. The interpreter works on the innermost list first, to evaluate the result of that list. The result may be used by the enclosing expression.</p>
<p>Otherwise, the interpreter works left to right, from one expression to the next.</p>
<h4 id="1-5-1-Byte-Compiling"><a href="#1-5-1-Byte-Compiling" class="headerlink" title="1.5.1 Byte Compiling"></a>1.5.1 Byte Compiling</h4><p>One other aspect of interpreting: the Lisp interpreter is able to interpret two kinds of entity: humanly readable code, on which we will focus exclusively, and specially processed code, called byte compiled code, which is not humanly readable. Byte compiled code runs faster than humanly readable code.</p>
<p>You can transform humanly readable code into byte compiled code by running one of the compile commands such as <code>byte-compile-file</code>. Byte compiled code is usually stored in a file that ends with a .elc extension rather than a .el extension. You will see both kinds of file in the emacs/lisp directory; the files to read are those with .el extensions.</p>
<p>As a practical matter, for most things you might do to customize or extend Emacs, you do not need to byte compile; and I will not discuss the topic here. See <a href="https://www.gnu.org/software/emacs/manual/html_mono/elisp.html#Byte-Compilation" target="_blank" rel="noopener">Byte Compilation</a>, for a full description of byte compilation.</p>
<h3 id="1-6-Evaluation"><a href="#1-6-Evaluation" class="headerlink" title="1.6 Evaluation"></a>1.6 Evaluation</h3><p>When the Lisp interpreter works on an expression, the term for the activity is called evaluation. We say that the interpreter “evaluates the expression”. I’ve used this term several times before. The word comes from its use in everyday language, “to ascertain the value or amount of; to appraise”, according to Webster’s New Collegiate Dictionary.</p>
<ul>
<li><a href="https://www.gnu.org/software/emacs/manual/html_mono/eintr.html#How-the-Interpreter-Acts" target="_blank" rel="noopener">How the Interpreter Acts</a>: Returns and Side Effects…</li>
<li><a href="https://www.gnu.org/software/emacs/manual/html_mono/eintr.html#Evaluating-Inner-Lists" target="_blank" rel="noopener">Evaluating Inner Lists</a>: Lists within lists…</li>
</ul>
<h4 id="How-the-Lisp-Interpreter-Acts"><a href="#How-the-Lisp-Interpreter-Acts" class="headerlink" title="How the Lisp Interpreter Acts"></a>How the Lisp Interpreter Acts</h4><p>After evaluating an expression, the Lisp interpreter will most likely return the value that the computer produces by carrying out the instructions it found in the function definition, or perhaps it will give up on that function and produce an error message. (The interpreter may also find itself tossed, so to speak, to a different function or it may attempt to repeat continually what it is doing for ever and ever in an infinite loop. These actions are less common; and we can ignore them.) Most frequently, the interpreter returns a value.</p>
<p>At the same time the interpreter returns a value, it may do something else as well, such as move a cursor or copy a file; this other kind of action is called a side effect. Actions that we humans think are important, such as printing results, are often side effects to the Lisp interpreter. It is fairly easy to learn to use side effects.</p>
<p>In summary, evaluating a symbolic expression most commonly causes the Lisp interpreter to return a value and perhaps carry out a side effect; or else produce an error.</p>
<h4 id="How-the-Lisp-Interpreter-Acts-1"><a href="#How-the-Lisp-Interpreter-Acts-1" class="headerlink" title="How the Lisp Interpreter Acts"></a>How the Lisp Interpreter Acts</h4><p>After evaluating an expression, the Lisp interpreter will most likely return the value that the computer produces by carrying out the instructions it found in the function definition, or perhaps it will give up on that function and produce an error message. (The interpreter may also find itself tossed, so to speak, to a different function or it may attempt to repeat continually what it is doing for ever and ever in an infinite loop. These actions are less common; and we can ignore them.) Most frequently, the interpreter returns a value.</p>
<p>At the same time the interpreter returns a value, it may do something else as well, such as move a cursor or copy a file; this other kind of action is called a side effect. Actions that we humans think are important, such as printing results, are often side effects to the Lisp interpreter. It is fairly easy to learn to use side effects.</p>
<p>In summary, evaluating a symbolic expression most commonly causes the Lisp interpreter to return a value and perhaps carry out a side effect; or else produce an error.</p>
<h4 id="1-6-1-Evaluating-Inner-Lists"><a href="#1-6-1-Evaluating-Inner-Lists" class="headerlink" title="1.6.1 Evaluating Inner Lists"></a>1.6.1 Evaluating Inner Lists</h4><p>If evaluation applies to a list that is inside another list, the outer list may use the value returned by the first evaluation as information when the outer list is evaluated. This explains why inner expressions are evaluated first: the values they return are used by the outer expressions.</p>
<p>We can investigate this process by evaluating another addition example. Place your cursor after the following expression and type C-x C-e:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(+ 2 (+ 3 3))</span><br></pre></td></tr></table></figure>
<p>The number 8 will appear in the echo area.</p>
<p>What happens is that the Lisp interpreter first evaluates the inner expression, <code>(+ 3 3)</code>, for which the value 6 is returned; then it evaluates the outer expression as if it were written <code>(+ 2 6)</code>, which returns the value 8. Since there are no more enclosing expressions to evaluate, the interpreter prints that value in the echo area.</p>
<p>Now it is easy to understand the name of the command invoked by the keystrokes C-x C-e: the name is <code>eval-last-sexp</code>. The letters <code>sexp</code> are an abbreviation for “symbolic expression”, and <code>eval</code> is an abbreviation for “evaluate”. The command evaluates the last symbolic expression.</p>
<p>As an experiment, you can try evaluating the expression by putting the cursor at the beginning of the next line immediately following the expression, or inside the expression.</p>
<p>Here is another copy of the expression:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(+ 2 (+ 3 3))</span><br></pre></td></tr></table></figure>
<p>If you place the cursor at the beginning of the blank line that immediately follows the expression and type C-x C-e, you will still get the value 8 printed in the echo area. Now try putting the cursor inside the expression. If you put it right after the next to last parenthesis (so it appears to sit on top of the last parenthesis), you will get a 6 printed in the echo area! This is because the command evaluates the expression <code>(+ 3 3)</code>.</p>
<p>Now put the cursor immediately after a number. Type C-x C-e and you will get the number itself. In Lisp, if you evaluate a number, you get the number itself—this is how numbers differ from symbols. If you evaluate a list starting with a symbol like <code>+</code>, you will get a value returned that is the result of the computer carrying out the instructions in the function definition attached to that name. If a symbol by itself is evaluated, something different happens, as we will see in the next section.</p>
<h3 id="1-7-Variables"><a href="#1-7-Variables" class="headerlink" title="1.7 Variables"></a>1.7 Variables</h3><p>In Emacs Lisp, a symbol can have a value attached to it just as it can have a function definition attached to it. The two are different. The function definition is a set of instructions that a computer will obey. A value, on the other hand, is something, such as number or a name, that can vary (which is why such a symbol is called a variable). The value of a symbol can be any expression in Lisp, such as a symbol, number, list, or string. A symbol that has a value is often called a variable.</p>
<p>A symbol can have both a function definition and a value attached to it at the same time. Or it can have just one or the other. The two are separate. This is somewhat similar to the way the name Cambridge can refer to the city in Massachusetts and have some information attached to the name as well, such as “great programming center”.</p>
<p>Another way to think about this is to imagine a symbol as being a chest of drawers. The function definition is put in one drawer, the value in another, and so on. What is put in the drawer holding the value can be changed without affecting the contents of the drawer holding the function definition, and vice versa.</p>
<ul>
<li><a href="https://www.gnu.org/software/emacs/manual/html_mono/eintr.html#fill_002dcolumn-Example" target="_blank" rel="noopener">fill-column Example</a></li>
<li><a href="https://www.gnu.org/software/emacs/manual/html_mono/eintr.html#Void-Function" target="_blank" rel="noopener">Void Function</a>: The error message for a symbol without a function.</li>
<li><a href="https://www.gnu.org/software/emacs/manual/html_mono/eintr.html#Void-Variable" target="_blank" rel="noopener">Void Variable</a>: The error message for a symbol without a value.</li>
</ul>
<h4 id="1-7-1-Error-Message-for-a-Symbol-Without-a-Function"><a href="#1-7-1-Error-Message-for-a-Symbol-Without-a-Function" class="headerlink" title="1.7.1 Error Message for a Symbol Without a Function"></a>1.7.1 Error Message for a Symbol Without a Function</h4><p>When we evaluated <code>fill-column</code> to find its value as a variable, we did not place parentheses around the word. This is because we did not intend to use it as a function name.</p>
<p>If <code>fill-column</code> were the first or only element of a list, the Lisp interpreter would attempt to find the function definition attached to it. But <code>fill-column</code> has no function definition. Try evaluating this:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(fill-column)</span><br></pre></td></tr></table></figure>
<p>You will create a <em>Backtrace</em> buffer that says:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">---------- Buffer: *Backtrace* ----------</span><br><span class="line">Debugger entered--Lisp error: (void-function fill-column)</span><br><span class="line">  (fill-column)</span><br><span class="line">  eval((fill-column) nil)</span><br><span class="line">  elisp--eval-last-sexp(nil)</span><br><span class="line">  eval-last-sexp(nil)</span><br><span class="line">  funcall-interactively(eval-last-sexp nil)</span><br><span class="line">  call-interactively(eval-last-sexp nil nil)</span><br><span class="line">  command-execute(eval-last-sexp)</span><br><span class="line">---------- Buffer: *Backtrace* ----------</span><br></pre></td></tr></table></figure>
<p>(Remember, to quit the debugger and make the debugger window go away, type q in the <em>Backtrace</em> buffer.)</p>
<h4 id="1-7-2-Error-Message-for-a-Symbol-Without-a-Value"><a href="#1-7-2-Error-Message-for-a-Symbol-Without-a-Value" class="headerlink" title="1.7.2 Error Message for a Symbol Without a Value"></a>1.7.2 Error Message for a Symbol Without a Value</h4><p>If you attempt to evaluate a symbol that does not have a value bound to it, you will receive an error message. You can see this by experimenting with our 2 plus 2 addition. In the following expression, put your cursor right after the <code>+</code>, before the first number 2, type C-x C-e:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(+ 2 2)</span><br></pre></td></tr></table></figure>
<p>In GNU Emacs 22, you will create a <em>Backtrace</em> buffer that says:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">---------- Buffer: *Backtrace* ----------</span><br><span class="line">Debugger entered--Lisp error: (void-variable +)</span><br><span class="line">  eval(+)</span><br><span class="line">  elisp--eval-last-sexp(nil)</span><br><span class="line">  eval-last-sexp(nil)</span><br><span class="line">  funcall-interactively(eval-last-sexp nil)</span><br><span class="line">  call-interactively(eval-last-sexp nil nil)</span><br><span class="line">  command-execute(eval-last-sexp)</span><br><span class="line">---------- Buffer: *Backtrace* ----------</span><br></pre></td></tr></table></figure>
<p>(Again, you can quit the debugger by typing q in the <em>Backtrace</em> buffer.)</p>
<p>This backtrace is different from the very first error message we saw, which said, ‘Debugger entered–Lisp error: (void-function this)’. In this case, the function does not have a value as a variable; while in the other error message, the function (the word ‘this’) did not have a definition.</p>
<p>In this experiment with the <code>+</code>, what we did was cause the Lisp interpreter to evaluate the <code>+</code> and look for the value of the variable instead of the function definition. We did this by placing the cursor right after the symbol rather than after the parenthesis of the enclosing list as we did before. As a consequence, the Lisp interpreter evaluated the preceding s-expression, which in this case was <code>+</code> by itself.</p>
<p>Since <code>+</code> does not have a value bound to it, just the function definition, the error message reported that the symbol’s value as a variable was void.</p>
<h3 id="1-8-Arguments"><a href="#1-8-Arguments" class="headerlink" title="1.8 Arguments"></a>1.8 Arguments</h3><p>To see how information is passed to functions, let’s look again at our old standby, the addition of two plus two. In Lisp, this is written as follows:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(+ 2 2)</span><br></pre></td></tr></table></figure>
<p>If you evaluate this expression, the number 4 will appear in your echo area. What the Lisp interpreter does is add the numbers that follow the <code>+</code>.</p>
<p>The numbers added by <code>+</code> are called the arguments of the function <code>+</code>. These numbers are the information that is given to or passed to the function.</p>
<p>The word “argument” comes from the way it is used in mathematics and does not refer to a disputation between two people; instead it refers to the information presented to the function, in this case, to the <code>+</code>. In Lisp, the arguments to a function are the atoms or lists that follow the function. The values returned by the evaluation of these atoms or lists are passed to the function. Different functions require different numbers of arguments; some functions require none at all.<a href="https://www.gnu.org/software/emacs/manual/html_mono/eintr.html#fn-3" target="_blank" rel="noopener">3</a></p>
<ul>
<li><a href="https://www.gnu.org/software/emacs/manual/html_mono/eintr.html#Data-types" target="_blank" rel="noopener">Data types</a>: Types of data passed to a function.</li>
<li><a href="https://www.gnu.org/software/emacs/manual/html_mono/eintr.html#Args-as-Variable-or-List" target="_blank" rel="noopener">Args as Variable or List</a>: An argument can be the value of a variable or list.</li>
<li><a href="https://www.gnu.org/software/emacs/manual/html_mono/eintr.html#Variable-Number-of-Arguments" target="_blank" rel="noopener">Variable Number of Arguments</a>: Some functions may take a variable number of arguments.</li>
<li><a href="https://www.gnu.org/software/emacs/manual/html_mono/eintr.html#Wrong-Type-of-Argument" target="_blank" rel="noopener">Wrong Type of Argument</a>: Passing an argument of the wrong type to a function.</li>
<li><a href="https://www.gnu.org/software/emacs/manual/html_mono/eintr.html#message" target="_blank" rel="noopener">message</a>: A useful function for sending messages.</li>
</ul>
<h4 id="1-8-1-Arguments’-Data-Types"><a href="#1-8-1-Arguments’-Data-Types" class="headerlink" title="1.8.1 Arguments’ Data Types"></a>1.8.1 Arguments’ Data Types</h4><p>The type of data that should be passed to a function depends on what kind of information it uses. The arguments to a function such as <code>+</code> must have values that are numbers, since <code>+</code>adds numbers. Other functions use different kinds of data for their arguments.</p>
<p>For example, the <code>concat</code> function links together or unites two or more strings of text to produce a string. The arguments are strings. Concatenating the two character strings <code>abc</code>, <code>def</code> produces the single string <code>abcdef</code>. This can be seen by evaluating the following:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(concat &quot;abc&quot; &quot;def&quot;)</span><br></pre></td></tr></table></figure>
<p>The value produced by evaluating this expression is <code>&quot;abcdef&quot;</code>.</p>
<p>A function such as <code>substring</code> uses both a string and numbers as arguments. The function returns a part of the string, a substring of the first argument. This function takes three arguments. Its first argument is the string of characters, the second and third arguments are numbers that indicate the beginning (inclusive) and end (exclusive) of the substring. The numbers are a count of the number of characters (including spaces and punctuation) from the beginning of the string. Note that the characters in a string are numbered from zero, not one.</p>
<p>For example, if you evaluate the following:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(substring &quot;The quick brown fox jumped.&quot; 16 19)</span><br></pre></td></tr></table></figure>
<p>you will see <code>&quot;fox&quot;</code> appear in the echo area. The arguments are the string and the two numbers.</p>
<p>Note that the string passed to <code>substring</code> is a single atom even though it is made up of several words separated by spaces. Lisp counts everything between the two quotation marks as part of the string, including the spaces. You can think of the <code>substring</code> function as a kind of atom smasher since it takes an otherwise indivisible atom and extracts a part. However, <code>substring</code> is only able to extract a substring from an argument that is a string, not from another type of atom such as a number or symbol.</p>
<h4 id="1-8-3-Variable-Number-of-Arguments"><a href="#1-8-3-Variable-Number-of-Arguments" class="headerlink" title="1.8.3 Variable Number of Arguments"></a>1.8.3 Variable Number of Arguments</h4><p>Some functions, such as <code>concat</code>, <code>+</code> or <code>*</code>, take any number of arguments. (The <code>*</code> is the symbol for multiplication.) This can be seen by evaluating each of the following expressions in the usual way. What you will see in the echo area is printed in this text after ‘⇒’, which you may read as “evaluates to”.</p>
<p>In the first set, the functions have no arguments:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">(+)       ⇒ 0</span><br><span class="line"></span><br><span class="line">(*)       ⇒ 1</span><br></pre></td></tr></table></figure>
<p>In this set, the functions have one argument each:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">(+ 3)     ⇒ 3</span><br><span class="line"></span><br><span class="line">(* 3)     ⇒ 3</span><br></pre></td></tr></table></figure>
<p>In this set, the functions have three arguments each:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">(+ 3 4 5) ⇒ 12</span><br><span class="line"></span><br><span class="line">(* 3 4 5) ⇒ 60</span><br></pre></td></tr></table></figure>
<h4 id="1-8-4-Using-the-Wrong-Type-Object-as-an-Argument"><a href="#1-8-4-Using-the-Wrong-Type-Object-as-an-Argument" class="headerlink" title="1.8.4 Using the Wrong Type Object as an Argument"></a>1.8.4 Using the Wrong Type Object as an Argument</h4><p>When a function is passed an argument of the wrong type, the Lisp interpreter produces an error message. For example, the <code>+</code> function expects the values of its arguments to be numbers. As an experiment we can pass it the quoted symbol <code>hello</code> instead of a number. Position the cursor after the following expression and type C-x C-e:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(+ 2 &apos;hello)</span><br></pre></td></tr></table></figure>
<p>When you do this you will generate an error message. What has happened is that <code>+</code> has tried to add the 2 to the value returned by <code>&#39;hello</code>, but the value returned by <code>&#39;hello</code> is the symbol <code>hello</code>, not a number. Only numbers can be added. So <code>+</code> could not carry out its addition.</p>
<p>You will create and enter a <em>Backtrace</em> buffer that says:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">---------- Buffer: *Backtrace* ----------</span><br><span class="line">Debugger entered--Lisp error:</span><br><span class="line">         (wrong-type-argument number-or-marker-p hello)</span><br><span class="line">  +(2 hello)</span><br><span class="line">  eval((+ 2 &apos;hello) nil)</span><br><span class="line">  elisp--eval-last-sexp(t)</span><br><span class="line">  eval-last-sexp(nil)</span><br><span class="line">  funcall-interactively(eval-print-last-sexp nil)</span><br><span class="line">  call-interactively(eval-print-last-sexp nil nil)</span><br><span class="line">  command-execute(eval-print-last-sexp)</span><br><span class="line">---------- Buffer: *Backtrace* ----------</span><br></pre></td></tr></table></figure>
<p>As usual, the error message tries to be helpful and makes sense after you learn how to read it.<a href="https://www.gnu.org/software/emacs/manual/html_mono/eintr.html#fn-4" target="_blank" rel="noopener">4</a></p>
<p>The first part of the error message is straightforward; it says ‘wrong type argument’. Next comes the mysterious jargon word ‘number-or-marker-p’. This word is trying to tell you what kind of argument the <code>+</code> expected.</p>
<p>The symbol <code>number-or-marker-p</code> says that the Lisp interpreter is trying to determine whether the information presented it (the value of the argument) is a number or a marker (a special object representing a buffer position). What it does is test to see whether the <code>+</code> is being given numbers to add. It also tests to see whether the argument is something called a marker, which is a specific feature of Emacs Lisp. (In Emacs, locations in a buffer are recorded as markers. When the mark is set with the C-@ or C-<spc> command, its position is kept as a marker. The mark can be considered a number—the number of characters the location is from the beginning of the buffer.) In Emacs Lisp, <code>+</code> can be used to add the numeric value of marker positions as numbers.</spc></p>
<p>The ‘p’ of <code>number-or-marker-p</code> is the embodiment of a practice started in the early days of Lisp programming. The ‘p’ stands for “predicate”. In the jargon used by the early Lisp researchers, a predicate refers to a function to determine whether some property is true or false. So the ‘p’ tells us that <code>number-or-marker-p</code> is the name of a function that determines whether it is true or false that the argument supplied is a number or a marker. Other Lisp symbols that end in ‘p’ include <code>zerop</code>, a function that tests whether its argument has the value of zero, and <code>listp</code>, a function that tests whether its argument is a list.</p>
<p>Finally, the last part of the error message is the symbol <code>hello</code>. This is the value of the argument that was passed to <code>+</code>. If the addition had been passed the correct type of object, the value passed would have been a number, such as 37, rather than a symbol like <code>hello</code>. But then you would not have got the error message.</p>
<h4 id="1-8-5-The-message-Function"><a href="#1-8-5-The-message-Function" class="headerlink" title="1.8.5 The message Function"></a>1.8.5 The <code>message</code> Function</h4><p>Like <code>+</code>, the <code>message</code> function takes a variable number of arguments. It is used to send messages to the user and is so useful that we will describe it here.</p>
<p>A message is printed in the echo area. For example, you can print a message in your echo area by evaluating the following list:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(message &quot;This message appears in the echo area!&quot;)</span><br></pre></td></tr></table></figure>
<p>The whole string between double quotation marks is a single argument and is printed <em>in toto</em>. (Note that in this example, the message itself will appear in the echo area within double quotes; that is because you see the value returned by the <code>message</code> function. In most uses of <code>message</code> in programs that you write, the text will be printed in the echo area as a side-effect, without the quotes. See <a href="https://www.gnu.org/software/emacs/manual/html_mono/eintr.html#multiply_002dby_002dseven-in-detail" target="_blank" rel="noopener"><code>multiply-by-seven</code> in detail</a>, for an example of this.)</p>
<p>However, if there is a ‘%s’ in the quoted string of characters, the <code>message</code> function does not print the ‘%s’ as such, but looks to the argument that follows the string. It evaluates the second argument and prints the value at the location in the string where the ‘%s’ is.</p>
<p>You can see this by positioning the cursor after the following expression and typing C-x C-e:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(message &quot;The name of this buffer is: %s.&quot; (buffer-name))</span><br></pre></td></tr></table></figure>
<p>In Info, <code>&quot;The name of this buffer is: *info*.&quot;</code> will appear in the echo area. The function <code>buffer-name</code> returns the name of the buffer as a string, which the <code>message</code> function inserts in place of <code>%s</code>.</p>
<p>To print a value as an integer, use ‘%d’ in the same way as ‘%s’. For example, to print a message in the echo area that states the value of the <code>fill-column</code>, evaluate the following:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(message &quot;The value of fill-column is %d.&quot; fill-column)</span><br></pre></td></tr></table></figure>
<p>On my system, when I evaluate this list, <code>&quot;The value of fill-column is 72.&quot;</code> appears in my echo area<a href="https://www.gnu.org/software/emacs/manual/html_mono/eintr.html#fn-5" target="_blank" rel="noopener">5</a>.</p>
<p>If there is more than one ‘%s’ in the quoted string, the value of the first argument following the quoted string is printed at the location of the first ‘%s’ and the value of the second argument is printed at the location of the second ‘%s’, and so on.</p>
<p>For example, if you evaluate the following,</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">(message &quot;There are %d %s in the office!&quot;</span><br><span class="line">         (- fill-column 14) &quot;pink elephants&quot;)</span><br></pre></td></tr></table></figure>
<p>a rather whimsical message will appear in your echo area. On my system it says, <code>&quot;There are 58 pink elephants in the office!&quot;</code>.</p>
<p>The expression <code>(- fill-column 14)</code> is evaluated and the resulting number is inserted in place of the ‘%d’; and the string in double quotes, <code>&quot;pink elephants&quot;</code>, is treated as a single argument and inserted in place of the ‘%s’. (That is to say, a string between double quotes evaluates to itself, like a number.)</p>
<p>Finally, here is a somewhat complex example that not only illustrates the computation of a number, but also shows how you can use an expression within an expression to generate the text that is substituted for ‘%s’:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">(message &quot;He saw %d %s&quot;</span><br><span class="line">         (- fill-column 32)</span><br><span class="line">         (concat &quot;red &quot;</span><br><span class="line">                 (substring</span><br><span class="line">                  &quot;The quick brown foxes jumped.&quot; 16 21)</span><br><span class="line">                 &quot; leaping.&quot;))</span><br></pre></td></tr></table></figure>
<p>In this example, <code>message</code> has three arguments: the string, <code>&quot;He saw %d %s&quot;</code>, the expression, <code>(- fill-column 32)</code>, and the expression beginning with the function <code>concat</code>. The value resulting from the evaluation of <code>(- fill-column 32)</code> is inserted in place of the ‘%d’; and the value returned by the expression beginning with <code>concat</code> is inserted in place of the ‘%s’.</p>
<p>When your fill column is 70 and you evaluate the expression, the message <code>&quot;He saw 38 red foxes leaping.&quot;</code> appears in your echo area.</p>
<h3 id="1-9-Setting-the-Value-of-a-Variable"><a href="#1-9-Setting-the-Value-of-a-Variable" class="headerlink" title="1.9 Setting the Value of a Variable"></a>1.9 Setting the Value of a Variable</h3><p>There are several ways by which a variable can be given a value. One of the ways is to use either the function <code>set</code> or the function <code>setq</code>. Another way is to use <code>let</code> (see <a href="https://www.gnu.org/software/emacs/manual/html_mono/eintr.html#let" target="_blank" rel="noopener">let</a>). (The jargon for this process is to bind a variable to a value.)</p>
<p>The following sections not only describe how <code>set</code> and <code>setq</code> work but also illustrate how arguments are passed.</p>
<ul>
<li><a href="https://www.gnu.org/software/emacs/manual/html_mono/eintr.html#Using-set" target="_blank" rel="noopener">Using set</a>: Setting values.</li>
<li><a href="https://www.gnu.org/software/emacs/manual/html_mono/eintr.html#Using-setq" target="_blank" rel="noopener">Using setq</a>: Setting a quoted value.</li>
<li><a href="https://www.gnu.org/software/emacs/manual/html_mono/eintr.html#Counting" target="_blank" rel="noopener">Counting</a>: Using <code>setq</code> to count.</li>
</ul>
<h4 id="1-9-1-Using-set"><a href="#1-9-1-Using-set" class="headerlink" title="1.9.1 Using set"></a>1.9.1 Using <code>set</code></h4><p>To set the value of the symbol <code>flowers</code> to the list <code>&#39;(rose violet daisy buttercup)</code>, evaluate the following expression by positioning the cursor after the expression and typing C-x C-e.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(set &apos;flowers &apos;(rose violet daisy buttercup))</span><br></pre></td></tr></table></figure>
<p>The list <code>(rose violet daisy buttercup)</code> will appear in the echo area. This is what is <em>returned</em> by the <code>set</code> function. As a side effect, the symbol <code>flowers</code> is bound to the list; that is, the symbol <code>flowers</code>, which can be viewed as a variable, is given the list as its value. (This process, by the way, illustrates how a side effect to the Lisp interpreter, setting the value, can be the primary effect that we humans are interested in. This is because every Lisp function must return a value if it does not get an error, but it will only have a side effect if it is designed to have one.)</p>
<p>After evaluating the <code>set</code> expression, you can evaluate the symbol <code>flowers</code> and it will return the value you just set. Here is the symbol. Place your cursor after it and type C-x C-e.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flowers</span><br></pre></td></tr></table></figure>
<p>When you evaluate <code>flowers</code>, the list <code>(rose violet daisy buttercup)</code> appears in the echo area.</p>
<p>Incidentally, if you evaluate <code>&#39;flowers</code>, the variable with a quote in front of it, what you will see in the echo area is the symbol itself, <code>flowers</code>. Here is the quoted symbol, so you can try this:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&apos;flowers</span><br></pre></td></tr></table></figure>
<p>Note also, that when you use <code>set</code>, you need to quote both arguments to <code>set</code>, unless you want them evaluated. Since we do not want either argument evaluated, neither the variable<code>flowers</code> nor the list <code>(rose violet daisy buttercup)</code>, both are quoted. (When you use <code>set</code> without quoting its first argument, the first argument is evaluated before anything else is done. If you did this and <code>flowers</code> did not have a value already, you would get an error message that the ‘Symbol’s value as variable is void’; on the other hand, if <code>flowers</code>did return a value after it was evaluated, the <code>set</code> would attempt to set the value that was returned. There are situations where this is the right thing for the function to do; but such situations are rare.)</p>
<h4 id="1-9-3-Counting"><a href="#1-9-3-Counting" class="headerlink" title="1.9.3 Counting"></a>1.9.3 Counting</h4><p>Here is an example that shows how to use <code>setq</code> in a counter. You might use this to count how many times a part of your program repeats itself. First set a variable to zero; then add one to the number each time the program repeats itself. To do this, you need a variable that serves as a counter, and two expressions: an initial <code>setq</code> expression that sets the counter variable to zero; and a second <code>setq</code> expression that increments the counter each time it is evaluated.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">(setq counter 0)                ; Let&apos;s call this the initializer.</span><br><span class="line"></span><br><span class="line">(setq counter (+ counter 1))    ; This is the incrementer.</span><br><span class="line"></span><br><span class="line">counter                         ; This is the counter.</span><br></pre></td></tr></table></figure>
<p>(The text following the ‘;’ are comments. See <a href="https://www.gnu.org/software/emacs/manual/html_mono/eintr.html#Change-a-defun" target="_blank" rel="noopener">Change a Function Definition</a>.)</p>
<p>If you evaluate the first of these expressions, the initializer, <code>(setq counter 0)</code>, and then evaluate the third expression, <code>counter</code>, the number <code>0</code> will appear in the echo area. If you then evaluate the second expression, the incrementer, <code>(setq counter (+ counter 1))</code>, the counter will get the value 1. So if you again evaluate <code>counter</code>, the number <code>1</code> will appear in the echo area. Each time you evaluate the second expression, the value of the counter will be incremented.</p>
<p>When you evaluate the incrementer, <code>(setq counter (+ counter 1))</code>, the Lisp interpreter first evaluates the innermost list; this is the addition. In order to evaluate this list, it must evaluate the variable <code>counter</code> and the number <code>1</code>. When it evaluates the variable <code>counter</code>, it receives its current value. It passes this value and the number <code>1</code> to the <code>+</code> which adds them together. The sum is then returned as the value of the inner list and passed to the <code>setq</code> which sets the variable <code>counter</code> to this new value. Thus, the value of the variable, <code>counter</code>, is changed.</p>
<h3 id="1-10-Summary"><a href="#1-10-Summary" class="headerlink" title="1.10 Summary"></a>1.10 Summary</h3><p>Learning Lisp is like climbing a hill in which the first part is the steepest. You have now climbed the most difficult part; what remains becomes easier as you progress onwards.</p>
<p>In summary,</p>
<ul>
<li>Lisp programs are made up of expressions, which are lists or single atoms.</li>
<li>Lists are made up of zero or more atoms or inner lists, separated by whitespace and surrounded by parentheses. A list can be empty.</li>
<li>Atoms are multi-character symbols, like <code>forward-paragraph</code>, single character symbols like <code>+</code>, strings of characters between double quotation marks, or numbers.</li>
<li>A number evaluates to itself.</li>
<li>A string between double quotes also evaluates to itself.</li>
<li>When you evaluate a symbol by itself, its value is returned.</li>
<li>When you evaluate a list, the Lisp interpreter looks at the first symbol in the list and then at the function definition bound to that symbol. Then the instructions in the function definition are carried out.</li>
<li>A single-quote ‘’’ tells the Lisp interpreter that it should return the following expression as written, and not evaluate it as it would if the quote were not there.</li>
<li>Arguments are the information passed to a function. The arguments to a function are computed by evaluating the rest of the elements of the list of which the function is the first element.</li>
<li>A function always returns a value when it is evaluated (unless it gets an error); in addition, it may also carry out some action that is a side effect. In many cases, a function’s primary purpose is to create a side effect.</li>
</ul>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://alphaalgorithms.github.io/2019/06/11/elisp-intro-preface/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Gabriel">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="DummyHead">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                
                <a href="/2019/06/11/elisp-intro-preface/" class="post-title-link" itemprop="url">Intro to elisp  0. preface</a>
              
            
          </h2>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2019-06-11 07:37:20 / Modified: 09:28:13" itemprop="dateCreated datePublished" datetime="2019-06-11T07:37:20+08:00">2019-06-11</time>
            

            
              

              
            
          </span>

          

          
            
            
              
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
            
                <span class="post-meta-item-text">Comments: </span>
                <a href="/2019/06/11/elisp-intro-preface/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2019/06/11/elisp-intro-preface/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>Most of the GNU Emacs integrated environment is written in the programming language called Emacs Lisp. The code written in this programming language is the software—the sets of instructions—that tell the computer what to do when you give it commands. Emacs is designed so that you can write new code in Emacs Lisp and easily install it as an extension to the editor.</p>
<p>(GNU Emacs is sometimes called an “extensible editor”, but it does much more than provide editing capabilities. It is better to refer to Emacs as an “extensible computing environment”. However, that phrase is quite a mouthful. It is easier to refer to Emacs simply as an editor. Moreover, everything you do in Emacs—find the Mayan date and phases of the moon, simplify polynomials, debug code, manage files, read letters, write books—all these activities are kinds of editing in the most general sense of the word.)</p>
<ul>
<li><a href="https://www.gnu.org/software/emacs/manual/html_node/eintr/Why.html#Why" target="_blank" rel="noopener">Why</a>: Why learn Emacs Lisp?</li>
<li><a href="https://www.gnu.org/software/emacs/manual/html_node/eintr/On-Reading-this-Text.html#On-Reading-this-Text" target="_blank" rel="noopener">On Reading this Text</a>: Read, gain familiarity, pick up habits….</li>
<li><a href="https://www.gnu.org/software/emacs/manual/html_node/eintr/Who-You-Are.html#Who-You-Are" target="_blank" rel="noopener">Who You Are</a>: For whom this is written.</li>
<li><a href="https://www.gnu.org/software/emacs/manual/html_node/eintr/Lisp-History.html#Lisp-History" target="_blank" rel="noopener">Lisp History</a></li>
<li><a href="https://www.gnu.org/software/emacs/manual/html_node/eintr/Note-for-Novices.html#Note-for-Novices" target="_blank" rel="noopener">Note for Novices</a>: You can read this as a novice.</li>
<li><a href="https://www.gnu.org/software/emacs/manual/html_node/eintr/Thank-You.html#Thank-You" target="_blank" rel="noopener">Thank You</a></li>
</ul>
<h3 id="Why-Study-Emacs-Lisp"><a href="#Why-Study-Emacs-Lisp" class="headerlink" title="Why Study Emacs Lisp?"></a>Why Study Emacs Lisp?</h3><p>Although Emacs Lisp is usually thought of in association only with Emacs, it is a full computer programming language. You can use Emacs Lisp as you would any other programming language.</p>
<p>Perhaps you want to understand programming; perhaps you want to extend Emacs; or perhaps you want to become a programmer. This introduction to Emacs Lisp is designed to get you started: to guide you in learning the fundamentals of programming, and more importantly, to show you how you can teach yourself to go further.</p>
<h3 id="On-Reading-this-Text"><a href="#On-Reading-this-Text" class="headerlink" title="On Reading this Text"></a>On Reading this Text</h3><p>All through this document, you will see little sample programs you can run inside of Emacs. If you read this document in Info inside of GNU Emacs, you can run the programs as they appear. (This is easy to do and is explained when the examples are presented.) Alternatively, you can read this introduction as a printed book while sitting beside a computer running Emacs. (This is what I like to do; I like printed books.) If you don’t have a running Emacs beside you, you can still read this book, but in this case, it is best to treat it as a novel or as a travel guide to a country not yet visited: interesting, but not the same as being there.</p>
<p>Much of this introduction is dedicated to walkthroughs or guided tours of code used in GNU Emacs. These tours are designed for two purposes: first, to give you familiarity with real, working code (code you use every day); and, second, to give you familiarity with the way Emacs works. It is interesting to see how a working environment is implemented. Also, I hope that you will pick up the habit of browsing through source code. You can learn from it and mine it for ideas. Having GNU Emacs is like having a dragon’s cave of treasures.</p>
<p>In addition to learning about Emacs as an editor and Emacs Lisp as a programming language, the examples and guided tours will give you an opportunity to get acquainted with Emacs as a Lisp programming environment. GNU Emacs supports programming and provides tools that you will want to become comfortable using, such as M-. (the key which invokes the <code>xref-find-definitions</code> command). You will also learn about buffers and other objects that are part of the environment. Learning about these features of Emacs is like learning new routes around your home town.</p>
<p>Finally, I hope to convey some of the skills for using Emacs to learn aspects of programming that you don’t know. You can often use Emacs to help you understand what puzzles you or to find out how to do something new. This self-reliance is not only a pleasure, but an advantage.</p>
<h3 id="For-Whom-This-is-Written"><a href="#For-Whom-This-is-Written" class="headerlink" title="For Whom This is Written"></a>For Whom This is Written</h3><p>This text is written as an elementary introduction for people who are not programmers. If you are a programmer, you may not be satisfied with this primer. The reason is that you may have become expert at reading reference manuals and be put off by the way this text is organized.</p>
<p>An expert programmer who reviewed this text said to me:</p>
<blockquote>
<p>I prefer to learn from reference manuals. I “dive into” each paragraph, and “come up for air” between paragraphs.</p>
<p><em>When I get to the end of a paragraph, I assume that subject is done, finished, that I know everything I need (with the possible exception of the case when the next paragraph starts talking about it in more detail). I expect that a well written reference manual will not have a lot of redundancy, and that it will have excellent pointers to the (one) place where the information I want is.</em></p>
</blockquote>
<p>This introduction is not written for this person!</p>
<p>Firstly, I try to say everything at least three times: first, to introduce it; second, to show it in context; and third, to show it in a different context, or to review it.</p>
<p>Secondly, I hardly ever put all the information about a subject in one place, much less in one paragraph. To my way of thinking, that imposes too heavy a burden on the reader. Instead I try to explain only what you need to know at the time. (Sometimes I include a little extra information so you won’t be surprised later when the additional information is formally introduced.)</p>
<p>When you read this text, you are not expected to learn everything the first time. Frequently, you need make only a nodding acquaintance with some of the items mentioned. My hope is that I have structured the text and given you enough hints that you will be alert to what is important, and concentrate on it.</p>
<p>You will need to dive into some paragraphs; there is no other way to read them. But I have tried to keep down the number of such paragraphs. This book is intended as an approachable hill, rather than as a daunting mountain.</p>
<p>This introduction to Programming in Emacs Lisp has a companion document, <a href="https://www.gnu.org/software/emacs/manual/html_node/elisp/index.html#Top" target="_blank" rel="noopener">The GNU Emacs Lisp Reference Manual</a>. The reference manual has more detail than this introduction. In the reference manual, all the information about one topic is concentrated in one place. You should turn to it if you are like the programmer quoted above. And, of course, after you have read this Introduction, you will find the Reference Manual useful when you are writing your own programs.</p>
<h3 id="Lisp-History"><a href="#Lisp-History" class="headerlink" title="Lisp History"></a>Lisp History</h3><p>Lisp was first developed in the late 1950s at the Massachusetts Institute of Technology for research in artificial intelligence. The great power of the Lisp language makes it superior for other purposes as well, such as writing editor commands and integrated environments.</p>
<p>GNU Emacs Lisp is largely inspired by Maclisp, which was written at MIT in the 1960s. It is somewhat inspired by Common Lisp, which became a standard in the 1980s. However, Emacs Lisp is much simpler than Common Lisp. (The standard Emacs distribution contains an optional extensions file, cl.el, that adds many Common Lisp features to Emacs Lisp.)</p>
<h3 id="A-Note-for-Novices"><a href="#A-Note-for-Novices" class="headerlink" title="A Note for Novices"></a>A Note for Novices</h3><p>If you don’t know GNU Emacs, you can still read this document profitably. However, I recommend you learn Emacs, if only to learn to move around your computer screen. You can teach yourself how to use Emacs with the built-in tutorial. To use it, type C-h t. (This means you press and release the <ctrl> key and the h at the same time, and then press and release t.)</ctrl></p>
<p>Also, I often refer to one of Emacs’s standard commands by listing the keys which you press to invoke the command and then giving the name of the command in parentheses, like this: M-C-\ (<code>indent-region</code>). What this means is that the <code>indent-region</code> command is customarily invoked by typing M-C-. (You can, if you wish, change the keys that are typed to invoke the command; this is called rebinding. See <a href="https://www.gnu.org/software/emacs/manual/html_mono/eintr.html#Keymaps" target="_blank" rel="noopener">Keymaps</a>.) The abbreviation M-C-\ means that you type your <meta> key, <ctrl> key and \ key all at the same time. (On many modern keyboards the <meta> key is labeled <alt>.) Sometimes a combination like this is called a keychord, since it is similar to the way you play a chord on a piano. If your keyboard does not have a <meta> key, the <esc> key prefix is used in place of it. In this case, M-C-\ means that you press and release your <esc> key and then type the <ctrl> key and the \ key at the same time. But usually M-C-\ means press the <ctrl> key along with the key that is labeled <alt> and, at the same time, press the \ key.</alt></ctrl></ctrl></esc></esc></alt></ctrl></p>
<p>In addition to typing a lone keychord, you can prefix what you type with C-u, which is called the universal argument. The C-u keychord passes an argument to the subsequent command. Thus, to indent a region of plain text by 6 spaces, mark the region, and then type C-u 6 M-C-. (If you do not specify a number, Emacs either passes the number 4 to the command or otherwise runs the command differently than it would otherwise.) See <a href="https://www.gnu.org/software/emacs/manual/html_mono/emacs.html#Arguments" target="_blank" rel="noopener">Numeric Arguments</a>.</p>
<p>If you are reading this in Info using GNU Emacs, you can read through this whole document just by pressing the space bar, <spc>. (To learn about Info, type C-h i and then select Info.)</spc></p>
<p>A note on terminology: when I use the word Lisp alone, I often am referring to the various dialects of Lisp in general, but when I speak of Emacs Lisp, I am referring to GNU Emacs Lisp in particular.</p>
<h3 id="Thank-You"><a href="#Thank-You" class="headerlink" title="Thank You"></a>Thank You</h3><p>My thanks to all who helped me with this book. My especial thanks to Jim Blandy, Noah Friedman, Jim Kingdon, Roland McGrath, Frank Ritter, Randy Smith, Richard M. Stallman, and Melissa Weisshaus. My thanks also go to both Philip Johnson and David Stampe for their patient encouragement. My mistakes are my own.</p>
<p>Robert J. Chassell</p>
<p><a href="mailto:bob@gnu.org" target="_blank" rel="noopener">bob@gnu.org</a></p>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://alphaalgorithms.github.io/2019/06/03/grokking-two-s-complements/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Gabriel">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="DummyHead">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                
                <a href="/2019/06/03/grokking-two-s-complements/" class="post-title-link" itemprop="url">Grokking原码, 补码, 反码</a>
              
            
          </h2>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2019-06-03 15:38:57 / Modified: 15:42:27" itemprop="dateCreated datePublished" datetime="2019-06-03T15:38:57+08:00">2019-06-03</time>
            

            
              

              
            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/bitOperations/" itemprop="url" rel="index"><span itemprop="name">bitOperations</span></a></span>

                
                
              
            </span>
          

          
            
            
              
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
            
                <span class="post-meta-item-text">Comments: </span>
                <a href="/2019/06/03/grokking-two-s-complements/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2019/06/03/grokking-two-s-complements/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="基本概念"><a href="#基本概念" class="headerlink" title="基本概念"></a>基本概念</h2><p>反码是个生造出来的概念．<br>所谓反码，英语里又叫ones’ complement（对1求补）<br>所谓补码，英语里又叫two’s complement（对2求补）</p>
<h2 id="模的概念"><a href="#模的概念" class="headerlink" title="模的概念"></a>模的概念</h2><p>首先灌输一个新的概念叫，模</p>
<p>什么是“模”，想象日常使用的钟表，它可以显示0～12点的时间，假设现在是2点钟，请用手动拨动时针的方式将时间减4小时，你会怎么做？</p>
<p>有两种方式：</p>
<ol>
<li>逆时针将时针拨4小时</li>
<li>顺时针将时针拨8（12-4）小时</li>
</ol>
<p>这里要讲的是第二种方式，为什么顺时针拨12-4也可以达到和正常思维的第一种方式一样的位置。<br>12就是模。<br>同样的，如果是十进制的两位数，80-10 和 80＋90在不考虑百位数的基础上都是70。这里的90就是100-10得来的，这种情况下100就是模<br>模就好比是一个极限，在它的范围内，两个相加等于模的数互为补数，还是举100的例子<br>90和10， 55和45，68和32，互为补数<br>在模的范围内做减法，可以将“X－Y”的减法变更为“X＋Y的补数“的加法，当然前提是不考虑百位数</p>
<p>思考题，<em>上面举的例子是大数减小数，那么如果是小数减大数会怎么样呢？</em><br>如果是10-80，结果应该是－70，但如果按照10+（100-80），结果是30。<br>而很明显－70和30不是一回事，这里也没有百位数的问题，这种情况应该怎么破？<br>当初的那些先贤们想出来的办法很简单，就是把这两个数直接划上等号，正好顺便解决了负数的表达方式。再来仔细看看这两个数的关系：－70绝对值的补数就正好是30</p>
<blockquote>
<p> 所以在计算机中，<strong>负数的表达方式就是它绝对值的补数</strong></p>
</blockquote>
<p>但是问题又来了，看起来这个解决方式很完美了，但别忘了，30他已经代表了正数的30了，现在又要用来代表负数的－70，谁知道它出现的时候到底是代表哪个数？<br>为了解决这个问题，需要给这套规则划定一个范围，原来是0～99的正数，现在既然要用部分正数来代替负数了，那就要规定一个范围来使得一个数只代表一个含义，正好一人一半，0～49这个区间就代表正数，50～99的区间就用来代表各自补数的负值，例：98就代表－2</p>
<h2 id="现在回到二进制的计算机世界"><a href="#现在回到二进制的计算机世界" class="headerlink" title="现在回到二进制的计算机世界"></a>现在回到二进制的计算机世界</h2><p>8位二进制数一共可以表示2的8次方，256个数，即0～255 （别忘了0也要占一位的），他们的极限就是256，即256是8位二进制数的模 ，应该不难理解吧，同上十进制的两位数0～99的模是100。<br>还是用二进制来说明清楚，8位二进制能表示的数的极限是<br>1 1 1 1 1 1 1 1， 就是255，在这基础上加0 0 0 0 0 0 0 1，出现了进一位 即 1 0 0 0 0 0 0 0 0<br>这个1 0 0 0 0 0 0 0 0就是8位二进制数的模，256</p>
<p>同样按照第二步讲的逻辑，一半的数0～127，代表其正数本身，另一半的数 128～255，代表其补数的负值，即“－1～－128”的区间。<br>而 “X－Y”的减法 就用 “X＋Y的补数” 的加法来表示，完美！ 唯一需要注意的事情是任何计算的输入值和输出结果值都需要严格遵守－128～127的范围，一旦溢出就会报错。<br>这也就是我们在编程里强调的为什么 byte＋byte还得是byte，int＋int还得是int，数据溢出问题也是每一个程序员都需要注意的问题。</p>
<p>这样一说是不是可以理解－128的补码是怎么来的了吧？ 他就是256-｜－128｜＝128<br>二进制的128是不是就是1 0 0 0 0 0 0 0 ？</p>
<h2 id="最终问题，那书和老师为什么要用原码，反码来讲补码-？"><a href="#最终问题，那书和老师为什么要用原码，反码来讲补码-？" class="headerlink" title="最终问题，那书和老师为什么要用原码，反码来讲补码 ？"></a>最终问题，那书和老师为什么要用原码，反码来讲补码 ？</h2><p>空穴来风，未必无因</p>
<p>那是因为计算机就是这样求负数的补码的，我们在键盘上敲一个负数的时候，计算机要把它用补码的形式存储下来，还记得上面我们讲的补码是怎么来的吗？</p>
<p>模－绝对值，这是不是个减法公式？但计算机没有减法逻辑，我们费了那么大的劲搞了一套补码的规则就是为了用加法来替代减法，但为了实现这么套规则，却跨不过一个坎，就是把负数计算成补码仍然是需要减法逻辑的。怎么办呢，那些伟大的先贤们 （膜拜）就想出了这么个办法：</p>
<p>首位不变，其余位取反后，再加一，　</p>
<p>“copy and complement”的求解方法</p>
<p><img src="/home/gaowei/Reference/Post/grokking-two-s-complements.assets/copy-and-complement.png" alt="copy-and-complement"></p>
<h2 id="下面是吐槽"><a href="#下面是吐槽" class="headerlink" title="下面是吐槽"></a>下面是吐槽</h2><p>不知道是哪个书呆子教书，照搬了机器的逻辑，把取反加一的方法当做补码的计算逻辑就这么教下来了。搞笑的是，还保留了补码这个名字，照理说这种教法应该叫 取反加一码 更合理，你还补什么啊？ </p>
<p>不仅如此，还搞出了个首位符号位的说法，弄出了个正0负0，还用负0来充当－128，真是不把人弄疯不罢休啊！！</p>
<h2 id="保留符号的运算"><a href="#保留符号的运算" class="headerlink" title="保留符号的运算"></a>保留符号的运算</h2><p><img src="/home/gaowei/Reference/Post/grokking-two-s-complements.assets/retain-symbols.png" alt="retain-symbols"></p>
<p><img src="/home/gaowei/Reference/Post/grokking-two-s-complements.assets/retain-symbols2.png" alt="retain-symbols2"></p>
<h2 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h2><ul>
<li><a href="https://www.zhihu.com/question/20458542/answer/40759880" target="_blank" rel="noopener">https://www.zhihu.com/question/20458542/answer/40759880</a></li>
</ul>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://alphaalgorithms.github.io/2019/06/01/python-format-string/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Gabriel">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="DummyHead">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                
                <a href="/2019/06/01/python-format-string/" class="post-title-link" itemprop="url">Python Format String</a>
              
            
          </h2>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2019-06-01 15:24:54 / Modified: 17:24:10" itemprop="dateCreated datePublished" datetime="2019-06-01T15:24:54+08:00">2019-06-01</time>
            

            
              

              
            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/fileManager-textProcessing/" itemprop="url" rel="index"><span itemprop="name">fileManager -textProcessing</span></a></span>

                
                
              
            </span>
          

          
            
            
              
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
            
                <span class="post-meta-item-text">Comments: </span>
                <a href="/2019/06/01/python-format-string/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2019/06/01/python-format-string/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="Field-Width-and-Alignment"><a href="#Field-Width-and-Alignment" class="headerlink" title="Field Width and Alignment"></a>Field Width and Alignment</h2><blockquote>
<p>默认左对齐 </p>
</blockquote>
<table>
<thead>
<tr>
<th><code>&#39;hey {:10}&#39;.format(&#39;hello&#39;)</code></th>
<th>Specify width (Aign left, fill with spaces)</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>&#39;{:010}&#39;.format(2)</code></td>
<td>Fill with zeroesOutput: <code>0000000002</code></td>
</tr>
<tr>
<td><code>&#39;{:*^30}&#39;.format(&#39;text&#39;)</code></td>
<td>Specify width, align to centerOutput: <code>*************text*************</code></td>
</tr>
</tbody>
</table>
<blockquote>
<table>
<thead>
<tr>
<th>Option</th>
<th>Meaning, padding</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>&#39;&lt;&#39;</code></td>
<td>Forces the field to be left-aligned within the available space (this is the default for most objects).</td>
</tr>
<tr>
<td><code>&#39;&gt;&#39;</code></td>
<td>Forces the field to be right-aligned within the available space (this is the default for numbers).</td>
</tr>
<tr>
<td><code>&#39;=&#39;</code></td>
<td>Forces the padding to be placed after the sign (if any) but before the digits. This is used for printing fields in the form ‘+000000120’. This alignment option is only valid for numeric types. It becomes the default when ‘0’ immediately precedes the field width.</td>
</tr>
<tr>
<td><code>&#39;^&#39;</code></td>
<td>Forces the field to be centered within the available space.</td>
</tr>
</tbody>
</table>
</blockquote>
<h2 id="Member-and-Element-Access"><a href="#Member-and-Element-Access" class="headerlink" title="Member and Element Access"></a>Member and Element Access</h2><table>
<thead>
<tr>
<th><code>&#39;{0}, {1}, {2}&#39;.format(1, 2, 3)</code></th>
<th>Access arguments by ordinal positionOutput: <code>1, 2, 3</code></th>
</tr>
</thead>
<tbody>
<tr>
<td><code>&#39;{}, {}, {}&#39;.format(1, 2, 3)</code></td>
<td>Implicit positional arguments (2.7 and above only)Output: <code>1, 2, 3</code></td>
</tr>
<tr>
<td><code>&#39;{value1}, {value2}, {value2}&#39;.format(value1=1, value2=2, value3=3)</code></td>
<td>Access keyword arguments by nameOutput: <code>1, 2, 2</code></td>
</tr>
<tr>
<td><code>&#39;{[1]}&#39;.format([&#39;first&#39;, &#39;second&#39;, &#39;third&#39;])</code></td>
<td>Access element by indexOutput: <code>second</code></td>
</tr>
<tr>
<td><code>&#39;{.name}&#39;.format(sys.stdin)</code></td>
<td>Access element attributeOutput: <code>&lt;stdin&gt;</code></td>
</tr>
<tr>
<td><code>&#39;{[name]}&#39;.format({&#39;name&#39;: &#39;something&#39;})</code></td>
<td>Access element by keyOutput: <code>something</code></td>
</tr>
</tbody>
</table>
<h2 id="Numerical-Representation"><a href="#Numerical-Representation" class="headerlink" title="Numerical Representation"></a>Numerical Representation</h2><table>
<thead>
<tr>
<th><code>&#39;{:x}&#39;.format(100)</code></th>
<th>Hexadecimal representationOutput: <code>64</code></th>
</tr>
</thead>
<tbody>
<tr>
<td><code>&#39;{:X}&#39;.format(3487)</code></td>
<td>Hexadecimal representation (uppercase letters)Output: <code>D9F</code></td>
</tr>
<tr>
<td><code>&#39;{:#x}&#39;.format(100)</code></td>
<td>Hexadecimal representation (including the <code>0x</code>)Output: <code>0x64</code></td>
</tr>
<tr>
<td><code>&#39;{:b}&#39;.format(100)</code></td>
<td>Binary representationOutput: <code>1100100</code></td>
</tr>
<tr>
<td><code>&#39;{:c}&#39;.format(100)</code></td>
<td>Character representationOutput: <code>d</code></td>
</tr>
<tr>
<td><code>&#39;{:d}&#39;.format(100)</code></td>
<td>Decimal representation (default)Output: <code>100</code></td>
</tr>
<tr>
<td><code>&#39;{:,}&#39;.format(1000000)</code></td>
<td>With thousands separatorOutput: <code>1,000,000</code></td>
</tr>
<tr>
<td><code>&#39;{:o}&#39;.format(100)</code></td>
<td>Octal representationOutput: <code>144</code></td>
</tr>
<tr>
<td><code>&#39;{:n}&#39;.format(100)</code></td>
<td>Like <code>d</code>, but uses locale information for separatorsOutput: <code>100</code></td>
</tr>
<tr>
<td><code>&#39;{:e}&#39;.format(0.0000000001)</code></td>
<td>Exponent notationOutput: <code>1.000000e-10</code></td>
</tr>
<tr>
<td><code>&#39;{:E}&#39;.format(0.0000000001)</code></td>
<td>Exponent notation (capital ‘E’)Output: <code>1.000000E-10</code></td>
</tr>
<tr>
<td><code>&#39;{:f}&#39;.format(3/14.0)</code></td>
<td>Fixed pointOutput: <code>0.214286</code></td>
</tr>
<tr>
<td><code>&#39;{:g}&#39;.format(3/14.0)</code></td>
<td>General formatOutput: <code>0.214286</code></td>
</tr>
<tr>
<td><code>&#39;{:%}&#39;.format(0.66)</code></td>
<td>PercentageOutput: <code>66.000000%</code></td>
</tr>
<tr>
<td><code>&#39;{:.3}&#39;.format(0.214286)</code></td>
<td>PrecisionOutput: <code>0.214</code></td>
</tr>
</tbody>
</table>
<p>Integers </p>
<blockquote>
<table>
<thead>
<tr>
<th>Type</th>
<th>Meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>&#39;b&#39;</code></td>
<td>Binary format. Outputs the number in base 2.</td>
</tr>
<tr>
<td><code>&#39;c&#39;</code></td>
<td>Character. Converts the integer to the corresponding unicode character before printing.</td>
</tr>
<tr>
<td><code>&#39;d&#39;</code></td>
<td>Decimal Integer. Outputs the number in base 10.</td>
</tr>
<tr>
<td><code>&#39;o&#39;</code></td>
<td>Octal format. Outputs the number in base 8.</td>
</tr>
<tr>
<td><code>&#39;x&#39;</code></td>
<td>Hex format. Outputs the number in base 16, using lower-case letters for the digits above 9.</td>
</tr>
<tr>
<td><code>&#39;X&#39;</code></td>
<td>Hex format. Outputs the number in base 16, using upper-case letters for the digits above 9.</td>
</tr>
<tr>
<td><code>&#39;n&#39;</code></td>
<td>Number. This is the same as <code>&#39;d&#39;</code>, except that it uses the current locale setting to insert the appropriate number separator characters.</td>
</tr>
<tr>
<td>None</td>
<td>The same as <code>&#39;d&#39;</code>.</td>
</tr>
</tbody>
</table>
</blockquote>
<p>Floating numbers</p>
<blockquote>
<table>
<thead>
<tr>
<th>Type</th>
<th>Meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>&#39;e&#39;</code></td>
<td>Exponent notation. Prints the number in scientific notation using the letter ‘e’ to indicate the exponent. The default precision is <code>6</code>.</td>
</tr>
<tr>
<td><code>&#39;E&#39;</code></td>
<td>Exponent notation. Same as <code>&#39;e&#39;</code> except it uses an upper case ‘E’ as the separator character.</td>
</tr>
<tr>
<td><code>&#39;f&#39;</code></td>
<td>Fixed-point notation. Displays the number as a fixed-point number. The default precision is <code>6</code>.</td>
</tr>
<tr>
<td><code>&#39;F&#39;</code></td>
<td>Fixed-point notation. Same as <code>&#39;f&#39;</code>, but converts <code>nan</code> to <code>NAN</code> and <code>inf</code> to <code>INF</code>.</td>
</tr>
<tr>
<td><code>&#39;g&#39;</code></td>
<td>General format. For a given precision <code>p &gt;= 1</code>, this rounds the number to <code>p</code>significant digits and then formats the result in either fixed-point format or in scientific notation, depending on its magnitude.The precise rules are as follows: suppose that the result formatted with presentation type <code>&#39;e&#39;</code> and precision <code>p-1</code> would have exponent <code>exp</code>. Then if <code>-4&lt;= exp &lt; p</code>, the number is formatted with presentation type <code>&#39;f&#39;</code> and precision<code>p-1-exp</code>. Otherwise, the number is formatted with presentation type <code>&#39;e&#39;</code> and precision <code>p-1</code>. In both cases insignificant trailing zeros are removed from the significand, and the decimal point is also removed if there are no remaining digits following it.Positive and negative infinity, positive and negative zero, and nans, are formatted as <code>inf</code>, <code>-inf</code>, <code>0</code>, <code>-0</code> and <code>nan</code> respectively, regardless of the precision.A precision of <code>0</code> is treated as equivalent to a precision of <code>1</code>. The default precision is <code>6</code>.</td>
</tr>
<tr>
<td><code>&#39;G&#39;</code></td>
<td>General format. Same as <code>&#39;g&#39;</code> except switches to <code>&#39;E&#39;</code> if the number gets too large. The representations of infinity and NaN are uppercased, too.</td>
</tr>
<tr>
<td><code>&#39;n&#39;</code></td>
<td>Number. This is the same as <code>&#39;g&#39;</code>, except that it uses the current locale setting to insert the appropriate number separator characters.</td>
</tr>
<tr>
<td><code>&#39;%&#39;</code></td>
<td>Percentage. Multiplies the number by 100 and displays in fixed (<code>&#39;f&#39;</code>) format, followed by a percent sign.</td>
</tr>
<tr>
<td>None</td>
<td>Similar to <code>&#39;g&#39;</code>, except that fixed-point notation, when used, has at least one digit past the decimal point. The default precision is as high as needed to represent the particular value. The overall effect is to match the output of <a href="https://docs.python.org/3/library/stdtypes.html#str" target="_blank" rel="noopener"><code>str()</code></a> as altered by the other format modifiers.</td>
</tr>
</tbody>
</table>
</blockquote>
<h2 id="Conversions"><a href="#Conversions" class="headerlink" title="Conversions"></a>Conversions</h2><table>
<thead>
<tr>
<th><code>&#39;{!r}&#39;.format(&#39;string&#39;)</code></th>
<th>Calling <code>repr</code> on argumentsOutput: <code>&#39;string&#39;</code></th>
</tr>
</thead>
<tbody>
<tr>
<td><code>&#39;{!s}&#39;.format(1.53438987)</code></td>
<td>Calling <code>str</code> on argumentsOutput: <code>1.53438987</code></td>
</tr>
</tbody>
</table>
<h2 id="Number-Formattting"><a href="#Number-Formattting" class="headerlink" title="Number Formattting"></a>Number Formattting</h2><p>The following table shows various ways to format numbers using Python’s  str.format(), including examples for both float formatting and integer formatting.</p>
<p>To run examples use <code>print(&quot;FORMAT&quot;.format(NUMBER));</code><br>So to get the output of the first example, you would run: <code>print(&quot;{:.2f}&quot;.format(3.1415926));</code></p>
<table>
<thead>
<tr>
<th>Number</th>
<th>Format</th>
<th>Output</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>3.1415926</td>
<td>{:.2f}</td>
<td>3.14</td>
<td>2 decimal places</td>
</tr>
<tr>
<td>3.1415926</td>
<td>{:+.2f}</td>
<td>+3.14</td>
<td>2 decimal places with sign</td>
</tr>
<tr>
<td>-1</td>
<td>{:+.2f}</td>
<td>-1.00</td>
<td>2 decimal places with sign</td>
</tr>
<tr>
<td>2.71828</td>
<td>{:.0f}</td>
<td>3</td>
<td>No decimal places</td>
</tr>
<tr>
<td>5</td>
<td>{:0&gt;2d}</td>
<td>05</td>
<td>Pad number with zeros (left padding, width 2)</td>
</tr>
<tr>
<td>5</td>
<td>{:x&lt;4d}</td>
<td>5xxx</td>
<td>Pad number with x’s (right padding, width 4)</td>
</tr>
<tr>
<td>10</td>
<td>{:x&lt;4d}</td>
<td>10xx</td>
<td>Pad number with x’s (right padding, width 4)</td>
</tr>
<tr>
<td>1000000</td>
<td>{:,}</td>
<td>1,000,000</td>
<td>Number format with comma separator</td>
</tr>
<tr>
<td>0.25</td>
<td>{:.2%}</td>
<td>25.00%</td>
<td>Format percentage</td>
</tr>
<tr>
<td>1000000000</td>
<td>{:.2e}</td>
<td>1.00e+09</td>
<td>Exponent notation</td>
</tr>
<tr>
<td>13</td>
<td>{:10d}</td>
<td>13</td>
<td>Right aligned (default, width 10)</td>
</tr>
<tr>
<td>13</td>
<td>{:&lt;10d}</td>
<td>13</td>
<td>Left aligned (width 10)</td>
</tr>
<tr>
<td>13</td>
<td>{:^10d}</td>
<td>13</td>
<td>Center aligned (width 10)</td>
</tr>
</tbody>
</table>
<h2 id="Official-Examples"><a href="#Official-Examples" class="headerlink" title="Official Examples"></a>Official Examples</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1) by position:</span></span><br><span class="line"><span class="string">'&#123;0&#125;, &#123;1&#125;, &#123;2&#125;'</span>.format(<span class="string">'a'</span>, <span class="string">'b'</span>, <span class="string">'c'</span>)</span><br><span class="line"><span class="string">'&#123;&#125;, &#123;&#125;, &#123;&#125;'</span>.format(<span class="string">'a'</span>, <span class="string">'b'</span>, <span class="string">'c'</span>)  <span class="comment"># 3.1+ only</span></span><br><span class="line"><span class="string">'&#123;2&#125;, &#123;1&#125;, &#123;0&#125;'</span>.format(<span class="string">'a'</span>, <span class="string">'b'</span>, <span class="string">'c'</span>)</span><br><span class="line"><span class="string">'&#123;2&#125;, &#123;1&#125;, &#123;0&#125;'</span>.format(*<span class="string">'abc'</span>)      <span class="comment"># unpacking argument sequence</span></span><br><span class="line"><span class="string">'&#123;0&#125;&#123;1&#125;&#123;0&#125;'</span>.format(<span class="string">'abra'</span>, <span class="string">'cad'</span>)   <span class="comment"># arguments' indices can be repeated</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#2) by name </span></span><br><span class="line"><span class="string">'Coordinates: &#123;latitude&#125;, &#123;longitude&#125;'</span>.format(latitude=<span class="string">'37.24N'</span>, longitude=<span class="string">'-115.81W'</span>)</span><br><span class="line">coord = &#123;<span class="string">'latitude'</span>: <span class="string">'37.24N'</span>, <span class="string">'longitude'</span>: <span class="string">'-115.81W'</span>&#125;</span><br><span class="line"><span class="string">'Coordinates: &#123;latitude&#125;, &#123;longitude&#125;'</span>.format(**coord)</span><br><span class="line"></span><br><span class="line"><span class="comment">#3) by attributes</span></span><br><span class="line">c = <span class="number">3</span><span class="number">-5j</span></span><br><span class="line">(<span class="string">'The complex number &#123;0&#125; is formed from the real part &#123;0.real&#125; '</span></span><br><span class="line"> <span class="string">'and the imaginary part &#123;0.imag&#125;.'</span>).format(c)</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Point</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, x, y)</span>:</span></span><br><span class="line">        self.x, self.y = x, y</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__str__</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="keyword">return</span> <span class="string">'Point(&#123;self.x&#125;, &#123;self.y&#125;)'</span>.format(self=self)</span><br><span class="line">str(Point(<span class="number">4</span>, <span class="number">2</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment">#4) by arguments' items </span></span><br><span class="line">coord = (<span class="number">3</span>, <span class="number">5</span>)</span><br><span class="line"><span class="string">'X: &#123;0[0]&#125;;  Y: &#123;0[1]&#125;'</span>.format(coord)</span><br><span class="line"></span><br><span class="line"><span class="comment">#5) 注意这里的aligned用了&gt; &lt; Y与regex的look around保持一直</span></span><br><span class="line"><span class="string">'&#123;:&lt;30&#125;'</span>.format(<span class="string">'left aligned'</span>)</span><br><span class="line"><span class="string">'&#123;:&gt;30&#125;'</span>.format(<span class="string">'right aligned'</span>)</span><br><span class="line"><span class="string">'&#123;:^30&#125;'</span>.format(<span class="string">'centered'</span>)</span><br><span class="line"><span class="string">'&#123;:*^30&#125;'</span>.format(<span class="string">'centered'</span>)  <span class="comment"># use '*' as a fill char</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#6) Replacing %+f, %-f, and % f and specifying a sign:</span></span><br><span class="line"><span class="string">'&#123;:+f&#125;; &#123;:+f&#125;'</span>.format(<span class="number">3.14</span>, <span class="number">-3.14</span>)  <span class="comment"># show it always</span></span><br><span class="line"><span class="string">'&#123;: f&#125;; &#123;: f&#125;'</span>.format(<span class="number">3.14</span>, <span class="number">-3.14</span>)  <span class="comment"># show a space for positive numbers</span></span><br><span class="line"><span class="string">'&#123;:-f&#125;; &#123;:-f&#125;'</span>.format(<span class="number">3.14</span>, <span class="number">-3.14</span>)  <span class="comment"># show only the minus -- same as '&#123;:f&#125;; &#123;:f&#125;'</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 7) Replacing %x and %o and converting the value to different bases:</span></span><br><span class="line"><span class="comment"># format also supports binary numbers</span></span><br><span class="line"><span class="string">"int: &#123;0:d&#125;;  hex: &#123;0:x&#125;;  oct: &#123;0:o&#125;;  bin: &#123;0:b&#125;"</span>.format(<span class="number">42</span>)</span><br><span class="line"><span class="comment"># with 0x, 0o, or 0b as prefix:</span></span><br><span class="line"><span class="string">"int: &#123;0:d&#125;;  hex: &#123;0:#x&#125;;  oct: &#123;0:#o&#125;;  bin: &#123;0:#b&#125;"</span>.format(<span class="number">42</span>)</span><br></pre></td></tr></table></figure>
<h2 id="Other-Examples"><a href="#Other-Examples" class="headerlink" title="Other Examples"></a>Other Examples</h2><h3 id="Padding-and-aligning-strings"><a href="#Padding-and-aligning-strings" class="headerlink" title="Padding and aligning strings"></a>Padding and aligning strings</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#alight right </span></span><br><span class="line"><span class="string">'%10s'</span> % (<span class="string">'test'</span>,)</span><br><span class="line"><span class="string">'&#123;:&gt;10&#125;'</span>.format(<span class="string">'test'</span>)</span><br><span class="line">      test</span><br><span class="line"> <span class="comment">#align left:</span></span><br><span class="line">  <span class="string">'%-10s'</span> % (<span class="string">'test'</span>,)</span><br><span class="line">   <span class="string">'&#123;:10&#125;'</span>.format(<span class="string">'test'</span>)</span><br><span class="line">    <span class="string">'&#123;:10&#125;'</span>.format(<span class="string">'test'</span>)</span><br><span class="line">         test </span><br><span class="line">   <span class="comment">#new style</span></span><br><span class="line">  <span class="string">'&#123;:_&lt;10&#125;'</span>.format(<span class="string">'test'</span>)</span><br><span class="line">    test______</span><br><span class="line">    </span><br><span class="line">    <span class="comment">#new style</span></span><br><span class="line">    <span class="string">'&#123;:^10&#125;'</span>.format(<span class="string">'test'</span>)</span><br></pre></td></tr></table></figure>
<h3 id="Truncating-Long-Strings"><a href="#Truncating-Long-Strings" class="headerlink" title="Truncating Long Strings"></a>Truncating Long Strings</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">'%.5s'</span> % (<span class="string">'xylophone'</span>,) <span class="comment">#注意后面的小数点呀是truncate </span></span><br><span class="line"><span class="string">'&#123;:.5&#125;'</span>.format(<span class="string">'xylophone'</span>)</span><br><span class="line">xylop</span><br></pre></td></tr></table></figure>
<h3 id="Combining-truncating-and-padding"><a href="#Combining-truncating-and-padding" class="headerlink" title="Combining truncating and padding"></a>Combining truncating and padding</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">'%-10.5s'</span> % (<span class="string">'xylophone'</span>,)</span><br><span class="line"><span class="string">'&#123;:10.5&#125;'</span>.format(<span class="string">'xylophone'</span>)</span><br><span class="line">xylop</span><br></pre></td></tr></table></figure>
<h3 id="Numbers"><a href="#Numbers" class="headerlink" title="Numbers"></a>Numbers</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">'%d'</span> % (<span class="number">42</span>,)</span><br><span class="line"><span class="string">'&#123;:d&#125;'</span>.format(<span class="number">42</span>)</span><br><span class="line"><span class="number">42</span></span><br><span class="line"></span><br><span class="line"><span class="string">'%f'</span> % (<span class="number">3.141592653589793</span>,)</span><br><span class="line"><span class="string">'&#123;:f&#125;'</span>.format(<span class="number">3.141592653589793</span>)</span><br><span class="line">    <span class="number">3.141593</span></span><br><span class="line">    </span><br><span class="line"><span class="comment">#signed numbers </span></span><br><span class="line"><span class="string">'%+d'</span> % (<span class="number">42</span>,)</span><br><span class="line"><span class="string">'&#123;:+d&#125;'</span>.format(<span class="number">42</span>)</span><br></pre></td></tr></table></figure>
<h3 id="Getitem-and-Getattr"><a href="#Getitem-and-Getattr" class="headerlink" title="Getitem and Getattr"></a>Getitem and Getattr</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">person = &#123;<span class="string">'first'</span>: <span class="string">'Jean-Luc'</span>, <span class="string">'last'</span>: <span class="string">'Picard'</span>&#125;</span><br><span class="line"><span class="string">'&#123;p[first]&#125; &#123;p[last]&#125;'</span>.format(p=person)</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Plant</span><span class="params">(object)</span>:</span></span><br><span class="line">    type = <span class="string">'tree'</span></span><br><span class="line">    <span class="string">'&#123;p.type&#125;'</span>.format(p=Plant())</span><br><span class="line"> <span class="string">'&#123;:&#123;align&#125;&#123;width&#125;&#125;'</span>.format(<span class="string">'test'</span>, align=<span class="string">'^'</span>, width=<span class="string">'10'</span>)</span><br></pre></td></tr></table></figure>
<h3 id="Datetime"><a href="#Datetime" class="headerlink" title="Datetime"></a>Datetime</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> datetime <span class="keyword">import</span> datetime</span><br><span class="line"><span class="string">'&#123;:%Y-%m-%d %H:%M&#125;'</span>.format(datetime(<span class="number">2001</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>))</span><br></pre></td></tr></table></figure>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="page-number" href="/page/3/">3</a><a class="extend next" rel="next" href="/page/2/"><i class="fa fa-angle-right" aria-label="Next page"></i></a>
  </nav>



          </div>
          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      

      <div class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">Gabriel</p>
              <div class="site-description motion-element" itemprop="description"></div>
          </div>

          
            <nav class="site-state motion-element">
              
                <div class="site-state-item site-state-posts">
                
                  <a href="/archives/">
                
                    <span class="site-state-item-count">30</span>
                    <span class="site-state-item-name">posts</span>
                  </a>
                </div>
              

              
                
                
                <div class="site-state-item site-state-categories">
                  
                    
                      <a href="/categories/">
                    
                  
                    
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                    <span class="site-state-item-count">16</span>
                    <span class="site-state-item-name">categories</span>
                  </a>
                </div>
              

              
                
                
                <div class="site-state-item site-state-tags">
                  
                    
                      <a href="/tags/">
                    
                  
                    
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                    <span class="site-state-item-count">29</span>
                    <span class="site-state-item-name">tags</span>
                  </a>
                </div>
              
            </nav>
          

          

          

          
            <div class="links-of-author motion-element">
              
                <span class="links-of-author-item">
                  
                  
                    
                  
                  
                    
                  
                  <a href="https://github.com/AlphaAlgorithms" title="GitHub &rarr; https://github.com/AlphaAlgorithms" rel="noopener" target="_blank"><i class="fa fa-fw fa-github"></i>GitHub</a>
                </span>
              
            </div>
          

          

          
          

          
            
          
          

        </div>
      </div>

      

      

    </div>
  </aside>
  


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2019</span>
  <span class="with-love" id="animate">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Gabriel</span>

  

  
</div>


  <div class="powered-by">Powered by <a href="https://hexo.io" class="theme-link" rel="noopener" target="_blank">Hexo</a> v3.8.0</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">Theme – <a href="https://theme-next.org" class="theme-link" rel="noopener" target="_blank">NexT.Mist</a> v7.1.1</div>




        








        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

    

    
  </div>

  

<script>
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>


























  
  <script src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>


  


  <script src="/js/utils.js?v=7.1.1"></script>

  <script src="/js/motion.js?v=7.1.1"></script>



  
  


  <script src="/js/schemes/muse.js?v=7.1.1"></script>




  

  


  <script src="/js/next-boot.js?v=7.1.1"></script>


  

  

  

  
  
  <script id="dsq-count-scr" src="https://alphaalgorithms.disqus.com/count.js" async></script>







  




  

  

  

  

  

  

  

  

  

  

  

  

  

  

</body>
</html>
